[
  {
    "objectID": "material/semana1/01_data_collection.html",
    "href": "material/semana1/01_data_collection.html",
    "title": "01 - Coleta de dados",
    "section": "",
    "text": "O avan√ßo das tecnologias de sequenciamento em c√©lula √∫nica permitiu uma revolu√ß√£o na compreens√£o da biologia celular em diversos contextos fisiol√≥gicos e patol√≥gicos. Entretanto, o acesso a dados de alta qualidade e bem anotados ainda √© um desafio para pesquisadores iniciantes ou que n√£o possuem estrutura para gerar seus pr√≥prios datasets.\nA Chan Zuckerberg Initiative (CZI), por meio da plataforma CellxGene, disponibiliza milhares de amostras de transcriptoma de c√©lula √∫nica de estudos de alta relev√¢ncia, anotados, integrados e prontos para reuso. Essa plataforma se tornou uma refer√™ncia mundial para pesquisadores que buscam:\n\ndados de refer√™ncia para estudos comparativos,\nrean√°lise com m√©todos pr√≥prios,\ntreinamento de modelos de aprendizado de m√°quina,\nintegra√ß√£o com dados internos."
  },
  {
    "objectID": "material/semana1/01_data_collection.html#motiva√ß√£o",
    "href": "material/semana1/01_data_collection.html#motiva√ß√£o",
    "title": "01 - Coleta de dados",
    "section": "",
    "text": "O avan√ßo das tecnologias de sequenciamento em c√©lula √∫nica permitiu uma revolu√ß√£o na compreens√£o da biologia celular em diversos contextos fisiol√≥gicos e patol√≥gicos. Entretanto, o acesso a dados de alta qualidade e bem anotados ainda √© um desafio para pesquisadores iniciantes ou que n√£o possuem estrutura para gerar seus pr√≥prios datasets.\nA Chan Zuckerberg Initiative (CZI), por meio da plataforma CellxGene, disponibiliza milhares de amostras de transcriptoma de c√©lula √∫nica de estudos de alta relev√¢ncia, anotados, integrados e prontos para reuso. Essa plataforma se tornou uma refer√™ncia mundial para pesquisadores que buscam:\n\ndados de refer√™ncia para estudos comparativos,\nrean√°lise com m√©todos pr√≥prios,\ntreinamento de modelos de aprendizado de m√°quina,\nintegra√ß√£o com dados internos."
  },
  {
    "objectID": "material/semana1/01_data_collection.html#o-que-√©-o-cellxgene-czi-cellxgene-explorer",
    "href": "material/semana1/01_data_collection.html#o-que-√©-o-cellxgene-czi-cellxgene-explorer",
    "title": "01 - Coleta de dados",
    "section": "O que √© o CellxGene (CZI CellxGene Explorer)?",
    "text": "O que √© o CellxGene (CZI CellxGene Explorer)?\nCellxGene Explorer √© uma plataforma interativa mantida pela Chan Zuckerberg Initiative (CZI), que permite explorar, visualizar e baixar dados de transcript√¥mica de c√©lula √∫nica (scRNA-seq) e outros tipos de dados √≥micos. Ela √© parte do projeto CZ CELLxGENE Discover, cujo objetivo √© democratizar o acesso a dados de alta qualidade e facilitar sua reutiliza√ß√£o em pesquisas biom√©dicas.\nRecursos principais incluem:\n\nVisualiza√ß√µes UMAP interativas\nAnota√ß√µes por tipo celular\nFiltros por condi√ß√£o cl√≠nica, √≥rg√£o, esp√©cie, etc.\nDownload facilitado dos dados brutos e processados (anndata, Seurat, CSV)"
  },
  {
    "objectID": "material/semana1/01_data_collection.html#tipos-de-dados-dispon√≠veis",
    "href": "material/semana1/01_data_collection.html#tipos-de-dados-dispon√≠veis",
    "title": "01 - Coleta de dados",
    "section": "Tipos de Dados Dispon√≠veis",
    "text": "Tipos de Dados Dispon√≠veis\nAt√© o momento, o CellxGene armazena mais de 100 milh√µes de c√©lulas, derivadas de estudos envolvendo:\n\nC√¢ncer (mama, pulm√£o, pr√≥stata, c√≥lon etc.)\nCOVID-19\nDoen√ßas autoimunes (L√∫pus, Artrite Reumatoide)\nDoen√ßas infecciosas (tuberculose, HIV)\nDoen√ßas neurodegenerativas (Alzheimer, Parkinson)\nTecido saud√°vel humano e de modelos animais\nDados do Human Cell Atlas (HCA)\n\nO volume de dados dispon√≠veis pode chegar a centenas de gigabytes, portanto √© importante considerar isso ao baixar conjuntos maiores."
  },
  {
    "objectID": "material/semana1/01_data_collection.html#navegando-na-plataforma-cellxgene",
    "href": "material/semana1/01_data_collection.html#navegando-na-plataforma-cellxgene",
    "title": "01 - Coleta de dados",
    "section": "1. Navegando na Plataforma CellxGene",
    "text": "1. Navegando na Plataforma CellxGene\nPara come√ßar a explorar dados no CellxGene, siga os passos abaixo:\n\nAcessando a plataforma:\n\nAcesse: https://cellxgene.cziscience.com/\nEm seguida clique na aba Collections.\nUse a barra de busca ou os filtros laterais (organismo, √≥rg√£o, condi√ß√£o, etc.) para encontrar o estudo de interesse.\nClique sobre o nome do dataset desejado ‚Äî isso abrir√° a interface do CellxGene Explorer.\n\n\nüìå Nota: Essa √© a interface interativa principal, onde ocorrem todas as an√°lises visuais descritas a seguir."
  },
  {
    "objectID": "material/semana1/01_data_collection.html#explorando-dataset-de-interesse",
    "href": "material/semana1/01_data_collection.html#explorando-dataset-de-interesse",
    "title": "01 - Coleta de dados",
    "section": "3. Explorando dataset de interesse",
    "text": "3. Explorando dataset de interesse\nAntes de baixar os dados, vale a pena usar os recursos de explora√ß√£o interativa da plataforma para decidir se aquele conjunto √© √∫til para seus objetivos. Abaixo est√£o perguntas chave para cada uma das ferramentas dispon√≠veis:\n\n3.1. Explore\n(Proximo ao bot√£o de Download ‚Üí ‚ÄúExplore‚Äù)\n\nQual a composi√ß√£o celular do dataset?\n‚Üí Visualize a propor√ß√£o de tipos celulares no gr√°fico UMAP e no painel lateral (‚ÄúCell types‚Äù).\nQuantas amostras e doadores est√£o inclu√≠dos no estudo?\n‚Üí Acesse os metadados no painel lateral (‚Äúsample ID‚Äù, ‚Äúdonor ID‚Äù) ou use os filtros.\nO dataset cont√©m metadados √∫teis como idade, sexo ou est√°gio da doen√ßa?\n‚Üí Observe a barra lateral com as op√ß√µes de filtros apresentados no dataset.\nComo a distribui√ß√£o celular varia entre condi√ß√µes cl√≠nicas?\n‚Üí Aplique filtros por condi√ß√£o (disease, treatment, etc.) e observe mudan√ßas no UMAP.\n\n\n\n\n3.2. Gene Expression\n(Menu superior ‚Üí ‚ÄúGene Expression‚Äù)\n\nMeu gene de interesse est√° presente no dataset?\n‚Üí Use o campo de busca ‚ÄúGene Expression‚Äù para inserir o s√≠mbolo do gene.\nQuais tipos celulares expressam esse gene?\n‚Üí Veja o padr√£o de express√£o do gene no UMAP colorido por intensidade.\nA express√£o do gene varia entre amostras ou condi√ß√µes?\n‚Üí Aplique filtros por sample, disease, etc., e observe mudan√ßas de express√£o.\nO gene √© espec√≠fico de um tipo celular?\n‚Üí Verifique se h√° express√£o restrita a um cluster/tipo celular.\nDois genes s√£o coexpressos?\n‚Üí Observe o padr√£o de co-express√£o a partir do bubble plot\n\n\n\n\n3.3. Cell Guide\n(Menu superior ‚Üí ‚ÄúCell Guide‚Äù)\n\nQuais os marcadores canonicos do meu tipo celular de interesse?\n‚Üí Acesse a p√°gina do tipo celular e consulte a opcao ‚ÄúMarker genes‚Äù.\nHa diferencas entre marcadores deduzidos computacionalmente e os canonicos?\n‚Üí Observe a aba ‚ÄúComputational‚Äù na tabela de Marker genes.\nQual o significado das colunas Effect size, Specificity, Mean Expression e % of Cells?\n‚Üí Investigue a documenta√ß√£o da tabela nos icones de ajuda ‚Äú?‚Äù.\n\n\n\n\n3.4. Differential Expression\n(Menu superior ‚Üí ‚ÄúDifferential Expression‚Äù)\n\nQuais genes est√£o diferencialmente expressos entre dois tipos celulares?\n‚Üí Selecione dois tipos celulares em um mesmo dataset e compare.\nH√° genes diferencialmente expressos entre condi√ß√µes cl√≠nicas?\n‚Üí Aplique filtros por condi√ß√£o e selecione grupos para compara√ß√£o.\nExiste genes diferencialmente expressos no mesmo tipo celular entre datasets?\n‚Üí Compare um tipo celular entre datasets diferentes atrav√©s da ferramenta."
  },
  {
    "objectID": "material/semana1/01_data_collection.html#sugest√£o-de-uso-integrado",
    "href": "material/semana1/01_data_collection.html#sugest√£o-de-uso-integrado",
    "title": "01 - Coleta de dados",
    "section": "4. Sugest√£o de Uso Integrado",
    "text": "4. Sugest√£o de Uso Integrado\nUm fluxo de explora√ß√£o poderia seguir:\n\nUse o Explore para entender a estrutura geral do dataset.\n\nConsulte Gene Expression para validar ou investigar genes relevantes.\n\nVisite o Cell Guide para contextualizar biologicamente os tipos celulares.\n\nUse o Differential Expression para gerar hip√≥teses ou identificar genes marcadores."
  },
  {
    "objectID": "material/semana1/01_data_collection.html#coment√°rios-finais",
    "href": "material/semana1/01_data_collection.html#coment√°rios-finais",
    "title": "01 - Coleta de dados",
    "section": "6. Coment√°rios Finais",
    "text": "6. Coment√°rios Finais\n\nO CellxGene √© atualizado frequentemente com novos estudos revisados por pares e dados brutos provenientes de colabora√ß√µes com o Human Cell Atlas, Azimuth, e outras iniciativas.\n\n√â uma excelente fonte para benchmarking de m√©todos, descoberta de biomarcadores e valida√ß√£o cruzada.\n\nAo usar os dados, consulte a aba de metadata para verificar as permiss√µes de reuso e a cita√ß√£o correta do estudo."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introdu√ß√£o √† an√°lise de c√©lula √∫nica",
    "section": "",
    "text": "Este site re√∫ne tutoriais e materiais pr√°ticos do curso de an√°lise transcript√¥mica em c√©lula √∫nica (scRNA-seq). Ao longo de 6 semanas, abordaremos conceitos te√≥ricos, ferramentas computacionais e estudos de caso aplicados, com foco em boas pr√°ticas e aplica√ß√µes generalizadas."
  },
  {
    "objectID": "index.html#conte√∫do-program√°tico",
    "href": "index.html#conte√∫do-program√°tico",
    "title": "Introdu√ß√£o √† an√°lise de c√©lula √∫nica",
    "section": "Conte√∫do Program√°tico",
    "text": "Conte√∫do Program√°tico\n\nSemana 1 ‚Äî Introdu√ß√£o, Hist√≥ria, Desenho Experimental e Defini√ß√£o do Projeto\n\nEvolu√ß√£o da transcript√¥mica: de bulk RNA-seq a single-cell RNA-seq.\nAplica√ß√µes e impacto da tecnologia single-cell em diversos contextos biol√≥gicos.\nTecnologias e plataformas: 10x Genomics.\nIntrodu√ß√£o ao desenho experimental de projetos de single-cell.\nBases de dados p√∫blicas para estudos single-cell.\nDefini√ß√£o e planejamento do projeto final.\nPr√©-processamento de dados: do sequenciamento √† matriz de contagem.\nAula pr√°tica: Uso do Cell Ranger.\n\n\n\nSemana 2 ‚Äî Controle de Qualidade, Filtragem e Ambient RNA\n\nM√©tricas de qualidade: porcentagem de genes mitocondriais, n√∫mero de UMI‚Äôs, etc.\nIdentifica√ß√£o e remo√ß√£o de doublets (scDblFinder).\nNormaliza√ß√£o e escalonamento de dados.\nIntrodu√ß√£o ao conceito de ambient RNA e estrat√©gias de mitiga√ß√£o.\nAula pr√°tica: Uso de Seurat (R) para QC e filtragem.\nAcompanhamento dos projetos: avalia√ß√£o da qualidade e primeiros filtros.\n\n\n\nSemana 3 ‚Äî An√°lise Explorat√≥ria, Clusteriza√ß√£o e Identifica√ß√£o de C√©lulas Malignas\n\nRedu√ß√£o de dimensionalidade: PCA, t-SNE, UMAP.\nClusteriza√ß√£o celular: KNN, Leiden, Louvain.\nAnota√ß√£o de clusters com bancos p√∫blicos.\nIdentifica√ß√£o de subpopula√ß√µes celulares.\nIntrodu√ß√£o √† an√°lise de CNV para detec√ß√£o de c√©lulas malignas.\nAula pr√°tica: Implementa√ß√£o no Seurat.\nAcompanhamento dos projetos: anota√ß√£o e clusteriza√ß√£o.\n\n\n\nSemana 4 ‚Äî An√°lises Diferenciais e Integra√ß√£o de Dados\n\nM√©todos de an√°lise diferencial de express√£o.\nIntegra√ß√£o de m√∫ltiplos datasets com Harmony.\nIntrodu√ß√£o √† integra√ß√£o multimodal: scRNA-seq, scATAC-seq, scTCR-seq.\nIdentifica√ß√£o de assinaturas g√™nicas associadas a estados celulares.\nAula pr√°tica: An√°lise diferencial e integra√ß√£o no Seurat.\nAcompanhamento dos projetos: interpreta√ß√£o de diferen√ßas entre condi√ß√µes.\n\n\n\nSemana 5 ‚Äî Infer√™ncia de Trajet√≥rias e Intera√ß√µes C√©lula-C√©lula\n\nModelagem de pseudotempo com Monocle2.\nAn√°lise de intera√ß√µes c√©lula-c√©lula com LIANA.\nInfer√™ncia de estados celulares ao longo de trajet√≥rias.\nAula pr√°tica: Trajet√≥rias e comunica√ß√£o celular.\nAcompanhamento dos projetos: modelagem de diferencia√ß√£o ou ativa√ß√£o celular.\n\n\n\nSemana 6 ‚Äî Projeto Aplicado\n\nAplica√ß√£o das an√°lises aprendidas a dados reais.\nInterpreta√ß√£o de resultados e gera√ß√£o de figuras.\nIntegra√ß√£o dos resultados obtidos ao longo do curso.\nApresenta√ß√£o e discuss√£o dos projetos finais."
  },
  {
    "objectID": "index.html#metodologia",
    "href": "index.html#metodologia",
    "title": "Introdu√ß√£o √† an√°lise de c√©lula √∫nica",
    "section": "Metodologia",
    "text": "Metodologia\n\nAulas expositivas com exemplos reais.\nPr√°ticas semanais com an√°lise de dados reais.\nDesenvolvimento progressivo de um projeto pr√°tico."
  },
  {
    "objectID": "index.html#ferramentas-e-recursos",
    "href": "index.html#ferramentas-e-recursos",
    "title": "Introdu√ß√£o √† an√°lise de c√©lula √∫nica",
    "section": "Ferramentas e Recursos",
    "text": "Ferramentas e Recursos\n\nLinguagem: R\n\nPrincipais pacotes: Seurat, scDblFinder, Monocle2, Harmony, LIANA\n\nInfraestrutura: Google Colab, HPC ou AWS (a crit√©rio do aluno/grupo)"
  },
  {
    "objectID": "index.html#avalia√ß√£o",
    "href": "index.html#avalia√ß√£o",
    "title": "Introdu√ß√£o √† an√°lise de c√©lula √∫nica",
    "section": "Avalia√ß√£o",
    "text": "Avalia√ß√£o\n\n‚úÖ Participa√ß√£o e exerc√≠cios pr√°ticos ‚Äî 20%\n\nüìÑ Relat√≥rios semanais ‚Äî 30%\n\nüìä Projeto final ‚Äî 50%"
  },
  {
    "objectID": "index.html#bibliografia-recomendada",
    "href": "index.html#bibliografia-recomendada",
    "title": "Introdu√ß√£o √† an√°lise de c√©lula √∫nica",
    "section": "Bibliografia Recomendada",
    "text": "Bibliografia Recomendada\n\nLuecken, M.D.¬†& Theis, F.J. (2019). Current best practices in single-cell RNA-seq analysis: a tutorial. Molecular Systems Biology\nStuart, T. et al.¬†(2019). Comprehensive Integration of Single-Cell Data. Cell\nButler, A. et al.¬†(2018). Integrating single-cell transcriptomic data across different conditions, technologies, and species. Nature Biotechnology"
  },
  {
    "objectID": "index.html#contato",
    "href": "index.html#contato",
    "title": "Introdu√ß√£o √† an√°lise de c√©lula √∫nica",
    "section": "Contato",
    "text": "Contato\nProfessor: üì© andrefonseca@ufpa.br"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre a material",
    "section": "",
    "text": "A Disciplina\nEsta disciplina oferece uma introdu√ß√£o pr√°tica e conceitual √† an√°lise de dados de transcript√¥mica de c√©lula √∫nica (single-cell RNA-seq), com foco em ferramentas computacionais modernas e aplica√ß√µes em contextos biol√≥gicos diversos.\nAo longo do curso, os alunos ter√£o contato com os principais pacotes da linguagem R para an√°lise de dados de scRNA-seq, aprender√£o sobre desenho experimental, controle de qualidade, an√°lise de express√£o g√™nica, integra√ß√£o de dados e infer√™ncia de trajet√≥rias celulares.\nO curso √© estruturado em encontros te√≥ricos e pr√°ticos, com foco na constru√ß√£o progressiva de um projeto aplicado com dados reais.\n\n\nO Professor\nAndr√© Fonseca √© professor visitante na Universidade Federal do Par√° (UFPA) e atua na interface entre bioinform√°tica, biologia molecular e ci√™ncia de dados.\nPossui doutorado em Bioinform√°tica (UFRN), com experi√™ncia em an√°lise de dados √¥micos, transcript√¥mica de c√©lula √∫nica, caracteriza√ß√£o de microambientes tumorais e desenvolvimento de pipelines reprodut√≠veis para an√°lise de dados biom√©dicos. Tamb√©m atuou como pesquisador em institui√ß√µes como MD Anderson Cancer Center e Universidade de Houston.\nAtualmente, coordena projetos voltados para a aplica√ß√£o de intelig√™ncia artificial e bioinform√°tica na caracteriza√ß√£o funcional de c√©lulas em tecidos humanos.\nüì´ Contato: andrefonseca@ufpa.br"
  },
  {
    "objectID": "material/semana1/01_data_collection.html#baixar-os-dados",
    "href": "material/semana1/01_data_collection.html#baixar-os-dados",
    "title": "01 - Coleta de dados",
    "section": "5. Baixar os dados",
    "text": "5. Baixar os dados\nAp√≥s explorar e decidir se o conjunto de dados √© relevante, podemos baix√°-lo. Na etapa de sele√ß√£o do dataset, clique no bot√£o ‚ÄúDownload dataset‚Äù (localizado na mesma tela em que entramos o bot√£o Explorer).\nVoc√™ poder√° baixar diferentes vers√µes dos dados, quando dispon√≠veis:\n\n.h5ad: formato AnnData, amplamente utilizado com Scanpy (Python)\n.csv: tabelas de contagem e metadados em formato tabular\n.rds: formato Seurat, √∫til para integra√ß√£o com pacotes do ecossistema R.\nArquivos complementares (README, metadados, refer√™ncias)\n\n\n‚ö†Ô∏è Aten√ß√£o ao tamanho dos arquivos: um dataset completo pode ter de 500 MB a mais de 20 GB, dependendo do n√∫mero de c√©lulas e da profundidade de sequenciamento.\n\n\n‚ÑπÔ∏è Observa√ß√£o: Nem todos os datasets est√£o dispon√≠veis em todos os formatos. Por exemplo, alguns estudos fornecem apenas .h5ad, enquanto outros incluem .rds ou .csv.\nIsso n√£o √© um impeditivo, pois √© poss√≠vel realizar convers√µes entre formatos usando bibliotecas como: - zellkonverter ou sceasy (para converter .h5ad ‚áÑ .rds) - anndata2ri para interoperabilidade entre R e Python\n\nExemplo de convers√£o de .h5ad para .rds no R:\n\nExemplo: Convertendo .h5ad para .rds com sceasy\n# Instale os pacotes necess√°rios, se ainda n√£o tiver:\n# install.packages(\"remotes\")\n# remotes::install_github(\"cellgeni/sceasy\")\n# remotes::install_github(\"dynverse/reticulate\")\n\nlibrary(sceasy)\nlibrary(reticulate)\n\n# Se necess√°rio, especifique o caminho para seu ambiente Python com anndata instalado:\n# use_python(\"/caminho/para/seu/python\", required = TRUE)\n\n# Converta o arquivo .h5ad para um objeto SingleCellExperiment (.rds)\nsceasy::convertFormat(\n  \"dataset.h5ad\",\n  from = \"anndata\",\n  to = \"seurat\",\n  outFile = \"dataset.rds\"\n)\n\nüìå Nota: Para que a convers√£o funcione corretamente, voc√™ precisa de um ambiente Python com o pacote anndata instalado. Qualquer problema faremos em sala.\n\nA instala√ß√£o do anndata via R pode ser feita atrav√©s do comando:\nreticulate::py_install(\"anndata\")"
  },
  {
    "objectID": "material/semana1/01_data_collection.html#explore-os-datasets-dispon√≠veis",
    "href": "material/semana1/01_data_collection.html#explore-os-datasets-dispon√≠veis",
    "title": "01 - Coleta de dados",
    "section": "2. Explore os datasets dispon√≠veis",
    "text": "2. Explore os datasets dispon√≠veis\nVoc√™ pode utilizar o campo de busca ou aplicar filtros laterais:\n\nOrganismo: Humano, Camundongo, etc.\nTecido: Pulm√£o, Sangue, C√©rebro, etc.\nDoen√ßa: C√¢ncer, COVID-19, etc.\nProjeto ou Estudo (ex: HCA, Tabula Sapiens)\n\n\nüí° Dica: Cada entrada no cat√°logo mostra algumas estatisticas descritivas sobre o dado, por exemplo, o n√∫mero de c√©lulas e a tipo de tecnologia utilizada."
  },
  {
    "objectID": "material/semana1/02_alignment.html",
    "href": "material/semana1/02_alignment.html",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "",
    "text": "Ao realizar um experimento de transcript√¥mica de c√©lula √∫nica com a tecnologia 10x Genomics, o sequenciador fornece arquivos no formato BCL. No entanto, o pesquisador precisa de uma matriz de contagem por c√©lula para realizar an√°lises downstream como clustering, anota√ß√£o e detec√ß√£o de tipos celulares.\nEste tutorial resolve um problema comum: como transformar dados brutos do sequenciador em uma matriz de express√£o confi√°vel, e como interpretar o relat√≥rio de qualidade do pipeline."
  },
  {
    "objectID": "material/semana1/02_alignment.html#ferramentas-utilizadas",
    "href": "material/semana1/02_alignment.html#ferramentas-utilizadas",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "Ferramentas utilizadas",
    "text": "Ferramentas utilizadas\nAs etapas do pipeline e suas respectivas fun√ß√µes s√£o:\n\ncellranger mkfastq: converte arquivos BCL em arquivos FASTQ por amostra.\ncellranger mkref: constr√≥i um genoma de refer√™ncia com anota√ß√µes para alinhamento.\ncellranger count: alinha os reads (com STAR), deduplica UMIs, gera matrizes de express√£o e relat√≥rio final de qualidade."
  },
  {
    "objectID": "material/semana1/02_alignment.html#etapa-1-convers√£o-de-bcl-para-fastq",
    "href": "material/semana1/02_alignment.html#etapa-1-convers√£o-de-bcl-para-fastq",
    "title": "02 - Alinhamento",
    "section": "‚úÖ Etapa 1: Convers√£o de BCL para FASTQ",
    "text": "‚úÖ Etapa 1: Convers√£o de BCL para FASTQ\ncellranger mkfastq \\\n  --id=Sample001 \\\n  --run=/mnt/bcl_run_folder \\\n  --csv=sample_sheet.csv\n\n\n\n\n:::{#quarto-navigation-envelope .hidden}\n[Curso de An√°lise Single-Cell]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1zaWRlYmFyLXRpdGxl\"}\n[Curso de An√°lise Single-Cell]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXItdGl0bGU=\"}\n[In√≠cio]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6SW7DrWNpbw==\"}\n[/index.html]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6L2luZGV4Lmh0bWw=\"}\n[Sobre]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6U29icmU=\"}\n[/about.html]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6L2Fib3V0Lmh0bWw=\"}\n[Semana 1]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6U2VtYW5hIDE=\"}\n[Coleta de Dados]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6Q29sZXRhIGRlIERhZG9z\"}\n[/material/semana1/01_data_collection.html]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6L21hdGVyaWFsL3NlbWFuYTEvMDFfZGF0YV9jb2xsZWN0aW9uLmh0bWw=\"}\n[Alinhamento]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6QWxpbmhhbWVudG8=\"}\n[/material/semana1/02_alignment.html]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLWludC1uYXZiYXI6L21hdGVyaWFsL3NlbWFuYTEvMDJfYWxpZ25tZW50Lmh0bWw=\"}\n\n:::{.hidden .quarto-markdown-envelope-contents render-id=\"Zm9vdGVyLWNlbnRlcg==\"}\nFeito com ‚ù§Ô∏è usando [Quarto](https://quarto.org)\n:::\n\n:::\n\n\n\n:::{#quarto-meta-markdown .hidden}\n[02 - Alinhamento ‚Äì Curso de An√°lise Single-Cell]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLW1ldGF0aXRsZQ==\"}\n[02 - Alinhamento ‚Äì Curso de An√°lise Single-Cell]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLXR3aXR0ZXJjYXJkdGl0bGU=\"}\n[02 - Alinhamento ‚Äì Curso de An√°lise Single-Cell]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLW9nY2FyZHRpdGxl\"}\n[Curso de An√°lise Single-Cell]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLW1ldGFzaXRlbmFtZQ==\"}\n[]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLXR3aXR0ZXJjYXJkZGVzYw==\"}\n[]{.hidden .quarto-markdown-envelope-contents render-id=\"cXVhcnRvLW9nY2FyZGRkZXNj\"}\n:::\n\n\n\n\n&lt;!-- --&gt;\n\n::: {.quarto-embedded-source-code}\n```````````````````{.markdown shortcodes=\"false\"}\n---\ntitle: \"02 - Alinhamento\"\nauthor: \"Andre Fonseca\"\nformat:\n    html:\n      toc: true\n      toc-depth: 3\n      code-fold: true\n      code-tools: true\neditor: visual\n---\n\n# üéØ Motiva√ß√£o\n\nAo realizar um experimento de transcript√¥mica de c√©lula √∫nica com a tecnologia **10x Genomics**, o sequenciador fornece arquivos no formato **BCL**. No entanto, o pesquisador precisa de uma **matriz de contagem por c√©lula** para realizar an√°lises downstream como clustering, anota√ß√£o e detec√ß√£o de tipos celulares.\n\nEste tutorial resolve um problema comum: **como transformar dados brutos do sequenciador em uma matriz de express√£o confi√°vel**, e **como interpretar o relat√≥rio de qualidade** do pipeline.\n\n---\n\n# üß∞ Contextualiza√ß√£o\n\nO **Cell Ranger** √© o pipeline oficial da 10x Genomics para processar dados de scRNA-seq. Ele √© baseado no framework **Martian** e executa desde a demultiplexa√ß√£o at√© a gera√ß√£o das matrizes.\n\n## Ferramentas utilizadas:\n\n| Etapa                  | Ferramenta           | Fun√ß√£o                                                                 |\n|------------------------|----------------------|------------------------------------------------------------------------|\n| Demultiplexa√ß√£o        | `cellranger mkfastq` | Converte arquivos **BCL** em arquivos **FASTQ** por amostra.          |\n| Constru√ß√£o da refer√™ncia | `cellranger mkref`   | Cria genoma de refer√™ncia com anota√ß√µes para alinhamento.             |\n| Alinhamento e contagem | `cellranger count`   | Alinha os reads, deduplica UMIs, gera matrizes e relat√≥rio final.     |\n\n---\n\n# üß¨ Passo-a-passo\n\n## ‚úÖ Etapa 1: Convers√£o de BCL para FASTQ\n\n```bash\ncellranger mkfastq \\\n  --id=Sample001 \\\n  --run=/mnt/bcl_run_folder \\\n  --csv=sample_sheet.csv\n:::"
  },
  {
    "objectID": "material/semana1/02_alignment.html#motiva√ß√£o",
    "href": "material/semana1/02_alignment.html#motiva√ß√£o",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "",
    "text": "Ao realizar um experimento de transcript√¥mica de c√©lula √∫nica com a tecnologia 10x Genomics, o sequenciador fornece arquivos no formato BCL. No entanto, o pesquisador precisa de uma matriz de contagem por c√©lula para realizar an√°lises downstream como clustering, anota√ß√£o e detec√ß√£o de tipos celulares.\nEste tutorial resolve um problema comum: como transformar dados brutos do sequenciador em uma matriz de express√£o confi√°vel, e como interpretar o relat√≥rio de qualidade do pipeline."
  },
  {
    "objectID": "material/semana1/02_alignment.html#contextualiza√ß√£o",
    "href": "material/semana1/02_alignment.html#contextualiza√ß√£o",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "Contextualiza√ß√£o",
    "text": "Contextualiza√ß√£o\nO Cell Ranger √© o pipeline oficial da 10x Genomics para processar dados de scRNA-seq. Ele √© composto por uma s√©rie de ferramentas coordenadas por um framework interno chamado Martian, que gerencia etapas paralelas e arquivos intermedi√°rios. O Cell Ranger executa diversas etapas, incluindo demultiplexa√ß√£o, alinhamento, deduplica√ß√£o de UMIs, quantifica√ß√£o g√™nica e gera√ß√£o de relat√≥rios de qualidade. Para instalar o Cell Ranger, por favor, acesso esse link.\n\nüìå Nota: Durante a etapa de alinhamento, o Cell Ranger utiliza o STAR (Spliced Transcripts Alignment to a Reference) como seu motor principal para mapear os reads de RNA ao genoma de refer√™ncia. O STAR √© um dos alinhadores mais r√°pidos e sens√≠veis para dados de RNA-seq, sendo particularmente adequado para capturar splicing e isoformas em organismos eucariotos. Caso tenha interesse em entender mais sobre o algoritmo, veja o link"
  },
  {
    "objectID": "material/semana1/02_alignment.html#convers√£o-de-bcl-para-fastq",
    "href": "material/semana1/02_alignment.html#convers√£o-de-bcl-para-fastq",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "1. Convers√£o de BCL para FASTQ",
    "text": "1. Convers√£o de BCL para FASTQ\ncellranger mkfastq \\\n  --id=Sample001 \\\n  --run=/mnt/bcl_run_folder \\\n  --csv=sample_sheet.csv\n\nO arquivo sample_sheet.csv deve seguir o padr√£o Illumina, especificando amostras, lanes e barcodes.\n\n\n1.1. Sobre o padr√£o Illumina\nO arquivo CSV segue uma estrutura com cabe√ßalho padronizado e colunas obrigat√≥rias como Sample_ID, Sample_Name, Index, Lane, entre outras. Um exemplo simplificado:\n[Data]\nLane,Sample_ID,Sample_Name,Index\n1,Sample001,Sample001,SI-GA-A1\n\nA se√ß√£o [Data] delimita o in√≠cio da tabela.\nLane N√∫mero da lane do flowcell (geralmente 1, mas pode ser m√∫ltiplas).\nSample_ID Identificador interno para a amostra (aparece nos diret√≥rios).\nSample_NameNome descritivo da amostra, que aparece no nome dos arquivos FASTQ.\nIndex Sequ√™ncia ou nome do √≠ndice (barcode) usado para essa amostra.\n\nPara mais detalhes, consulte a documenta√ß√£o da Illumina.\n\n\n1.2. Sobre o padr√£o 10x Genomics\nAp√≥s a execu√ß√£o do cellranger mkfastq, os arquivos FASTQ seguem uma conven√ß√£o espec√≠fica da 10x Genomics. Para cada amostra, s√£o gerados arquivos separados por tipo de leitura:\nbcl2fastq_output\n|-- HFLC5BBXX\n    |-- Sample001\n    |   |-- Sample001_S1_L001_I1_001.fastq.gz\n    |   |-- Sample001_S1_L001_R1_001.fastq.gz\n    |   |-- Sample001_S1_L001_R2_001.fastq.gz\n|-- Reports\n|-- Stats\n|-- Undetermined_S0_L001_I1_001.fastq.gz\n|-- Undetermined_S0_L001_R1_001.fastq.gz\n|-- Undetermined_S0_L001_R2_001.fastq.gz\nAl√©m disso, a nomenclatura do arquivo √© composta por diferentes campos. Veja abaixo:\n[Sample Name]_S1_L00[Lane Number]_[Read Type]_001.fastq.gz\nEsse nome √© composto por blocos separados por sublinhados (_), com os seguintes significados:\n\nSample001: nome da amostra, herdado do campo Sample_Name do Sample Sheet.\nS1: identificador da amostra atribu√≠do automaticamente pelo bcl2fastq.\nL001: n√∫mero da lane (neste caso, lane 1).\nR1: tipo da leitura:\n\nR1 = Read 1 (Cell barcode + UMI)\nR2 = Read 2 (cDNA)\nI1 = Index Read 1 (Sample index)\n\n001: n√∫mero do set de leitura (geralmente fixo como 001)."
  },
  {
    "objectID": "material/semana1/02_alignment.html#rela√ß√£o-com-o-star",
    "href": "material/semana1/02_alignment.html#rela√ß√£o-com-o-star",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Rela√ß√£o com o STAR",
    "text": "Rela√ß√£o com o STAR\nDurante a etapa de alinhamento, o Cell Ranger utiliza o STAR (Spliced Transcripts Alignment to a Reference) como seu motor principal para mapear os reads de RNA ao genoma de refer√™ncia. O STAR √© um dos alinhadores mais r√°pidos e sens√≠veis para dados de RNA-seq, sendo particularmente adequado para capturar splicing e isoformas em organismos eucariotos."
  },
  {
    "objectID": "material/semana1/02_alignment.html#etapa-2-constru√ß√£o-do-genoma-de-refer√™ncia",
    "href": "material/semana1/02_alignment.html#etapa-2-constru√ß√£o-do-genoma-de-refer√™ncia",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Etapa 2: Constru√ß√£o do Genoma de Refer√™ncia",
    "text": "Etapa 2: Constru√ß√£o do Genoma de Refer√™ncia\ncellranger mkref \\\n  --genome=GRCh38_custom \\\n  --fasta=genome.fa \\\n  --genes=genes.gtf\n\nEntrada: arquivos FASTA com a sequ√™ncia do genoma e GTF com as anota√ß√µes de genes.\nSa√≠da: diret√≥rio contendo a refer√™ncia indexada para uso posterior."
  },
  {
    "objectID": "material/semana1/02_alignment.html#etapa-3-processamento-com-cellranger-count",
    "href": "material/semana1/02_alignment.html#etapa-3-processamento-com-cellranger-count",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Etapa 3: Processamento com cellranger count",
    "text": "Etapa 3: Processamento com cellranger count\ncellranger count \\\n  --id=Sample001 \\\n  --transcriptome=/refs/GRCh38_custom \\\n  --fastqs=/mnt/fastqs \\\n  --sample=Sample001\nEsta etapa realiza:\n\nAlinhamento com STAR.\nIdentifica√ß√£o de c√©lulas por barcodes √∫nicos.\nQuantifica√ß√£o g√™nica por UMI.\nGera√ß√£o das matrizes de contagem e do relat√≥rio de qualidade (web_summary.html)."
  },
  {
    "objectID": "material/semana1/02_alignment.html#etapa-4-interpreta√ß√£o-do-relat√≥rio",
    "href": "material/semana1/02_alignment.html#etapa-4-interpreta√ß√£o-do-relat√≥rio",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Etapa 4: Interpreta√ß√£o do Relat√≥rio",
    "text": "Etapa 4: Interpreta√ß√£o do Relat√≥rio\nO Cell Ranger gera um relat√≥rio interativo (web_summary.html) com gr√°ficos e tabelas que ajudam a avaliar a qualidade do sequenciamento e da captura celular.\nPrincipais m√©tricas e suas interpreta√ß√µes:\n\nEstimated Number of Cells: n√∫mero estimado de c√©lulas √∫nicas com base na distribui√ß√£o de UMIs.\nReads Mapped to Genome: porcentagem de reads que alinharam ao genoma de refer√™ncia (ideal &gt; 80%).\nSequencing Saturation: medida de redund√¢ncia dos reads (ideal &gt; 40%); valores baixos sugerem que mais sequenciamento pode ser necess√°rio.\nFraction Reads in Cells: fra√ß√£o de reads atribu√≠das a barcodes v√°lidos (ideal &gt; 70%).\nValid Barcodes: porcentagem de barcodes reconhecidos como v√°lidos (ideal &gt; 90%).\nMedian Genes per Cell: n√∫mero mediano de genes detectados por c√©lula; depende do tipo celular e qualidade da amostra."
  },
  {
    "objectID": "material/semana1/02_alignment.html#etapa-2-constru√ß√£o-do-genoma-de-refer√™ncia-1",
    "href": "material/semana1/02_alignment.html#etapa-2-constru√ß√£o-do-genoma-de-refer√™ncia-1",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Etapa 2: Constru√ß√£o do Genoma de Refer√™ncia",
    "text": "Etapa 2: Constru√ß√£o do Genoma de Refer√™ncia\ncellranger mkref \\\n  --genome=GRCh38_custom \\\n  --fasta=genome.fa \\\n  --genes=genes.gtf\n\nEntrada: arquivos FASTA com a sequ√™ncia do genoma e GTF com as anota√ß√µes de genes.\nSa√≠da: diret√≥rio contendo a refer√™ncia indexada para uso posterior."
  },
  {
    "objectID": "material/semana1/02_alignment.html#etapa-3-processamento-com-cellranger-count-1",
    "href": "material/semana1/02_alignment.html#etapa-3-processamento-com-cellranger-count-1",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Etapa 3: Processamento com cellranger count",
    "text": "Etapa 3: Processamento com cellranger count\ncellranger count \\\n  --id=Sample001 \\\n  --transcriptome=/refs/GRCh38_custom \\\n  --fastqs=/mnt/fastqs \\\n  --sample=Sample001\nEsta etapa realiza:\n\nAlinhamento com STAR.\nIdentifica√ß√£o de c√©lulas por barcodes √∫nicos.\nQuantifica√ß√£o g√™nica por UMI.\nGera√ß√£o das matrizes de contagem e do relat√≥rio de qualidade (web_summary.html)."
  },
  {
    "objectID": "material/semana1/02_alignment.html#etapa-4-interpreta√ß√£o-do-relat√≥rio-1",
    "href": "material/semana1/02_alignment.html#etapa-4-interpreta√ß√£o-do-relat√≥rio-1",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Etapa 4: Interpreta√ß√£o do Relat√≥rio",
    "text": "Etapa 4: Interpreta√ß√£o do Relat√≥rio\nO Cell Ranger gera um relat√≥rio interativo (web_summary.html) com gr√°ficos e tabelas que ajudam a avaliar a qualidade do sequenciamento e da captura celular.\nPrincipais m√©tricas e suas interpreta√ß√µes:\n\nEstimated Number of Cells: n√∫mero estimado de c√©lulas √∫nicas com base na distribui√ß√£o de UMIs.\nReads Mapped to Genome: porcentagem de reads que alinharam ao genoma de refer√™ncia (ideal &gt; 80%).\nSequencing Saturation: medida de redund√¢ncia dos reads (ideal &gt; 40%); valores baixos sugerem que mais sequenciamento pode ser necess√°rio.\nFraction Reads in Cells: fra√ß√£o de reads atribu√≠das a barcodes v√°lidos (ideal &gt; 70%).\nValid Barcodes: porcentagem de barcodes reconhecidos como v√°lidos (ideal &gt; 90%).\nMedian Genes per Cell: n√∫mero mediano de genes detectados por c√©lula; depende do tipo celular e qualidade da amostra."
  },
  {
    "objectID": "material/semana1/02_alignment.html#questionamentos",
    "href": "material/semana1/02_alignment.html#questionamentos",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "Questionamentos",
    "text": "Questionamentos\n\nO n√∫mero de c√©lulas detectadas est√° de acordo com a expectativa para o protocolo de captura utilizado?\nH√° evid√™ncia de RNA ambiente ou c√©lulas estressadas (baixa fra√ß√£o de reads em c√©lulas)?\nA satura√ß√£o sugere que o sequenciamento foi suficiente ou deveria ser mais profundo?\nA distribui√ß√£o dos genes por c√©lula est√° coerente com o tipo de tecido ou condi√ß√£o estudada?\nOs barcodes inv√°lidos est√£o ocorrendo em excesso, indicando problemas na biblioteca?"
  },
  {
    "objectID": "material/semana1/02_alignment.html#coment√°rios-finais",
    "href": "material/semana1/02_alignment.html#coment√°rios-finais",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "Coment√°rios Finais",
    "text": "Coment√°rios Finais\nEste tutorial demonstrou o uso do Cell Ranger para:\n\nProcessar dados brutos (BCL) at√© a gera√ß√£o das matrizes de contagem por c√©lula.\nAvaliar a qualidade dos dados utilizando o relat√≥rio interativo fornecido pelo pr√≥prio pipeline.\nRefletir criticamente sobre os resultados, visando decis√µes informadas para an√°lises downstream.\n\nA compreens√£o dessa etapa √© essencial para garantir que an√°lises como clustering, infer√™ncia de trajet√≥rias e anota√ß√£o celular sejam conduzidas com dados confi√°veis e bem interpretados."
  },
  {
    "objectID": "material/semana1/02_alignment.html#questionamentos-1",
    "href": "material/semana1/02_alignment.html#questionamentos-1",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Questionamentos",
    "text": "Questionamentos\n\nO n√∫mero de c√©lulas detectadas est√° de acordo com a expectativa para o protocolo de captura utilizado?\nH√° evid√™ncia de RNA ambiente ou c√©lulas estressadas (baixa fra√ß√£o de reads em c√©lulas)?\nA satura√ß√£o sugere que o sequenciamento foi suficiente ou deveria ser mais profundo?\nA distribui√ß√£o dos genes por c√©lula est√° coerente com o tipo de tecido ou condi√ß√£o estudada?\nOs barcodes inv√°lidos est√£o ocorrendo em excesso, indicando problemas na biblioteca?"
  },
  {
    "objectID": "material/semana1/02_alignment.html#coment√°rios-finais-1",
    "href": "material/semana1/02_alignment.html#coment√°rios-finais-1",
    "title": "02 - Alinhamento com Cellranger",
    "section": "Coment√°rios Finais",
    "text": "Coment√°rios Finais\nEste tutorial demonstrou o uso do Cell Ranger para:\n\nProcessar dados brutos (BCL) at√© a gera√ß√£o das matrizes de contagem por c√©lula.\nAvaliar a qualidade dos dados utilizando o relat√≥rio interativo fornecido pelo pr√≥prio pipeline.\nRefletir criticamente sobre os resultados, visando decis√µes informadas para an√°lises downstream.\n\nA compreens√£o dessa etapa √© essencial para garantir que an√°lises como clustering, infer√™ncia de trajet√≥rias e anota√ß√£o celular sejam conduzidas com dados confi√°veis e bem interpretados."
  },
  {
    "objectID": "material/semana1/02_alignment.html#constru√ß√£o-do-genoma-de-refer√™ncia",
    "href": "material/semana1/02_alignment.html#constru√ß√£o-do-genoma-de-refer√™ncia",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "2. Constru√ß√£o do Genoma de Refer√™ncia",
    "text": "2. Constru√ß√£o do Genoma de Refer√™ncia\ncellranger mkref \\\n  --genome=GRCh38_custom \\\n  --fasta=genome.fa \\\n  --genes=genes.gtf\n\nEntrada: arquivos FASTA com a sequ√™ncia do genoma e GTF com as anota√ß√µes de genes.\nSa√≠da: diret√≥rio contendo a refer√™ncia indexada para uso posterior."
  },
  {
    "objectID": "material/semana1/02_alignment.html#processamento-com-cellranger-count",
    "href": "material/semana1/02_alignment.html#processamento-com-cellranger-count",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "3. Processamento com cellranger count",
    "text": "3. Processamento com cellranger count\ncellranger count \\\n  --id=Sample001 \\\n  --transcriptome=/refs/GRCh38_custom \\\n  --fastqs=/mnt/fastqs \\\n  --sample=Sample001\nEsta etapa realiza:\n\nAlinhamento com STAR.\nIdentifica√ß√£o de c√©lulas por barcodes √∫nicos.\nQuantifica√ß√£o g√™nica por UMI.\nGera√ß√£o das matrizes de contagem e do relat√≥rio de qualidade (web_summary.html)."
  },
  {
    "objectID": "material/semana1/02_alignment.html#interpreta√ß√£o-do-relat√≥rio",
    "href": "material/semana1/02_alignment.html#interpreta√ß√£o-do-relat√≥rio",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "4. Interpreta√ß√£o do Relat√≥rio",
    "text": "4. Interpreta√ß√£o do Relat√≥rio\nO Cell Ranger gera um relat√≥rio interativo (web_summary.html) com gr√°ficos e tabelas que ajudam a avaliar a qualidade do sequenciamento e da captura celular.\nPrincipais m√©tricas e suas interpreta√ß√µes:\n\nEstimated Number of Cells: n√∫mero estimado de c√©lulas √∫nicas com base na distribui√ß√£o de UMIs.\nReads Mapped to Genome: porcentagem de reads que alinharam ao genoma de refer√™ncia (ideal &gt; 80%).\nSequencing Saturation: medida de redund√¢ncia dos reads (ideal &gt; 40%); valores baixos sugerem que mais sequenciamento pode ser necess√°rio.\nFraction Reads in Cells: fra√ß√£o de reads atribu√≠das a barcodes v√°lidos (ideal &gt; 70%).\nValid Barcodes: porcentagem de barcodes reconhecidos como v√°lidos (ideal &gt; 90%).\nMedian Genes per Cell: n√∫mero mediano de genes detectados por c√©lula; depende do tipo celular e qualidade da amostra."
  },
  {
    "objectID": "material/semana1/02_alignment.html#recursos-adicionais",
    "href": "material/semana1/02_alignment.html#recursos-adicionais",
    "title": "02 - Alinhamento com Cell Ranger",
    "section": "Recursos adicionais",
    "text": "Recursos adicionais\n\nDocumenta√ß√£o oficial\nTutorial de QC no Seurat\nSTAR aligner"
  },
  {
    "objectID": "material/semana1/03_quality_controle.html",
    "href": "material/semana1/03_quality_controle.html",
    "title": "03 - Controle de qualidade",
    "section": "",
    "text": "Loading required package: SeuratObject\n\n\nLoading required package: sp\n\n\n'SeuratObject' was built under R 4.4.2 but the current version is\n4.4.3; it is recomended that you reinstall 'SeuratObject' as the ABI\nfor R may have changed\n\n\n\nAttaching package: 'SeuratObject'\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, t\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union"
  },
  {
    "objectID": "material/semana1/03_quality_controle.html#o-que-√©-seurat",
    "href": "material/semana1/03_quality_controle.html#o-que-√©-seurat",
    "title": "03 - Controle de qualidade",
    "section": "O que √© Seurat?",
    "text": "O que √© Seurat?\nSeurat √© um pacote R desenvolvido para controle de qualidade, an√°lise e explora√ß√£o de dados de RNA-sequenciamento de c√©lulas individuais. Seurat visa permitir que os usu√°rios identifiquem e interpretem fontes de heterogeneidade a partir de medi√ß√µes transcript√¥micas de c√©lulas individuais e integrem diversos tipos de dados de c√©lulas individuais. Para mais detalhes acesse aqui.\n\n\nCode\nbreast_data &lt;- Read10X(data.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1/data/filtered_feature_bc_matrix/\")\n\n\n\n\nCode\nseurat_object &lt;- CreateSeuratObject(\n  counts = breast_data, project = \"Breast_7k\")\n\n\n\n\nCode\nstr(seurat_object)\n\n\nFormal class 'Seurat' [package \"SeuratObject\"] with 13 slots\n  ..@ assays      :List of 1\n  .. ..$ RNA:Formal class 'Assay5' [package \"SeuratObject\"] with 8 slots\n  .. .. .. ..@ layers    :List of 1\n  .. .. .. .. ..$ counts:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots\n  .. .. .. .. .. .. ..@ i       : int [1:17302030] 339 439 651 1182 1263 1475 1980 2095 2323 2343 ...\n  .. .. .. .. .. .. ..@ p       : int [1:5681] 0 116 4017 10075 12156 12545 17529 20988 21337 21486 ...\n  .. .. .. .. .. .. ..@ Dim     : int [1:2] 36601 5680\n  .. .. .. .. .. .. ..@ Dimnames:List of 2\n  .. .. .. .. .. .. .. ..$ : NULL\n  .. .. .. .. .. .. .. ..$ : NULL\n  .. .. .. .. .. .. ..@ x       : num [1:17302030] 1 1 1 1 1 1 1 1 1 1 ...\n  .. .. .. .. .. .. ..@ factors : list()\n  .. .. .. ..@ cells     :Formal class 'LogMap' [package \"SeuratObject\"] with 1 slot\n  .. .. .. .. .. ..@ .Data: logi [1:5680, 1] TRUE TRUE TRUE TRUE TRUE TRUE ...\n  .. .. .. .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. .. .. .. .. ..$ : chr [1:5680] \"AAACCCAAGATTGGGC-1\" \"AAACCCAGTACTCCGG-1\" \"AAACCCAGTCGTCATA-1\" \"AAACCCATCCTTCTTC-1\" ...\n  .. .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. .. .. ..$ dim     : int [1:2] 5680 1\n  .. .. .. .. .. ..$ dimnames:List of 2\n  .. .. .. .. .. .. ..$ : chr [1:5680] \"AAACCCAAGATTGGGC-1\" \"AAACCCAGTACTCCGG-1\" \"AAACCCAGTCGTCATA-1\" \"AAACCCATCCTTCTTC-1\" ...\n  .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. ..@ features  :Formal class 'LogMap' [package \"SeuratObject\"] with 1 slot\n  .. .. .. .. .. ..@ .Data: logi [1:36601, 1] TRUE TRUE TRUE TRUE TRUE TRUE ...\n  .. .. .. .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. .. .. .. .. ..$ : chr [1:36601] \"MIR1302-2HG\" \"FAM138A\" \"OR4F5\" \"AL627309.1\" ...\n  .. .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. .. .. ..$ dim     : int [1:2] 36601 1\n  .. .. .. .. .. ..$ dimnames:List of 2\n  .. .. .. .. .. .. ..$ : chr [1:36601] \"MIR1302-2HG\" \"FAM138A\" \"OR4F5\" \"AL627309.1\" ...\n  .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. ..@ default   : int 1\n  .. .. .. ..@ assay.orig: chr(0) \n  .. .. .. ..@ meta.data :'data.frame': 36601 obs. of  0 variables\n  .. .. .. ..@ misc      :List of 1\n  .. .. .. .. ..$ calcN: logi TRUE\n  .. .. .. ..@ key       : chr \"rna_\"\n  ..@ meta.data   :'data.frame':    5680 obs. of  3 variables:\n  .. ..$ orig.ident  : Factor w/ 1 level \"Breast_7k\": 1 1 1 1 1 1 1 1 1 1 ...\n  .. ..$ nCount_RNA  : num [1:5680] 2330 32596 49372 7170 711 ...\n  .. ..$ nFeature_RNA: int [1:5680] 116 3901 6058 2081 389 4984 3459 349 149 4293 ...\n  ..@ active.assay: chr \"RNA\"\n  ..@ active.ident: Factor w/ 1 level \"Breast_7k\": 1 1 1 1 1 1 1 1 1 1 ...\n  .. ..- attr(*, \"names\")= chr [1:5680] \"AAACCCAAGATTGGGC-1\" \"AAACCCAGTACTCCGG-1\" \"AAACCCAGTCGTCATA-1\" \"AAACCCATCCTTCTTC-1\" ...\n  ..@ graphs      : list()\n  ..@ neighbors   : list()\n  ..@ reductions  : list()\n  ..@ images      : list()\n  ..@ project.name: chr \"Breast_7k\"\n  ..@ misc        : list()\n  ..@ version     :Classes 'package_version', 'numeric_version'  hidden list of 1\n  .. ..$ : int [1:3] 5 0 2\n  ..@ commands    : list()\n  ..@ tools       : list()\n\n\n\nEstrutura do Objeto Seurat\n\n\n\n\n\n\n\n\nSlot\nTipo de Objeto\nDescri√ß√£o\n\n\n\n\nassays\nLista de Assay\nArmazena dados de express√£o para diferentes modalidades (e.g., RNA, ATAC). Cada Assay cont√©m camadas como counts, data e scale.data.\n\n\nmeta.data\ndata.frame\nMetadados por c√©lula, como nFeature_RNA, nCount_RNA, percent.mt, entre outros.\n\n\nactive.assay\ncharacter\nNome do Assay ativo, utilizado por fun√ß√µes padr√£o como NormalizeData().\n\n\nactive.ident\nfactor\nIdentidade celular ativa, geralmente usada para clusteriza√ß√£o e visualiza√ß√µes.\n\n\nreductions\nLista de DimReduc\nArmazena resultados de redu√ß√µes dimensionais, como PCA, UMAP e t-SNE.\n\n\ngraphs\nLista de Graph\nCont√©m grafos de vizinhan√ßa utilizados em algoritmos de clusteriza√ß√£o, como FindNeighbors().\n\n\nneighbors\nLista\nArmazena informa√ß√µes sobre vizinhos mais pr√≥ximos calculados, √∫teis para m√©todos como UMAP.\n\n\nimages\nLista de SpatialImage\nArmazena dados de imagens espaciais, como os provenientes de experimentos Visium.\n\n\nproject.name\ncharacter\nNome do projeto associado ao objeto Seurat.\n\n\nmisc\nLista\nInforma√ß√µes diversas e adicionais que n√£o se encaixam nos outros slots.\n\n\nversion\npackage_version\nVers√£o do pacote Seurat utilizada para criar o objeto.\n\n\ncommands\nLista de SeuratCommand\nHist√≥rico de comandos aplicados ao objeto, incluindo par√¢metros e timestamps.\n\n\ntools\nLista\nResultados de an√°lises adicionais geradas por outras ferramentas, preenchido por desenvolvedores usando Tool&lt;-.\n\n\n\n\n\nCode\nView(seurat_object@meta.data)"
  },
  {
    "objectID": "material/semana1/03_quality_controle.knit.html",
    "href": "material/semana1/03_quality_controle.knit.html",
    "title": "03 - Controle de qualidade",
    "section": "",
    "text": "Loading required package: SeuratObject\n\n\nLoading required package: sp\n\n\n'SeuratObject' was built under R 4.4.2 but the current version is\n4.4.3; it is recomended that you reinstall 'SeuratObject' as the ABI\nfor R may have changed\n\n\n\nAttaching package: 'SeuratObject'\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, t\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union"
  },
  {
    "objectID": "material/semana1/03_quality_controle.knit.html#o-que-√©-seurat",
    "href": "material/semana1/03_quality_controle.knit.html#o-que-√©-seurat",
    "title": "03 - Controle de qualidade",
    "section": "O que √© Seurat?",
    "text": "O que √© Seurat?\nSeurat √© um pacote R desenvolvido para controle de qualidade, an√°lise e explora√ß√£o de dados de RNA-sequenciamento de c√©lulas individuais. Seurat visa permitir que os usu√°rios identifiquem e interpretem fontes de heterogeneidade a partir de medi√ß√µes transcript√¥micas de c√©lulas individuais e integrem diversos tipos de dados de c√©lulas individuais. Para mais detalhes acesse aqui.\n\n\nCode\nbreast_data &lt;- Read10X(data.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1/data/filtered_feature_bc_matrix/\")\n\n\n\n\nCode\nseurat_object &lt;- CreateSeuratObject(\n  counts = breast_data, project = \"Breast_7k\")\n\n\n\n\nCode\nstr(seurat_object)\n\n\nFormal class 'Seurat' [package \"SeuratObject\"] with 13 slots\n  ..@ assays      :List of 1\n  .. ..$ RNA:Formal class 'Assay5' [package \"SeuratObject\"] with 8 slots\n  .. .. .. ..@ layers    :List of 1\n  .. .. .. .. ..$ counts:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots\n  .. .. .. .. .. .. ..@ i       : int [1:17302030] 339 439 651 1182 1263 1475 1980 2095 2323 2343 ...\n  .. .. .. .. .. .. ..@ p       : int [1:5681] 0 116 4017 10075 12156 12545 17529 20988 21337 21486 ...\n  .. .. .. .. .. .. ..@ Dim     : int [1:2] 36601 5680\n  .. .. .. .. .. .. ..@ Dimnames:List of 2\n  .. .. .. .. .. .. .. ..$ : NULL\n  .. .. .. .. .. .. .. ..$ : NULL\n  .. .. .. .. .. .. ..@ x       : num [1:17302030] 1 1 1 1 1 1 1 1 1 1 ...\n  .. .. .. .. .. .. ..@ factors : list()\n  .. .. .. ..@ cells     :Formal class 'LogMap' [package \"SeuratObject\"] with 1 slot\n  .. .. .. .. .. ..@ .Data: logi [1:5680, 1] TRUE TRUE TRUE TRUE TRUE TRUE ...\n  .. .. .. .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. .. .. .. .. ..$ : chr [1:5680] \"AAACCCAAGATTGGGC-1\" \"AAACCCAGTACTCCGG-1\" \"AAACCCAGTCGTCATA-1\" \"AAACCCATCCTTCTTC-1\" ...\n  .. .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. .. .. ..$ dim     : int [1:2] 5680 1\n  .. .. .. .. .. ..$ dimnames:List of 2\n  .. .. .. .. .. .. ..$ : chr [1:5680] \"AAACCCAAGATTGGGC-1\" \"AAACCCAGTACTCCGG-1\" \"AAACCCAGTCGTCATA-1\" \"AAACCCATCCTTCTTC-1\" ...\n  .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. ..@ features  :Formal class 'LogMap' [package \"SeuratObject\"] with 1 slot\n  .. .. .. .. .. ..@ .Data: logi [1:36601, 1] TRUE TRUE TRUE TRUE TRUE TRUE ...\n  .. .. .. .. .. .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. .. .. .. .. .. ..$ : chr [1:36601] \"MIR1302-2HG\" \"FAM138A\" \"OR4F5\" \"AL627309.1\" ...\n  .. .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. .. .. ..$ dim     : int [1:2] 36601 1\n  .. .. .. .. .. ..$ dimnames:List of 2\n  .. .. .. .. .. .. ..$ : chr [1:36601] \"MIR1302-2HG\" \"FAM138A\" \"OR4F5\" \"AL627309.1\" ...\n  .. .. .. .. .. .. ..$ : chr \"counts\"\n  .. .. .. ..@ default   : int 1\n  .. .. .. ..@ assay.orig: chr(0) \n  .. .. .. ..@ meta.data :'data.frame': 36601 obs. of  0 variables\n  .. .. .. ..@ misc      :List of 1\n  .. .. .. .. ..$ calcN: logi TRUE\n  .. .. .. ..@ key       : chr \"rna_\"\n  ..@ meta.data   :'data.frame':    5680 obs. of  3 variables:\n  .. ..$ orig.ident  : Factor w/ 1 level \"Breast_7k\": 1 1 1 1 1 1 1 1 1 1 ...\n  .. ..$ nCount_RNA  : num [1:5680] 2330 32596 49372 7170 711 ...\n  .. ..$ nFeature_RNA: int [1:5680] 116 3901 6058 2081 389 4984 3459 349 149 4293 ...\n  ..@ active.assay: chr \"RNA\"\n  ..@ active.ident: Factor w/ 1 level \"Breast_7k\": 1 1 1 1 1 1 1 1 1 1 ...\n  .. ..- attr(*, \"names\")= chr [1:5680] \"AAACCCAAGATTGGGC-1\" \"AAACCCAGTACTCCGG-1\" \"AAACCCAGTCGTCATA-1\" \"AAACCCATCCTTCTTC-1\" ...\n  ..@ graphs      : list()\n  ..@ neighbors   : list()\n  ..@ reductions  : list()\n  ..@ images      : list()\n  ..@ project.name: chr \"Breast_7k\"\n  ..@ misc        : list()\n  ..@ version     :Classes 'package_version', 'numeric_version'  hidden list of 1\n  .. ..$ : int [1:3] 5 0 2\n  ..@ commands    : list()\n  ..@ tools       : list()\n\n\n\nEstrutura do Objeto Seurat\n\n\n\n\n\n\n\n\nSlot\nTipo de Objeto\nDescri√ß√£o\n\n\n\n\nassays\nLista de Assay\nArmazena dados de express√£o para diferentes modalidades (e.g., RNA, ATAC). Cada Assay cont√©m camadas como counts, data e scale.data.\n\n\nmeta.data\ndata.frame\nMetadados por c√©lula, como nFeature_RNA, nCount_RNA, percent.mt, entre outros.\n\n\nactive.assay\ncharacter\nNome do Assay ativo, utilizado por fun√ß√µes padr√£o como NormalizeData().\n\n\nactive.ident\nfactor\nIdentidade celular ativa, geralmente usada para clusteriza√ß√£o e visualiza√ß√µes.\n\n\nreductions\nLista de DimReduc\nArmazena resultados de redu√ß√µes dimensionais, como PCA, UMAP e t-SNE.\n\n\ngraphs\nLista de Graph\nCont√©m grafos de vizinhan√ßa utilizados em algoritmos de clusteriza√ß√£o, como FindNeighbors().\n\n\nneighbors\nLista\nArmazena informa√ß√µes sobre vizinhos mais pr√≥ximos calculados, √∫teis para m√©todos como UMAP.\n\n\nimages\nLista de SpatialImage\nArmazena dados de imagens espaciais, como os provenientes de experimentos Visium.\n\n\nproject.name\ncharacter\nNome do projeto associado ao objeto Seurat.\n\n\nmisc\nLista\nInforma√ß√µes diversas e adicionais que n√£o se encaixam nos outros slots.\n\n\nversion\npackage_version\nVers√£o do pacote Seurat utilizada para criar o objeto.\n\n\ncommands\nLista de SeuratCommand\nHist√≥rico de comandos aplicados ao objeto, incluindo par√¢metros e timestamps.\n\n\ntools\nLista\nResultados de an√°lises adicionais geradas por outras ferramentas, preenchido por desenvolvedores usando Tool&lt;-.\n\n\n\n\n\nCode\nView(seurat_object@meta.data)"
  },
  {
    "objectID": "material/semana2/03_quality_control.html",
    "href": "material/semana2/03_quality_control.html",
    "title": "03 - Controle de qualidade",
    "section": "",
    "text": "Antes de realizar qualquer an√°lise explorat√≥ria ou infer√™ncia estat√≠stica com dados de RNA-seq de c√©lula √∫nica (scRNA-seq), √© essencial garantir que os dados sejam de alta qualidade. Diferentemente do RNA-seq convencional (bulk), dados de scRNA-seq s√£o altamente suscet√≠veis a ru√≠do t√©cnico e artefatos experimentais, como c√©lulas mortas, dupletos e contamina√ß√£o por RNA ambiente."
  },
  {
    "objectID": "material/semana2/03_quality_control.html#o-que-√©-seurat",
    "href": "material/semana2/03_quality_control.html#o-que-√©-seurat",
    "title": "03 - Controle de qualidade",
    "section": "O que √© Seurat?",
    "text": "O que √© Seurat?\nSeurat √© um pacote R desenvolvido para controle de qualidade, an√°lise e explora√ß√£o de dados de RNA-sequenciamento de c√©lulas individuais. Seurat visa permitir que os usu√°rios identifiquem e interpretem fontes de heterogeneidade a partir de medi√ß√µes transcript√¥micas de c√©lulas individuais e integrem diversos tipos de dados de c√©lulas individuais. Para mais detalhes acesse aqui.\n\nbreast_data &lt;- Read10X(\n  data.dir = here::here(\"data/filtered_feature_bc_matrix/\"))\n\n\nseurat_object &lt;- CreateSeuratObject(\n  counts = breast_data, project = \"Breast_7k\")"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#contextualiza√ß√£o",
    "href": "material/semana2/03_quality_control.html#contextualiza√ß√£o",
    "title": "03 - Controle de qualidade",
    "section": "Contextualiza√ß√£o",
    "text": "Contextualiza√ß√£o\nDados de RNA-seq de c√©lula √∫nica (scRNA-seq) s√£o poderosos para investigar a heterogeneidade celular, mas exigem um rigoroso controle de qualidade devido √† presen√ßa de ru√≠dos t√©cnicos, c√©lulas danificadas, dupletos e contamina√ß√£o por RNA ambiente.\nNeste tutorial, utilizamos um conjunto de ferramentas complementares:\n\nSeurat para pr√©-processamento, c√°lculo de m√©tricas de qualidade e filtragem de c√©lulas;\nSoupX para identificar e corrigir contamina√ß√£o por RNA ambiente (ambient RNA);\nscDblFinder para detectar e remover dupletos (doublets).\n\nA aplica√ß√£o combinada desses pacotes permite construir um conjunto de c√©lulas de alta qualidade, garantindo que an√°lises posteriores ‚Äî como clusteriza√ß√£o e anota√ß√£o de tipos celulares ‚Äî sejam mais robustas e confi√°veis.\n\nlibrary(Seurat)\nlibrary(scDblFinder)\nlibrary(dplyr)\nlibrary(here)\nlibrary(patchwork)\n\n# Definindo diretorio padrao\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#x",
    "href": "material/semana2/03_quality_control.html#x",
    "title": "03 - Controle de qualidade",
    "section": "X",
    "text": "X\n\nY\n\n# 1. Genes mitocondriais (nomes iniciam com \"MT-\")\nseurat_object[[\"percent.mt\"]] &lt;- PercentageFeatureSet(\n  seurat_object, pattern = \"^MT-\")\n\n# 2. Genes riboss√¥micos (nomes iniciam com \"RPS\" ou \"RPL\")\nseurat_object[[\"percent.ribo\"]] &lt;- PercentageFeatureSet(\n  seurat_object, pattern = \"^RP[SL]\")\n\n# 3. Genes de hemoglobina (nomes iniciam com \"HB\" seguido por letras, excluindo \"HBP\")\nseurat_object[[\"percent.hb\"]] &lt;- PercentageFeatureSet(\n  seurat_object, pattern = \"^HB[^(P)]\")\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nExplanation here.\n\n\n\n\n\n\n\n\n\nTip with Title\n\n\n\n\n\nThis is an example of a callout with a title.\n\n\n\n\nVlnPlot(seurat_object, \n        features = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mt\", \"percent.ribo\", \"percent.hb\"), ncol = 2)\n\nWarning: Default search for \"data\" layer in \"RNA\" assay yielded no results;\nutilizing \"counts\" layer instead."
  },
  {
    "objectID": "material/semana2/03_quality_control.html#estrutura-do-objeto-seurat",
    "href": "material/semana2/03_quality_control.html#estrutura-do-objeto-seurat",
    "title": "03 - Controle de qualidade",
    "section": "Estrutura do Objeto Seurat",
    "text": "Estrutura do Objeto Seurat\nPara visualizar a estrutura do objeto rec√©m-constru√≠dos, podemos utilizar o comando:\n\n# Exibe de forma compacta a estrutura interna de um objeto R\nstr(seurat_object)\n\n\n\n\n\n\n\n\n\nSlot\nTipo de Objeto\nDescri√ß√£o\n\n\n\n\nassays\nLista de Assay\nArmazena dados de express√£o para diferentes modalidades (e.g., RNA, ATAC). Cada Assay cont√©m camadas como counts, data e scale.data.\n\n\nmeta.data\ndata.frame\nMetadados por c√©lula, como nFeature_RNA, nCount_RNA, percent.mt, entre outros.\n\n\nactive.assay\ncharacter\nNome do Assay ativo, utilizado por fun√ß√µes padr√£o como NormalizeData().\n\n\nactive.ident\nfactor\nIdentidade celular ativa, geralmente usada para clusteriza√ß√£o e visualiza√ß√µes.\n\n\nreductions\nLista de DimReduc\nArmazena resultados de redu√ß√µes dimensionais, como PCA, UMAP e t-SNE.\n\n\ngraphs\nLista de Graph\nCont√©m grafos de vizinhan√ßa utilizados em algoritmos de clusteriza√ß√£o, como FindNeighbors().\n\n\nneighbors\nLista\nArmazena informa√ß√µes sobre vizinhos mais pr√≥ximos calculados, √∫teis para m√©todos como UMAP.\n\n\nimages\nLista de SpatialImage\nArmazena dados de imagens espaciais, como os provenientes de experimentos Visium.\n\n\nproject.name\ncharacter\nNome do projeto associado ao objeto Seurat.\n\n\nmisc\nLista\nInforma√ß√µes diversas e adicionais que n√£o se encaixam nos outros slots.\n\n\nversion\npackage_version\nVers√£o do pacote Seurat utilizada para criar o objeto.\n\n\ncommands\nLista de SeuratCommand\nHist√≥rico de comandos aplicados ao objeto, incluindo par√¢metros e timestamps.\n\n\ntools\nLista\nResultados de an√°lises adicionais geradas por outras ferramentas, preenchido por desenvolvedores usando Tool&lt;-.\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA estrutura do objeto Seurat pode sofrer pequenas altera√ß√µes entre vers√µes do pacote, especialmente em rela√ß√£o √† organiza√ß√£o interna dos slots, nomenclatura e slots adicionais utilizados por novos m√©todos.\nEste tutorial foi desenvolvido com a vers√£o Seurat 5.2.1, na qual os principais componentes do objeto ‚Äî como assays, meta.data, reductions, graphs e commands ‚Äî mant√™m compatibilidade com vers√µes anteriores, mas apresentam melhorias de desempenho e integra√ß√£o com m√∫ltiplas modalidades."
  },
  {
    "objectID": "material/semana2/03_quality_control.html#descrevendo-o-metadata",
    "href": "material/semana2/03_quality_control.html#descrevendo-o-metadata",
    "title": "03 - Controle de qualidade",
    "section": "Descrevendo o metadata",
    "text": "Descrevendo o metadata\n\nView(seurat_object@meta.data)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nN√∫mero total de moleculas unicas (nCount_RNA)\n\nN√∫mero de genes detectados (nFeature_RNA)"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#avaliacao-da-qualidade-das-celulas",
    "href": "material/semana2/03_quality_control.html#avaliacao-da-qualidade-das-celulas",
    "title": "03 - Controle de qualidade",
    "section": "Avaliacao da qualidade das celulas",
    "text": "Avaliacao da qualidade das celulas\n\nCalculando percentagem relacionada a genes de interesse\n\n# Genes mitocondriais (nomes iniciam com \"MT-\")\nseurat_object[[\"percent.mt\"]] &lt;- PercentageFeatureSet(\n  seurat_object, pattern = \"^MT-\")\n\n# Genes riboss√¥micos (nomes iniciam com \"RPS\" ou \"RPL\")\nseurat_object[[\"percent.ribo\"]] &lt;- PercentageFeatureSet(\n  seurat_object, pattern = \"^RP[SL]\")\n\n\n# Genes de hemoglobina - remover HBP explicitamente\nhb_genes &lt;- grep(\"^HB\", rownames(seurat_object), value = TRUE)\nhb_genes &lt;- hb_genes[!grepl(\"^HBP\", hb_genes)]\n\nseurat_object[[\"percent.hb\"]] &lt;- PercentageFeatureSet(\n  seurat_object, features = hb_genes)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nEssas porcentagens ajudam a:\n\nFiltrar c√©lulas de baixa qualidade (ex: alto percent.mt);\nIdentificar artefatos ou contamina√ß√µes (ex: gl√≥bulos vermelhos via percent.hb);\nDetectar vi√©s t√©cnico ou diferen√ßas biol√≥gicas significativas (ex: via percent.ribo).\n\nEssas m√©tricas s√£o frequentemente visualizadas via VlnPlot() ou correlacionadas com nCount_RNA para detectar padr√µes suspeitos.\n\n\n\n\n\nSalvando estatistica pre-filtragem\n\npre_qc_stats &lt;- data.frame(\n  number_of_cells = ncol(seurat_object),\n  mean_counts_per_cell = mean(seurat_object$nCount_RNA),\n  median_counts_per_cell = median(seurat_object$nCount_RNA),\n  mean_features_per_cell = mean(seurat_object$nFeature_RNA),\n  median_features_per_cell = median(seurat_object$nFeature_RNA)\n)\n\n\n\nVisualizando atributos de interesse\n\np1 &lt;- VlnPlot(seurat_object, \n        features = c(\"nCount_RNA\", \"nFeature_RNA\"), ncol = 3)\n\np2 &lt;- VlnPlot(seurat_object, \n        features = c(\"percent.mt\", \"percent.ribo\", \"percent.hb\"), ncol = 3)\n\np1\np2\n\n\n\n\n\n\n\nFigure¬†1\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†2\n\n\n\n\n\n\n\nCorrelacionando metricas\nplot1 &lt;- FeatureScatter(seurat_object, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\")\nplot2 &lt;- FeatureScatter(seurat_object, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\")\n\nplot1\nplot2\n\n\n\n\n\n\n\n\n\nFigure¬†3\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†4\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nnCount_RNA vs.¬†nFeature_RNA\nUma correla√ß√£o positiva forte √© esperada: quanto maior o n√∫mero total de transcritos, maior tende a ser o n√∫mero de genes detectados.\n‚Üí Uma correla√ß√£o anormalmente fraca pode indicar problemas t√©cnicos ou presen√ßa de dupletos.\nnCount_RNA vs.¬†percent.mt\nGeralmente apresentam uma correla√ß√£o negativa. C√©lulas com um n√∫mero total maior de mol√©culas de RNA (alto nCount_RNA) s√£o tipicamente associadas a uma porcentagem menor de leituras mitocondriais (menor percent.mt), indicando melhor qualidade celular e menos contamina√ß√£o. ‚Üí Uma alta percentagem mitocondrial com poucos counts pode ser um sinal de apoptose ou lise celular.\n\n\n\n\n\n\nIdentificando thresholds a partir percentagem dos alvos\nEsta fun√ß√£o permite identificar c√©lulas com valores extremos para uma m√©trica cont√≠nua, como nFeature_RNA ou percent.mt, utilizando um crit√©rio estat√≠stico baseado em:\n\nmediana ¬± (n √ó MAD)\n\nEssa abordagem √© mais robusta que o desvio padr√£o, pois √© menos sens√≠vel a valores extremos.\nO argumento nmads controla a sensibilidade da filtragem (3 √© o valor comumente utilizado).\nEssa fun√ß√£o √© √∫til para detectar e remover artefatos experimentais ou c√©lulas an√¥malas de forma personalizada.\n\nis_outlier &lt;- function(seurat_object, metric, nmads = 3, verbose = TRUE) {\n  # Extrai os valores da m√©trica desejada\n  values &lt;- seurat_object@meta.data[[metric]]\n\n  # Calcula mediana e desvio absoluto da mediana (MAD)\n  med &lt;- median(values, na.rm = TRUE)\n  mad_val &lt;- mad(values, center = med, constant = 1, na.rm = TRUE)\n\n  # Define os thresholds inferior e superior\n  lower &lt;- med - nmads * mad_val\n  upper &lt;- med + nmads * mad_val\n\n  # Imprime os limites, se verbose = TRUE\n  if (verbose) {\n    message(glue::glue(\"Outliers para '{metric}' definidos como valores fora do intervalo:\"))\n    message(glue::glue(\"  Inferior: {round(lower, 2)}\"))\n    message(glue::glue(\"  Superior: {round(upper, 2)}\"))\n  }\n\n  # Identifica outliers\n  outlier &lt;- (values &lt; lower) | (values &gt; upper)\n  return(outlier)\n}\n\n\nseurat_object$mt_outlier &lt;- is_outlier(\n  seurat_object, metric = \"percent.mt\", nmads = 3)\n\nOutliers para 'percent.mt' definidos como valores fora do intervalo:\n\n\n  Inferior: -15.07\n\n\n  Superior: 41.41\n\ntable(seurat_object$mt_outlier)\n\n\nFALSE  TRUE \n 3719  1961"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#filtrando-celulas-de-baixa-qualidade",
    "href": "material/semana2/03_quality_control.html#filtrando-celulas-de-baixa-qualidade",
    "title": "03 - Controle de qualidade",
    "section": "Filtrando celulas de baixa qualidade",
    "text": "Filtrando celulas de baixa qualidade\n\n# Criando copia do objeto pre-filtragem\npre_seurat_object &lt;- seurat_object\n\n# Filtro com thresholds definidos manualmente\nseurat_object &lt;- subset(\n  seurat_object,\n  subset = nFeature_RNA &gt; 200 &\n           nFeature_RNA &lt; 6000 &\n           percent.mt &lt; 10 &\n           scDblFinder.class == \"singlet\"\n)\n\n\nSalvando estatistica pos-filtragem\n\n# Estat√≠sticas ap√≥s o QC\npost_qc_stats &lt;- data.frame(\n  number_of_cells = ncol(seurat_object),\n  mean_counts_per_cell = mean(seurat_object$nCount_RNA),\n  median_counts_per_cell = median(seurat_object$nCount_RNA),\n  mean_features_per_cell = mean(seurat_object$nFeature_RNA),\n  median_features_per_cell = median(seurat_object$nFeature_RNA)\n)\n\n\n\nCombinando as metricas\n\n# Unindo as tabelas\nqc_summary &lt;- rbind(\n  cbind(Etapa = \"Antes do QC\", pre_qc_stats),\n  cbind(Etapa = \"Depois do QC\", post_qc_stats)\n)"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#comparando-antes-e-depois",
    "href": "material/semana2/03_quality_control.html#comparando-antes-e-depois",
    "title": "03 - Controle de qualidade",
    "section": "Comparando antes e depois",
    "text": "Comparando antes e depois\nDT::datatable(qc_summary)"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#normalizando-o-dado",
    "href": "material/semana2/03_quality_control.html#normalizando-o-dado",
    "title": "03 - Controle de qualidade",
    "section": "Normalizando o dado",
    "text": "Normalizando o dado\n\nseurat_object &lt;- NormalizeData(\n  seurat_object, normalization.method = \"LogNormalize\", scale.factor = 10000)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA normaliza√ß√£o √© uma etapa fundamental no pr√©-processamento de dados de RNA-seq de c√©lula √∫nica. Ela tem como objetivo corrigir varia√ß√µes na profundidade de sequenciamento entre c√©lulas\nM√©todos dispon√≠veis no argumento normalization.method:\n\n‚ÄúLogNormalize‚Äù: m√©todo padr√£o, baseado em normaliza√ß√£o por profundidade e log-transforma√ß√£o;\n‚ÄúCLR‚Äù (Centered Log-Ratio): √∫til para dados de prote√≠nas ou marcadores em CITE-seq;\n‚ÄúRC‚Äù (Relative Counts): contagens relativas sem transforma√ß√£o logar√≠tmica;\n‚ÄúSCT‚Äù: normaliza√ß√£o baseada em modelos estat√≠sticos via SCTransform() (mais avan√ßado, recomendado para integra√ß√£o de dados).\n\n\n\n\nseurat_object &lt;- FindVariableFeatures(\n  seurat_object, selection.method = \"vst\", nfeatures = 2000)\n\nFinding variable features for layer counts\n\n# Identify the 10 most highly variable genes\ntop10 &lt;- head(VariableFeatures(seurat_object), 10)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(seurat_object)\nplot2 &lt;- LabelPoints(plot = plot1, points = top10, repel = TRUE)\n\nWhen using repel, set xnudge and ynudge to 0 for optimal results\n\nplot2\n\nWarning in scale_x_log10(): log-10 transformation introduced infinite values.\n\n\n\n\n\n\n\n\n\n\nFigure¬†5"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#motiva√ß√£o",
    "href": "material/semana2/03_quality_control.html#motiva√ß√£o",
    "title": "03 - Controle de qualidade",
    "section": "",
    "text": "Antes de realizar qualquer an√°lise explorat√≥ria ou infer√™ncia estat√≠stica com dados de RNA-seq de c√©lula √∫nica (scRNA-seq), √© essencial garantir que os dados sejam de alta qualidade. Diferentemente do RNA-seq convencional (bulk), dados de scRNA-seq s√£o altamente suscet√≠veis a ru√≠do t√©cnico e artefatos experimentais, como c√©lulas mortas, dupletos e contamina√ß√£o por RNA ambiente."
  },
  {
    "objectID": "material/semana2/03_quality_control.html#identificando-doublets",
    "href": "material/semana2/03_quality_control.html#identificando-doublets",
    "title": "03 - Controle de qualidade",
    "section": "Identificando doublets",
    "text": "Identificando doublets\nDupletos (doublets) ocorrem quando duas c√©lulas distintas s√£o capturadas dentro da mesma got√≠cula durante a etapa de microencapsulamento (como no 10x Genomics). Como resultado, seus perfis transcript√¥micos s√£o combinados e registrados como uma √∫nica c√©lula.\n\nPor que isso √© um problema?\n\nDupletos podem formar clusters artificiais ou preencher espa√ßos entre popula√ß√µes reais, confundindo a interpreta√ß√£o biol√≥gica.\nEm an√°lises downstream, como clusteriza√ß√£o, diferencia√ß√£o de tipos celulares e descoberta de trajet√≥rias, os dupletos introduzem ru√≠do.\n\nFerramentas como scDblFinder, Scrublet e DoubletFinder utilizam estrat√©gias estat√≠sticas e simula√ß√µes para identificar prov√°veis dupletos com base na similaridade de perfis de express√£o e distribui√ß√£o de vizinhos.\n\n# Converta o objeto Seurat para SingleCellExperiment\nsce &lt;- as.SingleCellExperiment(seurat_object)\n\n# Executa a identifica√ß√£o de dupletos\nsce &lt;- scDblFinder(sce)\n\n# Adiciona o resultado de volta ao objeto Seurat\nseurat_object$scDblFinder.class &lt;- sce$scDblFinder.class\nseurat_object$doublet_score &lt;- sce$scDblFinder.score\n\n# Visualiza a propor√ß√£o de dupletos identificados\ntable(seurat_object$scDblFinder.class)\n\n\nsinglet doublet \n   5203     477"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#removendo-rna-ambiental",
    "href": "material/semana2/03_quality_control.html#removendo-rna-ambiental",
    "title": "03 - Controle de qualidade",
    "section": "Removendo RNA ambiental",
    "text": "Removendo RNA ambiental"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#normalizando---protocolo-padrao",
    "href": "material/semana2/03_quality_control.html#normalizando---protocolo-padrao",
    "title": "03 - Controle de qualidade",
    "section": "Normalizando - Protocolo padrao",
    "text": "Normalizando - Protocolo padrao\n\nseurat_object &lt;- NormalizeData(\n  seurat_object, normalization.method = \"LogNormalize\", scale.factor = 10000)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA normaliza√ß√£o √© uma etapa fundamental no pr√©-processamento de dados de RNA-seq de c√©lula √∫nica. Ela tem como objetivo corrigir varia√ß√µes na profundidade de sequenciamento entre c√©lulas\nM√©todos dispon√≠veis no argumento normalization.method:\n\n‚ÄúLogNormalize‚Äù: m√©todo padr√£o, baseado em normaliza√ß√£o por profundidade e log-transforma√ß√£o;\n‚ÄúCLR‚Äù (Centered Log-Ratio): √∫til para dados de prote√≠nas ou marcadores em CITE-seq;\n‚ÄúRC‚Äù (Relative Counts): contagens relativas sem transforma√ß√£o logar√≠tmica;\n‚ÄúSCT‚Äù: normaliza√ß√£o baseada em modelos estat√≠sticos via SCTransform() (mais avan√ßado, recomendado para integra√ß√£o de dados).\n\n\n\n\n\nEncontrando genes com alta variabilidade\nseurat_object &lt;- FindVariableFeatures(\n  seurat_object, selection.method = \"vst\", nfeatures = 2000)\n\n# Identify the 10 most highly variable genes\ntop10 &lt;- head(VariableFeatures(seurat_object), 10)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(seurat_object)\nplot2 &lt;- LabelPoints(plot = plot1, points = top10, repel = TRUE)\n\nplot2\n\n\n\n\n\n\n\n\n\nFigure¬†5\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO c√≥digo abaixo identifica os genes com maior variabilidade de express√£o entre as c√©lulas, que s√£o mais informativos para an√°lises downstream como PCA, clusteriza√ß√£o e UMAP.\n\nselection.method: O m√©todo vst eh baseado em transforma√ß√£o de vari√¢ncia estabilizada (log-linear), ideal para scRNA-seq;\nnfeatures: quantidade de genes a serem mantidos como ‚Äúaltamente vari√°veis‚Äù.\n\n\n\n\n\n\nAjustando escala dos dados\n\nseurat_object &lt;- ScaleData(seurat_object)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o ScaleData() realiza a padroniza√ß√£o dos dados de express√£o g√™nica, centralizando os valores (subtraindo a m√©dia) e escalando pela vari√¢ncia (dividindo pelo desvio padr√£o) para cada gene.\nEssa etapa √© essencial para t√©cnicas como PCA e clustering, pois garante que todos os genes contribuam igualmente, independentemente da magnitude de sua express√£o."
  },
  {
    "objectID": "material/semana2/03_quality_control.html#normalizando---sctransform",
    "href": "material/semana2/03_quality_control.html#normalizando---sctransform",
    "title": "03 - Controle de qualidade",
    "section": "Normalizando - SCTransform",
    "text": "Normalizando - SCTransform\nJ√° o SCTransform() substitui essas tr√™s etapas com um √∫nico comando baseado em um modelo estat√≠stico de regress√£o negativa binomial, que:\n\nNormaliza os dados levando em conta a vari√¢ncia t√©cnica estimada;\nIdentifica genes vari√°veis de forma mais robusta;\nCorrige efeitos indesejados (como % de genes mitocondriais ou batch effect) diretamente no modelo;\nRetorna dados j√° escalados e prontos para PCA.\n\n\nseurat_object &lt;- SCTransform(\n  seurat_object, vars.to.regress = \"percent.mt\", verbose = FALSE)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO argumento vars.to.regress permite remover o efeito de vari√°veis indesejadas ‚Äî como porcentagem de transcritos mitocondriais (percent.mt), ciclo celular ou batch ‚Äî durante a modelagem estat√≠stica realizada pelo SCTransform(). Para mais detalhes, por favor acesso o link"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#reducao-da-dimensionalidade",
    "href": "material/semana2/03_quality_control.html#reducao-da-dimensionalidade",
    "title": "03 - Controle de qualidade",
    "section": "Reducao da dimensionalidade",
    "text": "Reducao da dimensionalidade\nDados de scRNA-seq possuem alt√≠ssima dimensionalidade, com milhares de genes medidos por c√©lula. Trabalhar diretamente com todas essas dimens√µes √©:\n\nComputacionalmente ineficiente;\nPropenso a ru√≠do (a maioria dos genes n√£o √© informativa para varia√ß√£o biol√≥gica relevante);\nInadequado para visualiza√ß√£o e interpreta√ß√£o humana.\n\nA redu√ß√£o de dimensionalidade, como PCA (an√°lise de componentes principais) ou UMAP (proje√ß√£o para espa√ßo n√£o linear), nos permite resumir os dados em eixos principais de varia√ß√£o, destacando padr√µes estruturais ‚Äî como grupos celulares, trajet√≥rias ou batch effects ‚Äî enquanto minimizamos a influ√™ncia de ru√≠dos t√©cnicos.\nEssa etapa √© essencial para visualiza√ß√£o, clusteriza√ß√£o e modelagem de trajet√≥rias em an√°lises de transcript√¥mica de c√©lula √∫nica.\n\nseurat_object &lt;- RunPCA(\n  seurat_object, assay = \"RNA\", reduction.name = \"STD_PCA\", features = VariableFeatures(object = seurat_object))\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO argumento reduction.name permite nomear explicitamente o resultado da redu√ß√£o de dimensionalidade, neste caso, da an√°lise de componentes principais (PCA). Por padr√£o, o Seurat armazena o PCA no slot \"pca\", mas ao especificar:\n\n\n\n\n# Examine and visualize PCA results a few different ways\nVizDimLoadings(seurat_object, dims = 1:2, reduction = \"STD_PCA\")\n\n\n\n\n\n\n\nFigure¬†6"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#produzindo-as-projecoes-com-umap",
    "href": "material/semana2/03_quality_control.html#produzindo-as-projecoes-com-umap",
    "title": "03 - Controle de qualidade",
    "section": "Produzindo as projecoes com UMAP",
    "text": "Produzindo as projecoes com UMAP\nO UMAP (Uniform Manifold Approximation and Projection) √© uma t√©cnica de redu√ß√£o de dimensionalidade n√£o linear amplamente utilizada para visualizar dados de scRNA-seq.\nEle projeta c√©lulas de um espa√ßo de milhares de genes para 2D ou 3D, preservando estruturas locais e globais dos dados. Isso facilita a identifica√ß√£o visual de subpopula√ß√µes celulares, transi√ß√µes fenot√≠picas e poss√≠veis trajet√≥rias biol√≥gicas, sendo especialmente √∫til ap√≥s PCA.\n\nseurat_object &lt;- RunUMAP(\n  seurat_object, reduction = \"STD_PCA\", umap.method = \"umap-learn\", reduction.name = \"STD_UMAP\", dims = 1:20, verbose = FALSE)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO par√¢metro umap.method = \"umap-learn\" especifica que o Seurat deve usar a implementa√ß√£o original do UMAP em Python, fornecida pelo pacote umap-learn.\nEssa vers√£o tende a produzir proje√ß√µes mais est√°veis e refinadas do que a implementa√ß√£o padr√£o em R, especialmente em datasets grandes ou com estrutura complexa. Para funcionar, √© necess√°rio ter o Python instalado com o pacote umap-learn dispon√≠vel via reticulate.\n\n\n\n\nDimPlot(seurat_object, reduction = \"STD_UMAP\")\n\n\n\n\n\n\n\nFigure¬†7"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#avalia√ß√£o-da-qualidade-das-c√©lulas",
    "href": "material/semana2/03_quality_control.html#avalia√ß√£o-da-qualidade-das-c√©lulas",
    "title": "03 - Controle de qualidade",
    "section": "Avalia√ß√£o da qualidade das c√©lulas",
    "text": "Avalia√ß√£o da qualidade das c√©lulas\n\nCalculando percentagem relacionada a genes de interesse\n\n# Genes mitocondriais (nomes iniciam com \"MT-\")\nseurat_object[[\"percent.mt\"]] &lt;- PercentageFeatureSet(\n  seurat_object, pattern = \"^MT-\")\n\n# Genes riboss√¥micos (nomes iniciam com \"RPS\" ou \"RPL\")\nseurat_object[[\"percent.ribo\"]] &lt;- PercentageFeatureSet(\n  seurat_object, pattern = \"^RP[SL]\")\n\n\n# Genes de hemoglobina - remover HBP explicitamente\nhb_genes &lt;- grep(\"^HB\", rownames(seurat_object), value = TRUE)\nhb_genes &lt;- hb_genes[!grepl(\"^HBP\", hb_genes)]\n\nseurat_object[[\"percent.hb\"]] &lt;- PercentageFeatureSet(\n  seurat_object, features = hb_genes)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nEssas porcentagens ajudam a:\n\nFiltrar c√©lulas de baixa qualidade (ex: alto percent.mt);\nIdentificar artefatos ou contamina√ß√µes (ex: gl√≥bulos vermelhos via percent.hb);\nDetectar vi√©s t√©cnico ou diferen√ßas biol√≥gicas significativas (ex: via percent.ribo).\n\nEssas m√©tricas s√£o frequentemente visualizadas via VlnPlot() ou correlacionadas com nCount_RNA para detectar padr√µes suspeitos.\n\n\n\n\n\nSalvando estat√≠sticas pr√©-filtragem\n\npre_qc_stats &lt;- data.frame(\n  number_of_cells = ncol(seurat_object),\n  mean_counts_per_cell = mean(seurat_object$nCount_RNA),\n  median_counts_per_cell = median(seurat_object$nCount_RNA),\n  mean_features_per_cell = mean(seurat_object$nFeature_RNA),\n  median_features_per_cell = median(seurat_object$nFeature_RNA)\n)\n\n\n\nVisualizando m√©tricas de interesse\n\np1 &lt;- VlnPlot(seurat_object, \n        features = c(\"nCount_RNA\", \"nFeature_RNA\"), ncol = 3)\n\np2 &lt;- VlnPlot(seurat_object, \n        features = c(\"percent.mt\", \"percent.ribo\", \"percent.hb\"), ncol = 3)\n\np1\np2\n\n\n\n\n\n\n\nFigure¬†1\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†2\n\n\n\n\n\n\n\nCorrelacionando m√©tricas\nplot1 &lt;- FeatureScatter(seurat_object, feature1 = \"nCount_RNA\", feature2 = \"percent.mt\")\nplot2 &lt;- FeatureScatter(seurat_object, feature1 = \"nCount_RNA\", feature2 = \"nFeature_RNA\")\n\nplot1\nplot2\n\n\n\n\n\n\n\n\n\nFigure¬†3\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†4\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nnCount_RNA vs.¬†nFeature_RNA\nUma correla√ß√£o positiva forte √© esperada: quanto maior o n√∫mero total de transcritos, maior tende a ser o n√∫mero de genes detectados.\n‚Üí Uma correla√ß√£o anormalmente fraca pode indicar problemas t√©cnicos ou presen√ßa de dupletos.\nnCount_RNA vs.¬†percent.mt\nGeralmente apresentam uma correla√ß√£o negativa. C√©lulas com um n√∫mero total maior de mol√©culas de RNA (alto nCount_RNA) s√£o tipicamente associadas a uma porcentagem menor de leituras mitocondriais (menor percent.mt), indicando melhor qualidade celular e menos contamina√ß√£o. ‚Üí Uma alta percentagem mitocondrial com poucos counts pode ser um sinal de apoptose ou lise celular.\n\n\n\n\n\n\nIdentificando limiares de corte\nEsta fun√ß√£o permite identificar c√©lulas com valores extremos para uma m√©trica cont√≠nua, como nFeature_RNA ou percent.mt, utilizando um crit√©rio estat√≠stico baseado em:\n\nmediana ¬± (n √ó MAD)\n\nEssa abordagem √© mais robusta que o desvio padr√£o, pois √© menos sens√≠vel a valores extremos.\nO argumento nmads controla a sensibilidade da filtragem (3 √© o valor comumente utilizado).\nEsta fun√ß√£o √© √∫til para detectar e remover artefatos experimentais ou c√©lulas an√¥malas de forma personalizada.\n\nis_outlier &lt;- function(seurat_object, metric, nmads = 3, verbose = TRUE) {\n  # Extrai os valores da m√©trica desejada\n  values &lt;- seurat_object@meta.data[[metric]]\n\n  # Calcula mediana e desvio absoluto da mediana (MAD)\n  med &lt;- median(values, na.rm = TRUE)\n  mad_val &lt;- mad(values, center = med, constant = 1, na.rm = TRUE)\n\n  # Define os thresholds inferior e superior\n  lower &lt;- med - nmads * mad_val\n  upper &lt;- med + nmads * mad_val\n\n  # Imprime os limites, se verbose = TRUE\n  if (verbose) {\n    message(glue::glue(\"Outliers para '{metric}' definidos como valores fora do intervalo:\"))\n    message(glue::glue(\"  Inferior: {round(lower, 2)}\"))\n    message(glue::glue(\"  Superior: {round(upper, 2)}\"))\n  }\n\n  # Identifica outliers\n  outlier &lt;- (values &lt; lower) | (values &gt; upper)\n  return(outlier)\n}\n\n\nseurat_object$mt_outlier &lt;- is_outlier(\n  seurat_object, metric = \"percent.mt\", nmads = 3)\n\nOutliers para 'percent.mt' definidos como valores fora do intervalo:\n\n\n  Inferior: -15.07\n\n\n  Superior: 41.41\n\ntable(seurat_object$mt_outlier)\n\n\nFALSE  TRUE \n 3719  1961"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#identificando-dupletos",
    "href": "material/semana2/03_quality_control.html#identificando-dupletos",
    "title": "03 - Controle de qualidade",
    "section": "Identificando dupletos",
    "text": "Identificando dupletos\nDupletos (doublets) ocorrem quando duas c√©lulas distintas s√£o capturadas dentro da mesma got√≠cula durante a etapa de microencapsulamento (como no 10x Genomics). Como resultado, seus perfis transcript√¥micos s√£o combinados e registrados como uma √∫nica c√©lula.\n\nPor que isso √© um problema?\n\nDupletos podem formar clusters artificiais ou preencher espa√ßos entre popula√ß√µes reais, confundindo a interpreta√ß√£o biol√≥gica.\nEm an√°lises downstream, como clusteriza√ß√£o, diferencia√ß√£o de tipos celulares e descoberta de trajet√≥rias, os dupletos introduzem ru√≠do.\n\nFerramentas como scDblFinder, Scrublet e DoubletFinder utilizam estrat√©gias estat√≠sticas e simula√ß√µes para identificar prov√°veis dupletos com base na similaridade de perfis de express√£o e distribui√ß√£o de vizinhos.\n\n# Converta o objeto Seurat para SingleCellExperiment\nsce &lt;- as.SingleCellExperiment(seurat_object)\n\n# Executa a identifica√ß√£o de dupletos\nsce &lt;- scDblFinder(sce)\n\n# Adiciona o resultado de volta ao objeto Seurat\nseurat_object$scDblFinder.class &lt;- sce$scDblFinder.class\nseurat_object$doublet_score &lt;- sce$scDblFinder.score\n\n# Visualiza a propor√ß√£o de dupletos identificados\ntable(seurat_object$scDblFinder.class)\n\n\nsinglet doublet \n   5203     477"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#normaliza√ß√£o-protocolo-padr√£o",
    "href": "material/semana2/03_quality_control.html#normaliza√ß√£o-protocolo-padr√£o",
    "title": "03 - Controle de qualidade",
    "section": "Normaliza√ß√£o ‚Äî Protocolo padr√£o",
    "text": "Normaliza√ß√£o ‚Äî Protocolo padr√£o\n\nseurat_object &lt;- NormalizeData(\n  seurat_object, normalization.method = \"LogNormalize\", scale.factor = 10000)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA normaliza√ß√£o √© uma etapa fundamental no pr√©-processamento de dados de c√©lula √∫nica. Ela tem como objetivo corrigir varia√ß√µes na profundidade de sequenciamento entre c√©lulas\nM√©todos dispon√≠veis no argumento normalization.method:\n\n‚ÄúLogNormalize‚Äù: m√©todo padr√£o, baseado em normaliza√ß√£o por profundidade e log-transforma√ß√£o;\n‚ÄúCLR‚Äù (Centered Log-Ratio): √∫til para dados de prote√≠nas ou marcadores em CITE-seq;\n‚ÄúRC‚Äù (Relative Counts): contagens relativas sem transforma√ß√£o logar√≠tmica;\n‚ÄúSCT‚Äù: normaliza√ß√£o baseada em modelos estat√≠sticos via SCTransform() (mais avan√ßado, recomendado para integra√ß√£o de dados).\n\n\n\n\n\nEncontrando genes com alta variabilidade\nseurat_object &lt;- FindVariableFeatures(\n  seurat_object, selection.method = \"vst\", nfeatures = 2000)\n\n# Identify the 10 most highly variable genes\ntop10 &lt;- head(VariableFeatures(seurat_object), 10)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(seurat_object)\nplot2 &lt;- LabelPoints(plot = plot1, points = top10, repel = TRUE)\n\nplot2\n\n\n\n\n\n\n\n\n\nFigure¬†5\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO c√≥digo abaixo identifica os genes com maior variabilidade de express√£o entre as c√©lulas, que s√£o mais informativos para an√°lises downstream como PCA, clusteriza√ß√£o e UMAP.\n\nselection.method: O m√©todo vst √© baseado em transforma√ß√£o de vari√¢ncia estabilizada (log-linear), ideal para scRNA-seq;\nnfeatures: quantidade de genes a serem mantidos como ‚Äúaltamente vari√°veis‚Äù.\n\n\n\n\n\n\nAjustando escala dos dados\n\nseurat_object &lt;- ScaleData(seurat_object)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o ScaleData() realiza a padroniza√ß√£o dos dados de express√£o g√™nica, centralizando os valores (subtraindo a m√©dia) e escalando pela vari√¢ncia (dividindo pelo desvio padr√£o) para cada gene.\nEssa etapa √© essencial para t√©cnicas como PCA e clustering, pois garante que todos os genes contribuam igualmente, independentemente da magnitude de sua express√£o."
  },
  {
    "objectID": "material/semana2/03_quality_control.html#normaliza√ß√£o---sctransform",
    "href": "material/semana2/03_quality_control.html#normaliza√ß√£o---sctransform",
    "title": "03 - Controle de qualidade",
    "section": "Normaliza√ß√£o - SCTransform",
    "text": "Normaliza√ß√£o - SCTransform\nJ√° o SCTransform() substitui essas tr√™s etapas com um √∫nico comando baseado em um modelo estat√≠stico de regress√£o negativa binomial, que:\n\nNormaliza os dados levando em conta a vari√¢ncia t√©cnica estimada;\nIdentifica genes vari√°veis de forma mais robusta;\nCorrige efeitos indesejados (como % de genes mitocondriais ou batch effect) diretamente no modelo;\nRetorna dados j√° escalados e prontos para PCA.\n\n\nseurat_object &lt;- SCTransform(\n  seurat_object, vars.to.regress = \"percent.mt\", verbose = FALSE)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO argumento vars.to.regress permite remover o efeito de vari√°veis indesejadas ‚Äî como porcentagem de transcritos mitocondriais (percent.mt), ciclo celular ou batch ‚Äî durante a modelagem estat√≠stica realizada pelo SCTransform(). Para mais detalhes, por favor acesso o link"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#redu√ß√£o-de-dimensionalidade",
    "href": "material/semana2/03_quality_control.html#redu√ß√£o-de-dimensionalidade",
    "title": "03 - Controle de qualidade",
    "section": "Redu√ß√£o de dimensionalidade",
    "text": "Redu√ß√£o de dimensionalidade\nDados de scRNA-seq possuem alt√≠ssima dimensionalidade, com milhares de genes medidos por c√©lula. Trabalhar diretamente com todas essas dimens√µes √©:\n\nComputacionalmente ineficiente;\nPropenso a ru√≠do (a maioria dos genes n√£o √© informativa para varia√ß√£o biol√≥gica relevante);\nInadequado para visualiza√ß√£o e interpreta√ß√£o humana.\n\nA redu√ß√£o de dimensionalidade, como PCA (an√°lise de componentes principais) ou UMAP (proje√ß√£o para espa√ßo n√£o linear), nos permite resumir os dados em eixos principais de varia√ß√£o, destacando padr√µes estruturais ‚Äî como grupos celulares, trajet√≥rias ou batch effects ‚Äî enquanto minimizamos a influ√™ncia de ru√≠dos t√©cnicos.\nEssa etapa √© essencial para visualiza√ß√£o, clusteriza√ß√£o e modelagem de trajet√≥rias em an√°lises de transcript√¥mica de c√©lula √∫nica.\n\nseurat_object &lt;- RunPCA(\n  seurat_object, assay = \"RNA\", reduction.name = \"STD_PCA\", features = VariableFeatures(object = seurat_object))\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO argumento reduction.name permite nomear explicitamente o resultado da redu√ß√£o de dimensionalidade, neste caso, da an√°lise de componentes principais (PCA). Por padr√£o, o Seurat armazena o PCA no slot \"pca\", mas ao especificar:\n\n\n\n\n# Examine and visualize PCA results a few different ways\nVizDimLoadings(seurat_object, dims = 1:2, reduction = \"STD_PCA\")\n\n\n\n\n\n\n\nFigure¬†6"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#proje√ß√£o-com-umap",
    "href": "material/semana2/03_quality_control.html#proje√ß√£o-com-umap",
    "title": "03 - Controle de qualidade",
    "section": "Proje√ß√£o com UMAP",
    "text": "Proje√ß√£o com UMAP\nO UMAP (Uniform Manifold Approximation and Projection) √© uma t√©cnica de redu√ß√£o de dimensionalidade n√£o linear amplamente utilizada para visualizar dados de scRNA-seq.\nEle projeta c√©lulas de um espa√ßo de milhares de genes para 2D ou 3D, preservando estruturas locais e globais dos dados. Isso facilita a identifica√ß√£o visual de subpopula√ß√µes celulares, transi√ß√µes fenot√≠picas e poss√≠veis trajet√≥rias biol√≥gicas, sendo especialmente √∫til ap√≥s PCA.\n\nseurat_object &lt;- RunUMAP(\n  seurat_object, reduction = \"STD_PCA\", umap.method = \"umap-learn\", reduction.name = \"STD_UMAP\", dims = 1:20, verbose = FALSE)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO par√¢metro umap.method = \"umap-learn\" especifica que o Seurat deve usar a implementa√ß√£o original do UMAP em Python, fornecida pelo pacote umap-learn.\nEssa vers√£o tende a produzir proje√ß√µes mais est√°veis e refinadas do que a implementa√ß√£o padr√£o em R, especialmente em datasets grandes ou com estrutura complexa. Para funcionar, √© necess√°rio ter o Python instalado com o pacote umap-learn dispon√≠vel via reticulate.\n\n\n\n\nDimPlot(seurat_object, reduction = \"STD_UMAP\")\n\n\n\n\n\n\n\nFigure¬†7"
  },
  {
    "objectID": "material/semana2/03_quality_control.html#filtrando-c√©lulas-de-baixa-qualidade",
    "href": "material/semana2/03_quality_control.html#filtrando-c√©lulas-de-baixa-qualidade",
    "title": "03 - Controle de qualidade",
    "section": "Filtrando c√©lulas de baixa qualidade",
    "text": "Filtrando c√©lulas de baixa qualidade\n\n# Criando copia do objeto pre-filtragem\npre_seurat_object &lt;- seurat_object\n\n# Filtro com thresholds definidos manualmente\nseurat_object &lt;- subset(\n  seurat_object,\n  subset = nFeature_RNA &gt; 200 &\n           nFeature_RNA &lt; 6000 &\n           percent.mt &lt; 10 &\n           scDblFinder.class == \"singlet\"\n)\n\n\nSalvando estat√≠stica p√≥s-filtragem\n\n# Estat√≠sticas ap√≥s o QC\npost_qc_stats &lt;- data.frame(\n  number_of_cells = ncol(seurat_object),\n  mean_counts_per_cell = mean(seurat_object$nCount_RNA),\n  median_counts_per_cell = median(seurat_object$nCount_RNA),\n  mean_features_per_cell = mean(seurat_object$nFeature_RNA),\n  median_features_per_cell = median(seurat_object$nFeature_RNA)\n)\n\n\n\nCombinando as estat√≠sticas pr√© e p√≥s-filtragem\n\n# Unindo as tabelas\nqc_summary &lt;- rbind(\n  cbind(Etapa = \"Antes do QC\", pre_qc_stats),\n  cbind(Etapa = \"Depois do QC\", post_qc_stats)\n)"
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html",
    "href": "material/semana2/04_dimensionality_and_clustering.html",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "",
    "text": "Em experimentos de transcript√¥mica de c√©lula √∫nica (scRNA-seq), a alta dimensionalidade dos dados ‚Äî frequentemente composta por milhares de genes ‚Äî dificulta a an√°lise direta e a interpreta√ß√£o biol√≥gica. Para identificar popula√ß√µes celulares de forma robusta, √© necess√°rio reduzir essa dimensionalidade preservando as principais varia√ß√µes biol√≥gicas. Posteriormente, t√©cnicas de clusteriza√ß√£o s√£o empregadas para agrupar c√©lulas com perfis transcript√¥micos semelhantes, revelando estruturas ocultas nos dados, como tipos celulares ou estados funcionais distintos.\nEste tutorial descreve as etapas fundamentais de uni√£o de amostras, redu√ß√£o de dimensionalidade, clusteriza√ß√£o e subclusteriza√ß√£o de c√©lulas, utilizando o pacote Seurat."
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#motiva√ß√£o",
    "href": "material/semana2/04_dimensionality_and_clustering.html#motiva√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "",
    "text": "Em experimentos de transcript√¥mica de c√©lula √∫nica (scRNA-seq), a alta dimensionalidade dos dados ‚Äî frequentemente composta por milhares de genes ‚Äî dificulta a an√°lise direta e a interpreta√ß√£o biol√≥gica. Para identificar popula√ß√µes celulares de forma robusta, √© necess√°rio reduzir essa dimensionalidade preservando as principais varia√ß√µes biol√≥gicas. Posteriormente, t√©cnicas de clusteriza√ß√£o s√£o empregadas para agrupar c√©lulas com perfis transcript√¥micos semelhantes, revelando estruturas ocultas nos dados, como tipos celulares ou estados funcionais distintos.\nEste tutorial descreve as etapas fundamentais de uni√£o de amostras, redu√ß√£o de dimensionalidade, clusteriza√ß√£o e subclusteriza√ß√£o de c√©lulas, utilizando o pacote Seurat."
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#contextualiza√ß√£o",
    "href": "material/semana2/04_dimensionality_and_clustering.html#contextualiza√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Contextualiza√ß√£o",
    "text": "Contextualiza√ß√£o\nNeste tutorial, trabalharemos com objetos do Seurat e utilizaremos as seguintes fun√ß√µes principais:\n\nmerge() ‚Äî para unir objetos de diferentes amostras.\nSCTransform() ou NormalizeData() ‚Äî para normaliza√ß√£o e modelagem da varia√ß√£o t√©cnica.\nRunPCA() ‚Äî para a redu√ß√£o inicial de dimensionalidade via An√°lise de Componentes Principais (PCA).\nFindNeighbors() e FindClusters() ‚Äî para identificar agrupamentos celulares.\nRunUMAP() ou RunTSNE() ‚Äî para proje√ß√£o em duas dimens√µes, facilitando a visualiza√ß√£o.\nSubset() ‚Äî para subclusterizar grupos de interesse.\n\n\nlibrary(Seurat)\nlibrary(ROGUE)\nlibrary(presto)\nlibrary(dplyr)\nlibrary(here)\nlibrary(ggplot2)\n\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)\n\n# Aumentar o limite de uso de memoria\noptions(future.globals.maxSize = 5 * 1024^3) # 5 GB, por exemplo"
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#unindo-amostras",
    "href": "material/semana2/04_dimensionality_and_clustering.html#unindo-amostras",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Unindo amostras",
    "text": "Unindo amostras\nAntes de qualquer redu√ß√£o de dimensionalidade, √© necess√°rio unir diferentes amostras em um √∫nico objeto Seurat. Para isso, usamos a fun√ß√£o merge(). Abaixo um exemplo de codigo de realizar a juncao.\n\n# Listar os arquivos RDS\nfiles &lt;- list.files(\n  path = \"path/to/your/objects\", pattern = \"\\\\.rds$\", full.names = TRUE)\n\n# Carregar todos os objetos em uma lista\nseurat_list &lt;- lapply(files, readRDS)\n\n# Criar identificadores a partir dos nomes dos arquivos\nsample_ids &lt;- gsub(\"\\\\.rds$\", \"\", basename(files))\n\n# Fazer o merge\nseurat_merged &lt;- merge(\n  x = seurat_list[[1]],\n  y = seurat_list[-1],\n  add.cell.ids = sample_ids,\n  project = \"ProjectName\"\n)\n\n\nSalvando o objeto do Seurat\n\nif(!file.exists(\"./data/seurat_object.RDS\")) {\n  \n  saveRDS(file = \"./data/seurat_object.RDS\", object = seurat_merged)\n  \n}\n\n\n# Objeto contendo todas as amostras\nseurat_object &lt;- readRDS(file = here::here(\"./data/seurat_object.RDS\"))"
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#normaliza√ß√£o",
    "href": "material/semana2/04_dimensionality_and_clustering.html#normaliza√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Normaliza√ß√£o",
    "text": "Normaliza√ß√£o\n\nseurat_object &lt;- NormalizeData(\n  seurat_object, normalization.method = \"LogNormalize\", scale.factor = 10000)\n\nNormalizing layer: counts\n\nseurat_object &lt;- FindVariableFeatures(\n  seurat_object, selection.method = \"vst\", nfeatures = 2000)\n\nFinding variable features for layer counts\n\nseurat_object &lt;- ScaleData(\n  seurat_object, features = VariableFeatures(seurat_object))\n\nCentering and scaling data matrix\n\n\nWarning: Different features in new layer data than already exists for\nscale.data"
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#redu√ß√£o-de-dimensionalidade-pca",
    "href": "material/semana2/04_dimensionality_and_clustering.html#redu√ß√£o-de-dimensionalidade-pca",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Redu√ß√£o de dimensionalidade (PCA)",
    "text": "Redu√ß√£o de dimensionalidade (PCA)\n\nseurat_object &lt;- RunPCA(seurat_object, npcs = 50, verbose = FALSE)\n\nElbowPlot(seurat_object, reduction = \"pca\")\n\n\n\n\n\n\n\n\n\nFigure¬†1\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO ElbowPlot(seurat_object) √© utilizado para identificar o n√∫mero apropriado de componentes principais (PCs) a serem considerados nas an√°lises downstream, como clusteriza√ß√£o e redu√ß√£o de dimensionalidade. O gr√°fico exibe a varia√ß√£o explicada por cada PC; o ponto onde h√° uma inflex√£o (‚Äúcotovelo‚Äù) indica que PCs adicionais contribuem pouco para a variabilidade dos dados. Selecionar o n√∫mero correto de PCs √© essencial para capturar a estrutura biol√≥gica relevante, minimizando ru√≠do t√©cnico.\n\n\n\n\nVisualizando dimens√µes\n\n# Examine and visualize PCA results a few different ways\nVizDimLoadings(seurat_object, dims = 1:2, reduction = \"pca\")\n\n\n\n\n\n\n\nFigure¬†2\n\n\n\n\n\n\n\nExtraindo informac√µes do PCA\n\n# Get cell embeddings and feature loadings stored on pbmc[['pca']]@cell.embeddings\nEmbeddings(seurat_object, reduction = \"pca\")\n\n# stored in pbmc[['pca]]@feature.loadings\nLoadings(seurat_object, reduction = \"pca\")"
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#constru√ß√£o-da-matriz-de-vizinhan√ßa",
    "href": "material/semana2/04_dimensionality_and_clustering.html#constru√ß√£o-da-matriz-de-vizinhan√ßa",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Constru√ß√£o da matriz de vizinhan√ßa",
    "text": "Constru√ß√£o da matriz de vizinhan√ßa\n\nseurat_object &lt;- FindNeighbors(seurat_object, dims = 1:20)\n\nComputing nearest neighbor graph\n\n\nComputing SNN\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o FindNeighbors constr√≥i uma matriz de vizinhan√ßa baseada nos embeddings de redu√ß√£o de dimensionalidade (tipicamente PCA). Cada c√©lula √© conectada √†s suas c√©lulas mais pr√≥ximas no espa√ßo de baixa dimens√£o, formando um grafo de similaridade.\nEsse grafo √© o alicerce para a clusteriza√ß√£o subsequente (FindClusters()), permitindo identificar comunidades de c√©lulas com perfis transcript√¥micos semelhantes. O par√¢metro dims especifica quais componentes principais ser√£o usados para calcular as dist√¢ncias entre as c√©lulas."
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#clusteriza√ß√£o",
    "href": "material/semana2/04_dimensionality_and_clustering.html#clusteriza√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Clusteriza√ß√£o",
    "text": "Clusteriza√ß√£o\n\nseurat_object &lt;- FindClusters(\n  seurat_object, algorithm = 4, resolution = c(0.25, 0.5, 1.0))\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o FindClusters realiza a clusteriza√ß√£o das c√©lulas com base na matriz de vizinhan√ßa previamente calculada.\nEla aplica algoritmos de otimiza√ß√£o de comunidades (como o algoritmo Louvain ou Leiden) para agrupar c√©lulas com perfis transcript√¥micos semelhantes.\nO par√¢metro resolution controla a granularidade da clusteriza√ß√£o, por exemplo: - Valores mais baixos (&lt; 0.5) resultam em menos clusters (agrupamentos maiores). - Valores mais altos (&gt; 0.5) resultam em mais clusters (agrupamentos menores e mais espec√≠ficos).\nA escolha do resolution deve ser guiada tanto por crit√©rios biol√≥gicos quanto por inspe√ß√£o visual dos agrupamentos gerados.\n\n\n\n\n# Explore as resolutions\nDT::datatable(seurat_object@meta.data)\n\nWarning in instance$preRenderHook(instance): It seems your data is too big for\nclient-side DataTables. You may consider server-side processing:\nhttps://rstudio.github.io/DT/server.html"
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#proje√ß√£o-com-umap",
    "href": "material/semana2/04_dimensionality_and_clustering.html#proje√ß√£o-com-umap",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Proje√ß√£o com UMAP",
    "text": "Proje√ß√£o com UMAP\n\nseurat_object &lt;- RunUMAP(seurat_object, dims = 1:20)\n\nWarning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric\nTo use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'\nThis message will be shown once per session\n\n\n15:58:06 UMAP embedding parameters a = 0.9922 b = 1.112\n\n\n15:58:06 Read 67633 rows and found 20 numeric columns\n\n\n15:58:06 Using Annoy for neighbor search, n_neighbors = 30\n\n\n15:58:06 Building Annoy index with metric = cosine, n_trees = 50\n\n\n0%   10   20   30   40   50   60   70   80   90   100%\n\n\n[----|----|----|----|----|----|----|----|----|----|\n\n\n**************************************************|\n15:58:12 Writing NN index file to temp file /tmp/RtmpyLSvkj/file13ae276635317\n15:58:12 Searching Annoy index using 1 thread, search_k = 3000\n15:58:35 Annoy recall = 100%\n15:58:36 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30\n15:58:37 Initializing from normalized Laplacian + noise (using RSpectra)\n15:58:54 Commencing optimization for 200 epochs, with 3039738 positive edges\n15:59:23 Optimization finished\n\n\n# Por padrao\nDimPlot(seurat_object, reduction = \"umap\", label = TRUE)\n\n\n\n\n\n\n\n\n\nFigure¬†3\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nImportante: A clusteriza√ß√£o de scRNA-seq n√£o √© um processo exato. Ela deve ser encarada como uma ferramenta de gera√ß√£o de hip√≥teses. Sempre valide biologicamente seus agrupamentos antes de tirar conclus√µes definitivas."
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#express√£o-diferencial",
    "href": "material/semana2/04_dimensionality_and_clustering.html#express√£o-diferencial",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Express√£o diferencial",
    "text": "Express√£o diferencial\n\ncluster_markers &lt;- FindAllMarkers(seurat_object)\n\nCalculating cluster 1\n\n\nCalculating cluster 2\n\n\nCalculating cluster 3\n\n\nCalculating cluster 4\n\n\nCalculating cluster 5\n\n\nCalculating cluster 6\n\n\nCalculating cluster 7\n\n\nCalculating cluster 8\n\n\nCalculating cluster 9\n\n\nCalculating cluster 10\n\n\nCalculating cluster 11\n\n\nCalculating cluster 12\n\n\nCalculating cluster 13\n\n\nCalculating cluster 14\n\n\nCalculating cluster 15\n\n\nCalculating cluster 16\n\n\nCalculating cluster 17\n\n\nCalculating cluster 18\n\n\nCalculating cluster 19\n\n\nCalculating cluster 20\n\n\nCalculating cluster 21\n\n\nCalculating cluster 22\n\n\nCalculating cluster 23\n\n\nCalculating cluster 24\n\n\nCalculating cluster 25\n\n\nCalculating cluster 26\n\n\nCalculating cluster 27\n\n\n\nInspecionando DEGs\n\nDT::datatable(cluster_markers)\n\nWarning in instance$preRenderHook(instance): It seems your data is too big for\nclient-side DataTables. You may consider server-side processing:\nhttps://rstudio.github.io/DT/server.html\n\n\n\n\n\n\n\n\nSalvando tabela dos DEGs\n\nsaveRDS(cluster_markers, file = \"./data/project_differential.RDS\")"
  },
  {
    "objectID": "material/semana2/04_dimensionality_and_clustering.html#analise-de-pureza-dos-clusters",
    "href": "material/semana2/04_dimensionality_and_clustering.html#analise-de-pureza-dos-clusters",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Analise de pureza dos clusters",
    "text": "Analise de pureza dos clusters\n\ndownsampled_object &lt;- subset(x = seurat_object, downsample = 1000)\ncounts_matrix &lt;- LayerData(\n  downsampled_object, assay = \"RNA\", layer = \"counts\")\n\n\nCalculando entropia\n\nentropy_calculation &lt;- SE_fun(counts_matrix)\n\n\nrogue_value &lt;- CalculateRogue(\n  entropy_calculation, \n  platform = \"UMI\")\n\nrogue_value\n\n[1] 0.2160008\n\n\n\nrogue_result &lt;- rogue(\n  counts_matrix, \n  labels = downsampled_object@meta.data$seurat_clusters, \n  samples = downsampled_object@meta.data$orig.ident, \n  platform = \"UMI\", \n  span = 0.6\n  )\n\nrogue.boxplot(rogue_result)\n\n\n\n\n\n\n\n\n\nFigure¬†4"
  },
  {
    "objectID": "material/semana2/04_clustering.html",
    "href": "material/semana2/04_clustering.html",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "",
    "text": "Em experimentos de transcript√¥mica de c√©lula √∫nica (scRNA-seq), a alta dimensionalidade dos dados ‚Äî frequentemente composta por milhares de genes ‚Äî dificulta a an√°lise direta e a interpreta√ß√£o biol√≥gica. Para identificar popula√ß√µes celulares de forma robusta, √© necess√°rio reduzir essa dimensionalidade preservando as principais varia√ß√µes biol√≥gicas. Posteriormente, t√©cnicas de clusteriza√ß√£o s√£o empregadas para agrupar c√©lulas com perfis transcript√¥micos semelhantes, revelando estruturas ocultas nos dados, como tipos celulares ou estados funcionais distintos.\nEste tutorial descreve as etapas fundamentais de uni√£o de amostras, redu√ß√£o de dimensionalidade, clusteriza√ß√£o e subclusteriza√ß√£o de c√©lulas, utilizando o pacote Seurat."
  },
  {
    "objectID": "material/semana2/04_clustering.html#motiva√ß√£o",
    "href": "material/semana2/04_clustering.html#motiva√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "",
    "text": "Em experimentos de transcript√¥mica de c√©lula √∫nica (scRNA-seq), a alta dimensionalidade dos dados ‚Äî frequentemente composta por milhares de genes ‚Äî dificulta a an√°lise direta e a interpreta√ß√£o biol√≥gica. Para identificar popula√ß√µes celulares de forma robusta, √© necess√°rio reduzir essa dimensionalidade preservando as principais varia√ß√µes biol√≥gicas. Posteriormente, t√©cnicas de clusteriza√ß√£o s√£o empregadas para agrupar c√©lulas com perfis transcript√¥micos semelhantes, revelando estruturas ocultas nos dados, como tipos celulares ou estados funcionais distintos.\nEste tutorial descreve as etapas fundamentais de uni√£o de amostras, redu√ß√£o de dimensionalidade, clusteriza√ß√£o e subclusteriza√ß√£o de c√©lulas, utilizando o pacote Seurat."
  },
  {
    "objectID": "material/semana2/04_clustering.html#contextualiza√ß√£o",
    "href": "material/semana2/04_clustering.html#contextualiza√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Contextualiza√ß√£o",
    "text": "Contextualiza√ß√£o\nNeste tutorial, trabalharemos com objetos do Seurat e utilizaremos as seguintes fun√ß√µes principais:\n\nmerge() ‚Äî para unir objetos de diferentes amostras.\nSCTransform() ou NormalizeData() ‚Äî para normaliza√ß√£o e modelagem da varia√ß√£o t√©cnica.\nRunPCA() ‚Äî para a redu√ß√£o inicial de dimensionalidade via An√°lise de Componentes Principais (PCA).\nFindNeighbors() e FindClusters() ‚Äî para identificar agrupamentos celulares.\nRunUMAP() ou RunTSNE() ‚Äî para proje√ß√£o em duas dimens√µes, facilitando a visualiza√ß√£o.\nSubset() ‚Äî para subclusterizar grupos de interesse.\n\n\nlibrary(Seurat)\nlibrary(ROGUE)\nlibrary(presto)\nlibrary(dplyr)\nlibrary(here)\nlibrary(ggplot2)\n\n# Definindo diretorio padrao\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)\n\n# Aumentar o limite de uso de memoria\noptions(future.globals.maxSize = 5 * 1024^3) # 5 GB, por exemplo"
  },
  {
    "objectID": "material/semana2/04_clustering.html#unindo-amostras",
    "href": "material/semana2/04_clustering.html#unindo-amostras",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Unindo amostras",
    "text": "Unindo amostras\nAntes de qualquer redu√ß√£o de dimensionalidade, √© necess√°rio unir diferentes amostras em um √∫nico objeto Seurat. Para isso, usamos a fun√ß√£o merge(). Abaixo um exemplo de codigo de realizar a juncao.\n\n# Listar os arquivos RDS\nfiles &lt;- list.files(\n  path = \"path/to/your/objects\", pattern = \"\\\\.rds$\", full.names = TRUE)\n\n# Carregar todos os objetos em uma lista\nseurat_list &lt;- lapply(files, readRDS)\n\n# Criar identificadores a partir dos nomes dos arquivos\nsample_ids &lt;- gsub(\"\\\\.rds$\", \"\", basename(files))\n\n# Fazer o merge\nseurat_merged &lt;- merge(\n  x = seurat_list[[1]],\n  y = seurat_list[-1],\n  add.cell.ids = sample_ids,\n  project = \"ProjectName\"\n)\n\n\nSalvando o objeto do Seurat\n\nif(!file.exists(\"./data/seurat_object.RDS\")) {\n  \n  saveRDS(file = \"./data/seurat_object.RDS\", object = seurat_merged)\n  \n}\n\n\n# Objeto contendo todas as amostras\nseurat_object &lt;- readRDS(file = here::here(\"./data/seurat_object.RDS\"))"
  },
  {
    "objectID": "material/semana2/04_clustering.html#normaliza√ß√£o",
    "href": "material/semana2/04_clustering.html#normaliza√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Normaliza√ß√£o",
    "text": "Normaliza√ß√£o\n\nseurat_object &lt;- NormalizeData(\n  seurat_object, normalization.method = \"LogNormalize\", scale.factor = 10000)\n\nNormalizing layer: counts\n\nseurat_object &lt;- FindVariableFeatures(\n  seurat_object, selection.method = \"vst\", nfeatures = 2000)\n\nFinding variable features for layer counts\n\nseurat_object &lt;- ScaleData(\n  seurat_object, features = VariableFeatures(seurat_object))\n\nCentering and scaling data matrix\n\n\nWarning: Different features in new layer data than already exists for\nscale.data"
  },
  {
    "objectID": "material/semana2/04_clustering.html#redu√ß√£o-de-dimensionalidade-pca",
    "href": "material/semana2/04_clustering.html#redu√ß√£o-de-dimensionalidade-pca",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Redu√ß√£o de dimensionalidade (PCA)",
    "text": "Redu√ß√£o de dimensionalidade (PCA)\n\nseurat_object &lt;- RunPCA(seurat_object, npcs = 50, verbose = FALSE)\n\nElbowPlot(seurat_object, reduction = \"pca\")\n\n\n\n\n\n\n\n\n\nFigure¬†1\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO ElbowPlot(seurat_object) √© utilizado para identificar o n√∫mero apropriado de componentes principais (PCs) a serem considerados nas an√°lises downstream, como clusteriza√ß√£o e redu√ß√£o de dimensionalidade. O gr√°fico exibe a varia√ß√£o explicada por cada PC; o ponto onde h√° uma inflex√£o (‚Äúcotovelo‚Äù) indica que PCs adicionais contribuem pouco para a variabilidade dos dados. Selecionar o n√∫mero correto de PCs √© essencial para capturar a estrutura biol√≥gica relevante, minimizando ru√≠do t√©cnico.\n\n\n\n\nVisualizando dimens√µes\n\n# Examine and visualize PCA results a few different ways\nVizDimLoadings(seurat_object, dims = 1:2, reduction = \"pca\")\n\n\n\n\n\n\n\nFigure¬†2\n\n\n\n\n\n\n\nExtraindo informac√µes do PCA\n\n# Get cell embeddings and feature loadings stored on pbmc[['pca']]@cell.embeddings\nEmbeddings(seurat_object, reduction = \"pca\")\n\n# stored in pbmc[['pca]]@feature.loadings\nLoadings(seurat_object, reduction = \"pca\")"
  },
  {
    "objectID": "material/semana2/04_clustering.html#constru√ß√£o-da-matriz-de-vizinhan√ßa",
    "href": "material/semana2/04_clustering.html#constru√ß√£o-da-matriz-de-vizinhan√ßa",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Constru√ß√£o da matriz de vizinhan√ßa",
    "text": "Constru√ß√£o da matriz de vizinhan√ßa\n\nseurat_object &lt;- FindNeighbors(seurat_object, dims = 1:20)\n\nComputing nearest neighbor graph\n\n\nComputing SNN\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o FindNeighbors constr√≥i uma matriz de vizinhan√ßa baseada nos embeddings de redu√ß√£o de dimensionalidade (tipicamente PCA). Cada c√©lula √© conectada √†s suas c√©lulas mais pr√≥ximas no espa√ßo de baixa dimens√£o, formando um grafo de similaridade.\nEsse grafo √© o alicerce para a clusteriza√ß√£o subsequente (FindClusters()), permitindo identificar comunidades de c√©lulas com perfis transcript√¥micos semelhantes. O par√¢metro dims especifica quais componentes principais ser√£o usados para calcular as dist√¢ncias entre as c√©lulas."
  },
  {
    "objectID": "material/semana2/04_clustering.html#clusteriza√ß√£o",
    "href": "material/semana2/04_clustering.html#clusteriza√ß√£o",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Clusteriza√ß√£o",
    "text": "Clusteriza√ß√£o\n\nseurat_object &lt;- FindClusters(\n  seurat_object, algorithm = 4, resolution = c(0.25, 0.5, 1.0))\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o FindClusters realiza a clusteriza√ß√£o das c√©lulas com base na matriz de vizinhan√ßa previamente calculada.\nEla aplica algoritmos de otimiza√ß√£o de comunidades (como o algoritmo Louvain ou Leiden) para agrupar c√©lulas com perfis transcript√¥micos semelhantes.\nO par√¢metro resolution controla a granularidade da clusteriza√ß√£o, por exemplo: - Valores mais baixos (&lt; 0.5) resultam em menos clusters (agrupamentos maiores). - Valores mais altos (&gt; 0.5) resultam em mais clusters (agrupamentos menores e mais espec√≠ficos).\nA escolha do resolution deve ser guiada tanto por crit√©rios biol√≥gicos quanto por inspe√ß√£o visual dos agrupamentos gerados.\n\n\n\n\n# Explore as resolutions\nDT::datatable(head(seurat_object@meta.data, n = 100))"
  },
  {
    "objectID": "material/semana2/04_clustering.html#proje√ß√£o-com-umap",
    "href": "material/semana2/04_clustering.html#proje√ß√£o-com-umap",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Proje√ß√£o com UMAP",
    "text": "Proje√ß√£o com UMAP\n\nseurat_object &lt;- RunUMAP(seurat_object, dims = 1:20)\n\nWarning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric\nTo use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'\nThis message will be shown once per session\n\n\n10:22:10 UMAP embedding parameters a = 0.9922 b = 1.112\n\n\n10:22:10 Read 67633 rows and found 20 numeric columns\n\n\n10:22:10 Using Annoy for neighbor search, n_neighbors = 30\n\n\n10:22:10 Building Annoy index with metric = cosine, n_trees = 50\n\n\n0%   10   20   30   40   50   60   70   80   90   100%\n\n\n[----|----|----|----|----|----|----|----|----|----|\n\n\n**************************************************|\n10:22:16 Writing NN index file to temp file /tmp/Rtmp4AJWOy/file117418fdd87b\n10:22:16 Searching Annoy index using 1 thread, search_k = 3000\n10:22:40 Annoy recall = 100%\n10:22:40 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 30\n10:22:42 Initializing from normalized Laplacian + noise (using RSpectra)\n10:23:00 Commencing optimization for 200 epochs, with 3039738 positive edges\n10:23:29 Optimization finished\n\n\n# Por padrao apenas os clusters da ultima resolucao sao apresentados\nDimPlot(seurat_object, reduction = \"umap\", label = TRUE)\n\n\n\n\n\n\n\n\n\nFigure¬†3\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nImportante: A clusteriza√ß√£o de scRNA-seq n√£o √© um processo exato. Ela deve ser encarada como uma ferramenta de gera√ß√£o de hip√≥teses. Sempre valide biologicamente seus agrupamentos antes de tirar conclus√µes definitivas."
  },
  {
    "objectID": "material/semana2/04_clustering.html#express√£o-diferencial",
    "href": "material/semana2/04_clustering.html#express√£o-diferencial",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Express√£o diferencial",
    "text": "Express√£o diferencial\n\n# O parametro `max.cells.per.ident` foi acrescentado para otimizar o tempo computacional. Remove-o para analises reais.\ncluster_markers &lt;- FindAllMarkers(seurat_object, max.cells.per.ident = 1000)\n\n\nInspecionando DEGs\n\n# Removendo resultados nao significativos\ncluster_markers_top &lt;- cluster_markers %&gt;%\n  filter(p_val_adj &lt;= 0.01) %&gt;%\n  group_by(cluster) %&gt;%\n  top_n(20, avg_log2FC)\n\nDT::datatable(cluster_markers_top)"
  },
  {
    "objectID": "material/semana2/04_clustering.html#analise-de-pureza-dos-clusters",
    "href": "material/semana2/04_clustering.html#analise-de-pureza-dos-clusters",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Analise de pureza dos clusters",
    "text": "Analise de pureza dos clusters\n\ndownsampled_object &lt;- subset(x = seurat_object, downsample = 1000)\ncounts_matrix &lt;- LayerData(\n  downsampled_object, assay = \"RNA\", layer = \"counts\")\n\n\nCalculando entropia\n\nentropy_calculation &lt;- SE_fun(counts_matrix)\n\n\nrogue_value &lt;- CalculateRogue(\n  entropy_calculation, \n  platform = \"UMI\")\n\nrogue_value\n\n[1] 0.2160008\n\n\n\nrogue_result &lt;- rogue(\n  counts_matrix, \n  labels = downsampled_object@meta.data$seurat_clusters, \n  samples = downsampled_object@meta.data$orig.ident, \n  platform = \"UMI\", \n  span = 0.6\n  )\n\nrogue.boxplot(rogue_result)\n\n\n\n\n\n\n\n\n\nFigure¬†4"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html",
    "href": "material/semana3/05_cell_annotation.html",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "",
    "text": "A anota√ß√£o de c√©lulas √© uma etapa cr√≠tica na an√°lise de dados de transcript√¥mica de c√©lula √∫nica (scRNA-seq). Ela permite transformar clusters n√£o rotulados em informa√ß√µes biol√≥gicas significativas, descrevendo tipos celulares e seus estados funcionais. A anota√ß√£o adequada √© essencial para interpreta√ß√µes corretas e para garantir reprodutibilidade e comparabilidade entre estudos."
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#motiva√ß√£o",
    "href": "material/semana3/05_cell_annotation.html#motiva√ß√£o",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "",
    "text": "A anota√ß√£o de c√©lulas √© uma etapa cr√≠tica na an√°lise de dados de transcript√¥mica de c√©lula √∫nica (scRNA-seq). Ela permite transformar clusters n√£o rotulados em informa√ß√µes biol√≥gicas significativas, descrevendo tipos celulares e seus estados funcionais. A anota√ß√£o adequada √© essencial para interpreta√ß√µes corretas e para garantir reprodutibilidade e comparabilidade entre estudos."
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#contextualiza√ß√£o",
    "href": "material/semana3/05_cell_annotation.html#contextualiza√ß√£o",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Contextualiza√ß√£o",
    "text": "Contextualiza√ß√£o\nAp√≥s etapas de pr√©-processamento e clusteriza√ß√£o, cada c√©lula ou agrupamento (cluster) carece de uma identidade biol√≥gica. A anota√ß√£o pode ser realizada de maneira:\n\nManual: com base na express√£o de genes marcadores conhecidos.\nAutomatizada: utilizando ferramentas que comparam perfis de express√£o com bancos de dados de refer√™ncia.\n\nNeste tutorial, mostraremos ambas as abordagens usando o pacote Seurat e ferramentas como SingleR para anota√ß√£o autom√°tica."
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#carregar-dados-e-pacotes-necess√°rios",
    "href": "material/semana3/05_cell_annotation.html#carregar-dados-e-pacotes-necess√°rios",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Carregar dados e pacotes necess√°rios",
    "text": "Carregar dados e pacotes necess√°rios\n\n# Instalar pacotes necess√°rios caso n√£o estejam instalados\nif (!requireNamespace(\"SingleR\")) BiocManager::install(\"SingleR\")\nif (!requireNamespace(\"celldex\")) BiocManager::install(\"celldex\")\n\n# Carregar pacotes\nlibrary(Seurat)\nlibrary(presto)\nlibrary(SingleR)\nlibrary(celldex)\nlibrary(SingleCellExperiment)\nlibrary(dplyr)\n\n# Definindo diretorio padrao\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)\n\n# Aumentar o limite de uso de memoria\noptions(future.globals.maxSize = 5 * 1024^3) # 5 GB, por exemplo"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#carregando-dados-do-projeto",
    "href": "material/semana3/05_cell_annotation.html#carregando-dados-do-projeto",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Carregando dados do projeto",
    "text": "Carregando dados do projeto\n# Carregando um objeto Seurat j√° processado (pr√©-clusterizado)\nseurat_object &lt;- readRDS(file = here::here(\"data/seurat_clustered.RDS\"))\n\n# Verificar os clusters\nDimPlot(seurat_object, group.by = \"seurat_clusters\")\n\n\n\n\n\n\n\n\n\nFigure¬†1"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#anota√ß√£o-manual",
    "href": "material/semana3/05_cell_annotation.html#anota√ß√£o-manual",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Anota√ß√£o Manual",
    "text": "Anota√ß√£o Manual\nA anota√ß√£o manual √© uma abordagem fundamental, especialmente em experimentos onde o conhecimento biol√≥gico √© indispens√°vel para interpretar os dados.\nO que √© feito nesta etapa?\nAp√≥s a clusteriza√ß√£o, cada agrupamento de c√©lulas √© apenas um n√∫mero (por exemplo, Cluster 0, Cluster 1, Cluster N‚Ä¶). O objetivo √© atribuir esses agrupamentos identidade biol√≥gica (celular) com base na express√£o de genes marcadores bem conhecidos.\nComo fazemos isso?\n\nUsamos fun√ß√µes como FindAllMarkers para identificar genes mais expressos em cada cluster.\nVerificamos a express√£o desses genes em visualiza√ß√µes como FeaturePlot ou VlnPlot.\nCom base no padr√£o de express√£o, atribu√≠mos r√≥tulos apropriados. Por exemplo:\n\nCD3D+ ‚Üí Provavelmente c√©lulas T\nMS4A1+ ‚Üí Provavelmente c√©lulas B\nLYZ+ ‚Üí Provavelmente mon√≥citos/macr√≥fagos\nPPBP+ ‚Üí Plaquetas\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nImportante: A anota√ß√£o manual exige conhecimento pr√©vio da literatura para garantir a precis√£o das atribui√ß√µes. √â recomend√°vel validar com bancos de dados p√∫blicos e reavaliar periodicamente.\n\n\n\n\n# Vamos fazer uma anotacao mais generica usando a resolucao de 0.25\nIdents(seurat_object) &lt;- \"RNA_snn_res.0.25\"\n\n\nif(!file.exists(here::here(\"data/cluster_markers.RDS\"))) {\n  \n  # Identificar genes marcadores para clusters\n  cluster_markers &lt;- FindAllMarkers(seurat_object, only.pos = TRUE)\n  saveRDS(file = here::here(\"data/cluster_markers.RDS\"), object = cluster_markers)\n  \n} \n\ncluster_markers &lt;- readRDS(file = here::here(\"data/cluster_markers.RDS\"))\n\n\nInspecionando DEGs\n\n# Removendo resultados nao significativos\ncluster_markers_top &lt;- cluster_markers %&gt;%\n    filter(\n      p_val_adj &lt;= 0.05,\n      avg_log2FC &gt;= 0.25,\n      pct.1 &gt;= 0.20,\n      pct.1 &gt; pct.2\n    )\n\ncluster_markers_top &lt;- cluster_markers_top %&gt;%\n  group_by(cluster) %&gt;%\n  top_n(20, avg_log2FC)\n\nDT::datatable(cluster_markers_top)\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nFiltragem adicional: remove genes com pouca relev√¢ncia ou signific√¢ncia estat√≠stica, mantendo apenas aqueles que:\n\nT√™m valor ajustado de p significativo (p_val_adj &lt;= 0.05);\nApresentam diferen√ßa de express√£o relevante (avg_log2FC &gt;= 0.25);\nS√£o detectados em pelo menos 20% das c√©lulas do cluster (pct.1 &gt;= 0.20);\nS√£o mais expressos no cluster alvo do que nos demais (pct.1 &gt; pct.2).\n\nSele√ß√£o dos principais marcadores: para cada cluster, ret√©m apenas os 20 genes com maior log2FC m√©dio, facilitando a visualiza√ß√£o e a escolha de genes para anota√ß√£o.\n\nEste conjunto de marcadores √© particularmente √∫til para guiar a anota√ß√£o manual, pois foca nos genes mais distintivos de cada popula√ß√£o celular.\n\n\n\n\n\nVisualizando marcadores no UMAP\n# Plotar express√£o de genes marcadores conhecidos para atribui√ß√£o manual\nFeaturePlot(\n  seurat_object, \n  features = c(\"CD3D\", \"MS4A1\", \"LYZ\", \"PPBP\", \"CD8A\")\n  )\n\n\n\n\n\n\n\n\n\nFigure¬†2\n\n\n\n\n\n\n\n\nVisualizando atraves do Bubbleplot\n# Definir genes marcadores para visualiza√ß√£o (exemplo)\ngenes_to_inspect &lt;- c(\"CD3D\", \"MS4A1\", \"LYZ\", \"PPBP\", \"CD8A\")\n\n# Gerar o Bubbleplot (DotPlot no Seurat)\nDotPlot(seurat_object, features = genes_to_inspect)\n\n\n\n\n\n\n\n\n\nFigure¬†3\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO Bubbleplot (DotPlot) resume a express√£o g√™nica em cada cluster:\n\nTamanho do ponto ‚Üí indica a fra√ß√£o de c√©lulas do cluster que expressam o gene (quanto maior, mais c√©lulas expressam).\nCor do ponto ‚Üí representa a express√£o m√©dia do gene entre as c√©lulas expressoras (mais escuro = maior express√£o).\n\nIsso permite identificar rapidamente quais genes s√£o marcadores de quais clusters e orientar a anota√ß√£o manual.\n\n\n\n\n\nAvalia√ß√£o manual dos marcadores\n\n\n\n\n\n\n\n\nCluster\nCell Type\nGene Markers\n\n\n\n\n1\nCD8+ Cytotoxic T cells\nCD8A, CD8B, GZMK, GZMH, PRF1, IFNG, XCL1, NKG7\n\n\n2\nCD4+ T cells / TCM-like\nIL7R, TCF7, CAMK4, PDE3B, AOAH\n\n\n3\nRegulatory T cells (Tregs)\nFOXP3, CTLA4, IL2RA, TNFRSF18 (GITR), LAYN\n\n\n4\nB cells\nMS4A1 (CD20), BANK1, CD19, CD22, IGHV5-78\n\n\n5\nMonocytes (Inflammatory)\nLYZ, FCN1, AIF1, IL1B, S100A12, SERPINA1\n\n\n6\nTumor-Associated Cells (Cancer cells, PRAME+)\nPRAME, CHGA, MAGEA4, IRS4, SORCS3\n\n\n7\nPlasma Cells\nIGHG1, IGHG4, IGHG3, IGLL5, IGKV/IGLV genes\n\n\n8\nKeratinocytes / Tumor-associated Epithelium\nDSG3, KRT6A, KRT16, LY6D, SLPI, CLDN4\n\n\n9\nFibroblasts (CAF-like)\nCOL1A1, COL3A1, LUM, DCN, PDGFRB, SFRP2\n\n\n10\nProliferating Cells (likely cycling tumor cells)\nMKI67, UBE2C, RRM2, CCNA2, BIRC5\n\n\n11\nPlasmacytoid Dendritic Cells / pDC-like\nCLEC4C, LILRA4, GLT1D1, P2RY6\n\n\n12\nEndothelial Cells\nCLDN5, ACKR1, PLVAP, RAMP2, EMCN, CDH5\n\n\n13\nMast Cells\nTPSAB1, TPSB2, CPA3, HDC, MS4A2 (FCER1)\n\n\n14\nMelanoma Cells (Tumor Melanocytic Cells)\nPMEL, TYRP1, MLANA, TYR, SOX10, TRPM1\n\n\n\n\n\nRenomeando clusters\n\n# Definir a lista de renomea√ß√£o\ncluster_annotations &lt;- list(\n  \"1\" = \"CD8+ Cytotoxic T cells\",\n  \"2\" = \"CD4+ T cells / TCM-like\",\n  \"3\" = \"Tregs\",\n  \"4\" = \"B cells\",\n  \"5\" = \"Monocytes\",\n  \"6\" = \"PRAME+ Tumor\",\n  \"7\" = \"Plasma Cells\",\n  \"8\" = \"Keratinocytes/Epithelial\", # Maybe tumor\n  \"9\" = \"Fibroblasts\",\n  \"10\" = \"Proliferating Tumor Cells\",\n  \"11\" = \"Plasmacytoid Dendritic Cells\",\n  \"12\" = \"Endothelial Cells\",\n  \"13\" = \"Mast Cells\",\n  \"14\" = \"Melanoma Cells\"\n)\n\n# Renomear os clusters\ncluster_ids &lt;- as.character(Idents(seurat_object))\n\n# Criando coluna com anotacao manual\nseurat_object$manual_annotation &lt;- as.vector(\n  unlist(cluster_annotations[cluster_ids]))\n\n\n# Visualizar para conferir\ntable(seurat_object$manual_annotation)\n\n# Visualizar anotacao\nDimPlot(seurat_object, group.by = \"manual_annotation\", label = FALSE, pt.size = 0.5)\n\n\n\n\n\n\n\n\n\nFigure¬†4"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#anota√ß√£o-autom√°tica-com-singler",
    "href": "material/semana3/05_cell_annotation.html#anota√ß√£o-autom√°tica-com-singler",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Anota√ß√£o Autom√°tica com SingleR",
    "text": "Anota√ß√£o Autom√°tica com SingleR\nEmbora a anota√ß√£o manual seja fundamental para garantir a qualidade e o contexto biol√≥gico da an√°lise, ela pode ser trabalhosa e depender do conhecimento pr√©vio sobre os tipos celulares presentes. Para facilitar e agilizar esse processo, especialmente em conjuntos de dados grandes ou menos caracterizados, √© comum utilizar abordagens autom√°ticas.\nO SingleR √© uma ferramenta projetada para esse fim. Ele anota c√©lulas individualmente ao comparar seus perfis de express√£o com conjuntos de dados de refer√™ncia j√° anotados. A atribui√ß√£o √© baseada na similaridade do transcriptoma de cada c√©lula com os perfis m√©dios das popula√ß√µes do banco de refer√™ncia, o que torna o m√©todo eficiente e relativamente robusto para diversas aplica√ß√µes.\n\n# Converter para SingleCellExperiment\nsce &lt;- as.SingleCellExperiment(seurat_object)\n\n# Carregar uma base de referencia\nref &lt;- celldex::HumanPrimaryCellAtlasData()\n\n# Rodar SingleR\npred &lt;- SingleR(\n  test = sce, ref = ref, labels = ref$label.main)\n\n# Adicionar anota√ß√£o ao objeto Seurat\nseurat_object$SingleR &lt;- pred$labels\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nEste trecho realiza a anota√ß√£o autom√°tica das c√©lulas usando o SingleR com uma base de refer√™ncia.\n\nas.SingleCellExperiment(seurat_object): converte o objeto Seurat para o formato SingleCellExperiment, necess√°rio para rodar o SingleR.\ncelldex::HumanPrimaryCellAtlasData(): carrega uma base de refer√™ncia com perfis de express√£o de c√©lulas humanas bem caracterizadas.\nSingleR(test = sce, ref = ref, labels = ref$label.main): compara cada c√©lula do dataset com as refer√™ncias e atribui o tipo celular mais prov√°vel.\nseurat_object$SingleR &lt;- pred$labels: adiciona a anota√ß√£o autom√°tica como metadado no objeto Seurat para facilitar a visualiza√ß√£o e an√°lise.\n\n\n\n\n# Visualizar anotacao automatica\nDimPlot(seurat_object, \n        group.by = \"SingleR\", label = FALSE, pt.size = 0.5)\n\n\n\n\n\n\n\n\n\nFigure¬†5"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#comparando-e-refinando-anota√ß√µes",
    "href": "material/semana3/05_cell_annotation.html#comparando-e-refinando-anota√ß√µes",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Comparando e refinando anota√ß√µes",
    "text": "Comparando e refinando anota√ß√µes\n\nComparando as anota√ß√µes com UMAP\np1 &lt;- DimPlot(seurat_object, group.by = \"manual_annotation\", label = FALSE) + \n  ggplot2::ggtitle(\"Anota√ß√£o manual (clusters)\")\n\np2 &lt;- DimPlot(seurat_object, group.by = \"SingleR\", label = FALSE) + \n  ggplot2::ggtitle(\"Anota√ß√£o autom√°tica (SingleR)\")\n\np1\np2\n\n\n\n\n\n\n\n\n\nFigure¬†6\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†7\n\n\n\n\n\n\n\n# Comparar manual vs autom√°tica\nconfusion_matrix &lt;- table(\n  Manual = seurat_object$manual_annotation, \n  Automatic = seurat_object$SingleR\n  )\n\n# Normalizar por linha (propor√ß√£o dentro de cada anota√ß√£o manual)\nconfusion_prop &lt;- prop.table(confusion_matrix, margin = 1)\n\n# Visualiza√ß√£o da matriz de confus√£o\npheatmap::pheatmap(\n  confusion_prop,\n  fontsize = 6,\n  display_numbers = TRUE,            # mostra as propor√ß√µes\n  number_format = \"%.1f\",            # duas casas decimais\n  cluster_rows = FALSE,\n  cluster_cols = FALSE,\n  color = colorRampPalette(c(\"white\", \"steelblue\"))(100)\n)\n\n\n\n\n\n\n\n\n\nFigure¬†8"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#salvando-o-objeto-anotado",
    "href": "material/semana3/05_cell_annotation.html#salvando-o-objeto-anotado",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Salvando o objeto anotado",
    "text": "Salvando o objeto anotado\n\nsaveRDS(seurat_object, file = \"data/seurat_annotated.RDS\")"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#diagn√≥stico-da-anota√ß√£o-com-singler",
    "href": "material/semana3/05_cell_annotation.html#diagn√≥stico-da-anota√ß√£o-com-singler",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Diagn√≥stico da Anota√ß√£o com SingleR",
    "text": "Diagn√≥stico da Anota√ß√£o com SingleR\nEste gr√°fico mostra os scores de similaridade entre cada c√©lula do conjunto de teste e os tipos celulares da refer√™ncia. Ele ajuda a identificar c√©lulas com atribui√ß√µes amb√≠guas ou m√∫ltiplas similaridades.\n# Gerar heatmap dos scores de atribuicao\nplotScoreHeatmap(pred)\n\n\n\nOutro diagn√≥stico √© baseado nos ‚Äúdeltas‚Äù por c√©lula, ou seja, a diferen√ßa entre a pontua√ß√£o do r√≥tulo atribu√≠do e a mediana em todos os r√≥tulos para cada c√©lula. Deltas baixos indicam que a atribui√ß√£o √© incerta, o que √© especialmente relevante se o r√≥tulo verdadeiro da c√©lula n√£o existir na refer√™ncia. Podemos inspecionar esses deltas entre as c√©lulas para cada r√≥tulo usando a fun√ß√£o plotDeltaDistribution().\n# Gerar distribuicao dos deltas\nplotDeltaDistribution(pred)\n\n\n\nplotMarkerHeatmap(pred, sce, label = \"NK_cell\")"
  },
  {
    "objectID": "material/semana2/04_clustering.html#salvando-o-objeto-anotado",
    "href": "material/semana2/04_clustering.html#salvando-o-objeto-anotado",
    "title": "04 - Redu√ß√£o de dimensionalidade e clusteriza√ß√£o",
    "section": "Salvando o objeto anotado",
    "text": "Salvando o objeto anotado\n\nsaveRDS(seurat_object, file = \"data/seurat_clustered.RDS\")"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html",
    "href": "material/semana3/06_cell_annotation.html",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "",
    "text": "A anota√ß√£o de c√©lulas √© uma etapa cr√≠tica na an√°lise de dados de transcript√¥mica de c√©lula √∫nica (scRNA-seq). Ela permite transformar clusters n√£o rotulados em informa√ß√µes biol√≥gicas significativas, descrevendo tipos celulares e seus estados funcionais. A anota√ß√£o adequada √© essencial para interpreta√ß√µes corretas e para garantir reprodutibilidade e comparabilidade entre estudos."
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#motiva√ß√£o",
    "href": "material/semana3/06_cell_annotation.html#motiva√ß√£o",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "",
    "text": "A anota√ß√£o de c√©lulas √© uma etapa cr√≠tica na an√°lise de dados de transcript√¥mica de c√©lula √∫nica (scRNA-seq). Ela permite transformar clusters n√£o rotulados em informa√ß√µes biol√≥gicas significativas, descrevendo tipos celulares e seus estados funcionais. A anota√ß√£o adequada √© essencial para interpreta√ß√µes corretas e para garantir reprodutibilidade e comparabilidade entre estudos."
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#contextualiza√ß√£o",
    "href": "material/semana3/06_cell_annotation.html#contextualiza√ß√£o",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Contextualiza√ß√£o",
    "text": "Contextualiza√ß√£o\nO Celltypist √© uma ferramenta de aprendizado de m√°quina para anota√ß√£o autom√°tica de c√©lulas em dados de transcript√¥mica de c√©lula √∫nica. Ela possui modelos pr√©-treinados para uma variedade de tecidos e tipos celulares e √© especialmente √∫til para acelerar e padronizar a anota√ß√£o em estudos grandes ou integrados.\n\nWebsite\nDocumenta√ß√£o"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#convertendo-para-anndata",
    "href": "material/semana3/06_cell_annotation.html#convertendo-para-anndata",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Convertendo para AnnData",
    "text": "Convertendo para AnnData\nO c√≥digo abaixo deve ser executado no R. Note que, ao longo deste tutorial, transitaremos entre linguagens de programa√ß√£o.\n\n# Carregar pacotes\nlibrary(Seurat)\nlibrary(sceasy)\n\n# Definindo diretorio padrao\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)\n\n# Aumentar o limite de uso de memoria\noptions(future.globals.maxSize = 5 * 1024^3) # 5 GB, por exemplo\n\n\n# Carregue seu objeto Seurat\nseurat_object &lt;- readRDS(file = here::here(\"data/seurat_clustered.RDS\"))\nseurat_object@assays$RNA5 &lt;- seurat_object@assays$RNA\n\nseurat_object[[\"RNA\"]] &lt;- as(\n  object = seurat_object[[\"RNA5\"]], Class = \"Assay\")\n\n# Converta para AnnData\nsceasy::convertFormat(\n  seurat_object, \n  from = \"seurat\", \n  to = \"anndata\",\n  outFile = here::here(\"data/seurat_clustered.h5ad\")\n  )\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nNeste bloco, o objeto Seurat √© carregado e preparado para convers√£o. A fun√ß√£o sceasy::convertFormat transforma o objeto em formato AnnData (.h5ad), compat√≠vel com an√°lises em Python."
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#preparando-ambiente-python",
    "href": "material/semana3/06_cell_annotation.html#preparando-ambiente-python",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Preparando ambiente Python",
    "text": "Preparando ambiente Python\nAntes de iniciarmos a anota√ß√£o autom√°tica com o Celltypist, √© necess√°rio preparar o ambiente Python com os pacotes apropriados para an√°lise de dados de c√©lula √∫nica. Nesta etapa, carregaremos:\n\nscanpy: biblioteca central para manipula√ß√£o de dados no formato AnnData e realiza√ß√£o de an√°lises comuns em scRNA-seq.\ncelltypist: ferramenta especializada para anota√ß√£o autom√°tica de c√©lulas baseada em modelos pr√©-treinados.\ncelltypist.models: subm√≥dulo utilizado para carregar modelos espec√≠ficos para diferentes tipos celulares.\n\nEsses pacotes garantir√£o que tenhamos todas as funcionalidades necess√°rias para ler o arquivo .h5ad, realizar a anota√ß√£o e explorar os resultados.\n\n# A partir desse ponto o Quarto ira migrar para o kernel do Python\nimport scanpy as sc\nimport celltypist\nfrom celltypist import models"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#carregando-objeto-recem-convertido",
    "href": "material/semana3/06_cell_annotation.html#carregando-objeto-recem-convertido",
    "title": "06 - Anota√ß√£o de c√©lulas",
    "section": "Carregando objeto recem convertido",
    "text": "Carregando objeto recem convertido\n\nadata = sc.read_h5ad(\"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1/data/seurat_clustered.h5ad\")"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#setting-models",
    "href": "material/semana3/06_cell_annotation.html#setting-models",
    "title": "06 - Anota√ß√£o de c√©lulas",
    "section": "Setting models",
    "text": "Setting models\n\n# Instala os modelos disponiveis pelo Celltypist\nmodels.download_models(force_update = True)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o models.download_models permite baixar modelos pr√©-treinados diretamente do reposit√≥rio oficial do Celltypist. Estes modelos cont√™m informa√ß√µes sobre assinaturas de express√£o g√™nica associadas a diferentes tipos celulares. √â importante escolher o modelo apropriado para o seu tecido ou organismo de interesse, pois isso impactar√° a precis√£o da anota√ß√£o.\n\n\n\nA seguir vamos utilizar a fun√ß√£o models.models_description, a qual lista todos os modelos dispon√≠veis no Celltypist, permitindo ao usu√°rio explorar e selecionar o mais adequado para o seu estudo.\n\nmodels.models_description()\n\nüëâ Detailed model information can be found at `https://www.celltypist.org/models`\n\n\n\n\n\n\n\n\n\nmodel\ndescription\n\n\n\n\n0\nImmune_All_Low.pkl\nimmune sub-populations combined from 20 tissue...\n\n\n1\nImmune_All_High.pkl\nimmune populations combined from 20 tissues of...\n\n\n2\nAdult_COVID19_PBMC.pkl\nperipheral blood mononuclear cell types from C...\n\n\n3\nAdult_CynomolgusMacaque_Hippocampus.pkl\ncell types from the hippocampus of adult cynom...\n\n\n4\nAdult_Human_MTG.pkl\ncell types and subtypes (10x-based) from the a...\n\n\n5\nAdult_Human_PancreaticIslet.pkl\ncell types from pancreatic islets of healthy a...\n\n\n6\nAdult_Human_PrefrontalCortex.pkl\ncell types and subtypes from the adult human d...\n\n\n7\nAdult_Human_Skin.pkl\ncell types from human healthy adult skin\n\n\n8\nAdult_Human_Vascular.pkl\nvascular populations combined from multiple ad...\n\n\n9\nAdult_Mouse_Gut.pkl\ncell types in the adult mouse gut combined fro...\n\n\n10\nAdult_Mouse_OlfactoryBulb.pkl\ncell types from the olfactory bulb of adult mice\n\n\n11\nAdult_Pig_Hippocampus.pkl\ncell types from the adult pig hippocampus\n\n\n12\nAdult_RhesusMacaque_Hippocampus.pkl\ncell types from the hippocampus of adult rhesu...\n\n\n13\nAutopsy_COVID19_Lung.pkl\ncell types from the lungs of 16 SARS-CoV-2 inf...\n\n\n14\nCOVID19_HumanChallenge_Blood.pkl\ndetailed blood cell states from 16 individuals...\n\n\n15\nCOVID19_Immune_Landscape.pkl\nimmune subtypes from lung and blood of COVID-1...\n\n\n16\nCells_Adult_Breast.pkl\ncell types from the adult human breast\n\n\n17\nCells_Fetal_Lung.pkl\ncell types from human embryonic and fetal lungs\n\n\n18\nCells_Human_Tonsil.pkl\ntonsillar cell types from humans (3-65 years)\n\n\n19\nCells_Intestinal_Tract.pkl\nintestinal cells from fetal, pediatric (health...\n\n\n20\nCells_Lung_Airway.pkl\ncell populations from scRNA-seq of five locati...\n\n\n21\nDeveloping_Human_Brain.pkl\ncell types from the first-trimester developing...\n\n\n22\nDeveloping_Human_Gonads.pkl\ncell types of human gonadal and adjacent extra...\n\n\n23\nDeveloping_Human_Hippocampus.pkl\ncell types from the developing human hippocampus\n\n\n24\nDeveloping_Human_Organs.pkl\ncell types of five endoderm-derived organs in ...\n\n\n25\nDeveloping_Human_Thymus.pkl\ncell populations in embryonic, fetal, pediatri...\n\n\n26\nDeveloping_Mouse_Brain.pkl\ncell types from the embryonic mouse brain betw...\n\n\n27\nDeveloping_Mouse_Hippocampus.pkl\ncell types from the mouse hippocampus at postn...\n\n\n28\nFetal_Human_AdrenalGlands.pkl\ncell types of human fetal adrenal glands from ...\n\n\n29\nFetal_Human_Pancreas.pkl\npancreatic cell types from human embryos at 9-...\n\n\n30\nFetal_Human_Pituitary.pkl\ncell types of human fetal pituitaries from 7 t...\n\n\n31\nFetal_Human_Retina.pkl\ncell types from human fetal neural retina and ...\n\n\n32\nFetal_Human_Skin.pkl\ncell types from developing human fetal skin\n\n\n33\nHealthy_Adult_Heart.pkl\ncell types from eight anatomical regions of th...\n\n\n34\nHealthy_COVID19_PBMC.pkl\nperipheral blood mononuclear cell types from h...\n\n\n35\nHealthy_Human_Liver.pkl\ncell types from scRNA-seq and snRNA-seq of the...\n\n\n36\nHealthy_Mouse_Liver.pkl\ncell types from scRNA-seq and snRNA-seq of the...\n\n\n37\nHuman_AdultAged_Hippocampus.pkl\ncell types from the hippocampus of adult and a...\n\n\n38\nHuman_Colorectal_Cancer.pkl\ncell types of colon tissues from patients with...\n\n\n39\nHuman_Developmental_Retina.pkl\ncell types from human fetal retina\n\n\n40\nHuman_Embryonic_YolkSac.pkl\ncell types of the human yolk sac from 4-8 post...\n\n\n41\nHuman_Endometrium_Atlas.pkl\nendometrial cell types integrated from seven d...\n\n\n42\nHuman_IPF_Lung.pkl\ncell types from idiopathic pulmonary fibrosis,...\n\n\n43\nHuman_Longitudinal_Hippocampus.pkl\ncell types from the adult human anterior and p...\n\n\n44\nHuman_Lung_Atlas.pkl\nintegrated Human Lung Cell Atlas (HLCA) combin...\n\n\n45\nHuman_PF_Lung.pkl\ncell types from different forms of pulmonary f...\n\n\n46\nHuman_Placenta_Decidua.pkl\ncell types from first-trimester human placenta...\n\n\n47\nLethal_COVID19_Lung.pkl\ncell types from the lungs of individuals who d...\n\n\n48\nMouse_Dentate_Gyrus.pkl\ncell types from the dentate gyrus in perinatal...\n\n\n49\nMouse_Isocortex_Hippocampus.pkl\ncell types from the adult mouse isocortex (neo...\n\n\n50\nMouse_Postnatal_DentateGyrus.pkl\ncell types from the mouse dentate gyrus in pos...\n\n\n51\nMouse_Whole_Brain.pkl\ncell types from the whole adult mouse brain\n\n\n52\nNuclei_Lung_Airway.pkl\ncell populations from snRNA-seq of five locati...\n\n\n53\nPan_Fetal_Human.pkl\nstromal and immune populations from the human ...\n\n\n\n\n\n\n\n\nmodel = models.Model.load(model = 'Immune_All_High.pkl')\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o models.Model.load carrega o modelo pr√©-treinado escolhido (neste caso, ‚ÄúImmune_All_High.pkl‚Äù) para ser utilizado na anota√ß√£o. Este modelo cont√©m as assinaturas de express√£o g√™nica necess√°rias para classificar as c√©lulas em tipos celulares espec√≠ficos com base no seu perfil de express√£o. O modelo Immune_All_High foi treinado com dados de popula√ß√µes imunes combinadas de 20 tecidos de 18 estudos distintos, o que o torna adequado para anota√ß√µes em datasets diversos relacionados ao sistema imune.\nMais informa√ß√µes sobre os modelos dispon√≠veis podem ser encontradas em Celltypist Models.\n\n\n\n\nmodel.cell_types\n\narray(['B cells', 'B-cell lineage', 'Cycling cells', 'DC', 'DC precursor',\n       'Double-negative thymocytes', 'Double-positive thymocytes', 'ETP',\n       'Early MK', 'Endothelial cells', 'Epithelial cells',\n       'Erythrocytes', 'Erythroid', 'Fibroblasts', 'Granulocytes',\n       'HSC/MPP', 'ILC', 'ILC precursor', 'MNP', 'Macrophages',\n       'Mast cells', 'Megakaryocyte precursor',\n       'Megakaryocytes/platelets', 'Mono-mac', 'Monocyte precursor',\n       'Monocytes', 'Myelocytes', 'Plasma cells', 'Promyelocytes',\n       'T cells', 'pDC', 'pDC precursor'], dtype=object)"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#cell-annotation-similarity",
    "href": "material/semana3/06_cell_annotation.html#cell-annotation-similarity",
    "title": "06 - Anota√ß√£o de c√©lulas",
    "section": "Cell annotation similarity",
    "text": "Cell annotation similarity\n\nsc.pl.dendrogram(adata, groupby = \"celltypist_cell_label\")\n\nWARNING: dendrogram data not found (using key=dendrogram_celltypist_cell_label). Running `sc.tl.dendrogram` with default parameters. For fine tuning it is recommended to run `sc.tl.dendrogram` independently.\n\n\n\n\n\n\n\n\nFigure¬†2: Dendrogram\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o sc.pl.dendrogram √© utilizada para visualizar a rela√ß√£o hier√°rquica entre os grupos de c√©lulas anotados. No exemplo acima, o argumento groupby = \"celltypist_cell_label\" especifica que as c√©lulas ser√£o agrupadas com base nas anota√ß√µes feitas pelo Celltypist.Este gr√°fico permite observar como os diferentes tipos celulares anotados se relacionam entre si com base no perfil de express√£o g√™nica global. C√©lulas com assinaturas semelhantes tendem a se agrupar mais pr√≥ximas no dendrograma, enquanto c√©lulas com perfis distintos aparecem mais afastadas.\nDessa forma, esta abordagem √© √∫til para verificar se as anota√ß√µes refletem a biologia esperada, identificando poss√≠veis classifica√ß√µes inconsistentes ou agrupamentos inesperados entre os tipos celulares."
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#violinplot",
    "href": "material/semana3/06_cell_annotation.html#violinplot",
    "title": "06 - Anota√ß√£o de c√©lulas",
    "section": "ViolinPlot",
    "text": "ViolinPlot\n\ntop_genes = dict()\n\nfor cell_type in adata.obs[\"celltypist_cell_label\"].unique():\n    markers = list(model.extract_top_markers(cell_type, 3))\n    for gene in markers:\n        if gene in list(adata.var_names):\n            top_genes.setdefault(cell_type, []).append(gene)\n\n\nall_markers = [item for sublist in top_genes.values() for item in sublist]\n\n\n\nCode\nfor cell, genes in top_genes.items():\n    sc.tl.score_genes(adata, gene_list=genes, score_name=cell)\n\n\n\n# Plot each gene score in a subplot\nfor cell, genes in top_genes.items():\n    if cell in adata.obs.columns:\n        sc.pl.violin(adata, keys=cell, groupby=\"RNA_snn_res.0.25\", rotation=90)\n\n\n\n\n\n\n\n\n\n\n(a) Celltypist Gene Signature\n\n\n\n\n\n\n\n\n\n\n\n(b)\n\n\n\n\n\n\n\n\n\n\n\n(c)\n\n\n\n\n\n\n\n\n\n\n\n(d)\n\n\n\n\n\n\n\n\n\n\n\n(e)\n\n\n\n\n\n\n\n\n\n\n\n(f)\n\n\n\n\n\n\n\n\n\n\n\n(g)\n\n\n\n\n\n\n\n\n\n\n\n(h)\n\n\n\n\n\n\n\n\n\n\n\n(i)\n\n\n\n\n\n\n\n\n\n\n\n(j)\n\n\n\n\n\n\n\n\n\n\n\n(k)\n\n\n\n\n\n\n\n\n\n\n\n(l)\n\n\n\n\n\n\nFigure¬†3"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#differential-expression",
    "href": "material/semana3/06_cell_annotation.html#differential-expression",
    "title": "06 - Anota√ß√£o de c√©lulas",
    "section": "Differential Expression",
    "text": "Differential Expression\n\nsc.tl.rank_genes_groups(\n    adata,\n    groupby = \"celltypist_cell_label\",\n    method = \"wilcoxon\",\n    key_added = \"dea_cell_label\"\n    )\n\n\nsc.pl.rank_genes_groups_dotplot(\n    adata,\n    groupby = \"celltypist_cell_label\",\n    standard_scale = \"var\",\n    n_genes = 5,\n    key = \"dea_cell_label\"\n    )\n\n\n\n\n\n\n\nFigure¬†4: DotPlot\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO comando sc.pl.rank_genes_groups_dotplot gera um gr√°fico do tipo dotplot que visualiza os genes diferencialmente expressos entre os grupos definidos pela anota√ß√£o do Celltypist (groupby = \"celltypist_cell_label\").\nNo eixo y do gr√°fico s√£o mostrados os grupos celulares anotados e no eixo x os genes diferencialmente expressos. Para cada grupo, s√£o exibidos at√© 5 genes mais representativos (n_genes = 5), definidos pela an√°lise armazenada na chave \"dea_cell_label\" do objeto AnnData.\nO argumento standard_scale = \"var\" padroniza os valores de express√£o dos genes, garantindo que eles sejam compar√°veis entre si. Isso √© √∫til para destacar padr√µes relativos de express√£o, independentemente das diferen√ßas absolutas de abund√¢ncia.\nNo dotplot, cada ponto indica: - O tamanho: a fra√ß√£o de c√©lulas do grupo que expressa o gene. - A cor: o n√≠vel m√©dio de express√£o do gene naquele grupo.\nEste tipo de visualiza√ß√£o √© essencial para validar se as anota√ß√µes dos tipos celulares fazem sentido com base nos genes marcadores expressos e para identificar assinaturas g√™nicas caracter√≠sticas ou √∫nicas de cada popula√ß√£o celular."
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#executando-predi√ß√£o",
    "href": "material/semana3/06_cell_annotation.html#executando-predi√ß√£o",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Executando predi√ß√£o",
    "text": "Executando predi√ß√£o\n\npredictions = celltypist.annotate(adata, model = 'Immune_All_High.pkl', majority_voting = True)\n\nüî¨ Input data has 67633 cells and 38606 genes\nüîó Matching reference genes in the model\nüß¨ 5824 features used for prediction\n‚öñÔ∏è Scaling input data\nüñãÔ∏è Predicting labels\n‚úÖ Prediction done!\nüëÄ Can not detect a neighborhood graph, will construct one before the over-clustering\n/usr/local/lib/python3.10/dist-packages/tqdm/auto.py:21: TqdmWarning:\n\nIProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n\n‚õìÔ∏è Over-clustering input data with resolution set to 20\nüó≥Ô∏è Majority voting the predictions\n‚úÖ Majority voting done!\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o celltypist.annotate executa a predi√ß√£o autom√°tica dos tipos celulares com base no modelo carregado. Neste caso, o modelo \"Immune_All_High.pkl\" ser√° utilizado para classificar as c√©lulas do objeto adata.\nO argumento majority_voting=True assegura que as previs√µes sejam refinadas por meio de um m√©todo de vota√ß√£o majorit√°ria, tornando a anota√ß√£o por c√©lula mais robusta e reduzindo poss√≠veis classifica√ß√µes amb√≠guas.\nAp√≥s a anota√ß√£o, o resultado √© armazenado no objeto predictions. Para facilitar a manipula√ß√£o e integra√ß√£o com outras an√°lises, a fun√ß√£o to_adata() √© utilizada para converter essas predi√ß√µes em um objeto AnnData, armazenado na vari√°vel predictions_data.\n\n\n\n\npredictions_data = predictions.to_adata()"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#adicionando-dados-ao-objeto-original",
    "href": "material/semana3/06_cell_annotation.html#adicionando-dados-ao-objeto-original",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Adicionando dados ao objeto original",
    "text": "Adicionando dados ao objeto original\n\nadata.obs[\"celltypist_cell_label\"] = predictions_data.obs.loc[adata.obs.index, \"majority_voting\"]\nadata.obs[\"celltypist_conf_score\"] = predictions_data.obs.loc[adata.obs.index, \"conf_score\"]"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#visualizando-umap",
    "href": "material/semana3/06_cell_annotation.html#visualizando-umap",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Visualizando UMAP",
    "text": "Visualizando UMAP\n\nsc.pl.umap(\n    adata,\n    color = [\"celltypist_cell_label\"],\n    frameon = False,\n    sort_order = False,\n    wspace = 1\n)\n\nsc.pl.umap(\n    adata,\n    color = [\"celltypist_conf_score\"],\n    frameon = False,\n    sort_order = False,\n    wspace = 1\n)\n\n\n\nFigure¬†1: Celltypist High annotation\n\n\n\n\n\n\n\n\n\n(a) Low granularity\n\n\n\n\n\n\n\n\n\n\n\n(b) Prediction score"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#carregando-objeto-rec√©m-convertido",
    "href": "material/semana3/06_cell_annotation.html#carregando-objeto-rec√©m-convertido",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Carregando objeto rec√©m-convertido",
    "text": "Carregando objeto rec√©m-convertido\n\nadata = sc.read_h5ad(\"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1/data/seurat_clustered.h5ad\")"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#baixando-modelos",
    "href": "material/semana3/06_cell_annotation.html#baixando-modelos",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Baixando modelos",
    "text": "Baixando modelos\n\n# Instala os modelos disponiveis pelo Celltypist\nmodels.download_models(force_update = True)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o models.download_models permite baixar modelos pr√©-treinados diretamente do reposit√≥rio oficial do Celltypist. Estes modelos cont√™m informa√ß√µes sobre assinaturas de express√£o g√™nica associadas a diferentes tipos celulares. √â importante escolher o modelo apropriado para o seu tecido ou organismo de interesse, pois isso impactar√° a precis√£o da anota√ß√£o.\n\n\n\nA seguir vamos utilizar a fun√ß√£o models.models_description, a qual lista todos os modelos dispon√≠veis no Celltypist, permitindo ao usu√°rio explorar e selecionar o mais adequado para o seu estudo.\n\nmodels.models_description()\n\nüëâ Detailed model information can be found at `https://www.celltypist.org/models`\n\n\n\n\n\n\n\n\n\nmodel\ndescription\n\n\n\n\n0\nImmune_All_Low.pkl\nimmune sub-populations combined from 20 tissue...\n\n\n1\nImmune_All_High.pkl\nimmune populations combined from 20 tissues of...\n\n\n2\nAdult_COVID19_PBMC.pkl\nperipheral blood mononuclear cell types from C...\n\n\n3\nAdult_CynomolgusMacaque_Hippocampus.pkl\ncell types from the hippocampus of adult cynom...\n\n\n4\nAdult_Human_MTG.pkl\ncell types and subtypes (10x-based) from the a...\n\n\n5\nAdult_Human_PancreaticIslet.pkl\ncell types from pancreatic islets of healthy a...\n\n\n6\nAdult_Human_PrefrontalCortex.pkl\ncell types and subtypes from the adult human d...\n\n\n7\nAdult_Human_Skin.pkl\ncell types from human healthy adult skin\n\n\n8\nAdult_Human_Vascular.pkl\nvascular populations combined from multiple ad...\n\n\n9\nAdult_Mouse_Gut.pkl\ncell types in the adult mouse gut combined fro...\n\n\n10\nAdult_Mouse_OlfactoryBulb.pkl\ncell types from the olfactory bulb of adult mice\n\n\n11\nAdult_Pig_Hippocampus.pkl\ncell types from the adult pig hippocampus\n\n\n12\nAdult_RhesusMacaque_Hippocampus.pkl\ncell types from the hippocampus of adult rhesu...\n\n\n13\nAutopsy_COVID19_Lung.pkl\ncell types from the lungs of 16 SARS-CoV-2 inf...\n\n\n14\nCOVID19_HumanChallenge_Blood.pkl\ndetailed blood cell states from 16 individuals...\n\n\n15\nCOVID19_Immune_Landscape.pkl\nimmune subtypes from lung and blood of COVID-1...\n\n\n16\nCells_Adult_Breast.pkl\ncell types from the adult human breast\n\n\n17\nCells_Fetal_Lung.pkl\ncell types from human embryonic and fetal lungs\n\n\n18\nCells_Human_Tonsil.pkl\ntonsillar cell types from humans (3-65 years)\n\n\n19\nCells_Intestinal_Tract.pkl\nintestinal cells from fetal, pediatric (health...\n\n\n20\nCells_Lung_Airway.pkl\ncell populations from scRNA-seq of five locati...\n\n\n21\nDeveloping_Human_Brain.pkl\ncell types from the first-trimester developing...\n\n\n22\nDeveloping_Human_Gonads.pkl\ncell types of human gonadal and adjacent extra...\n\n\n23\nDeveloping_Human_Hippocampus.pkl\ncell types from the developing human hippocampus\n\n\n24\nDeveloping_Human_Organs.pkl\ncell types of five endoderm-derived organs in ...\n\n\n25\nDeveloping_Human_Thymus.pkl\ncell populations in embryonic, fetal, pediatri...\n\n\n26\nDeveloping_Mouse_Brain.pkl\ncell types from the embryonic mouse brain betw...\n\n\n27\nDeveloping_Mouse_Hippocampus.pkl\ncell types from the mouse hippocampus at postn...\n\n\n28\nFetal_Human_AdrenalGlands.pkl\ncell types of human fetal adrenal glands from ...\n\n\n29\nFetal_Human_Pancreas.pkl\npancreatic cell types from human embryos at 9-...\n\n\n30\nFetal_Human_Pituitary.pkl\ncell types of human fetal pituitaries from 7 t...\n\n\n31\nFetal_Human_Retina.pkl\ncell types from human fetal neural retina and ...\n\n\n32\nFetal_Human_Skin.pkl\ncell types from developing human fetal skin\n\n\n33\nHealthy_Adult_Heart.pkl\ncell types from eight anatomical regions of th...\n\n\n34\nHealthy_COVID19_PBMC.pkl\nperipheral blood mononuclear cell types from h...\n\n\n35\nHealthy_Human_Liver.pkl\ncell types from scRNA-seq and snRNA-seq of the...\n\n\n36\nHealthy_Mouse_Liver.pkl\ncell types from scRNA-seq and snRNA-seq of the...\n\n\n37\nHuman_AdultAged_Hippocampus.pkl\ncell types from the hippocampus of adult and a...\n\n\n38\nHuman_Colorectal_Cancer.pkl\ncell types of colon tissues from patients with...\n\n\n39\nHuman_Developmental_Retina.pkl\ncell types from human fetal retina\n\n\n40\nHuman_Embryonic_YolkSac.pkl\ncell types of the human yolk sac from 4-8 post...\n\n\n41\nHuman_Endometrium_Atlas.pkl\nendometrial cell types integrated from seven d...\n\n\n42\nHuman_IPF_Lung.pkl\ncell types from idiopathic pulmonary fibrosis,...\n\n\n43\nHuman_Longitudinal_Hippocampus.pkl\ncell types from the adult human anterior and p...\n\n\n44\nHuman_Lung_Atlas.pkl\nintegrated Human Lung Cell Atlas (HLCA) combin...\n\n\n45\nHuman_PF_Lung.pkl\ncell types from different forms of pulmonary f...\n\n\n46\nHuman_Placenta_Decidua.pkl\ncell types from first-trimester human placenta...\n\n\n47\nLethal_COVID19_Lung.pkl\ncell types from the lungs of individuals who d...\n\n\n48\nMouse_Dentate_Gyrus.pkl\ncell types from the dentate gyrus in perinatal...\n\n\n49\nMouse_Isocortex_Hippocampus.pkl\ncell types from the adult mouse isocortex (neo...\n\n\n50\nMouse_Postnatal_DentateGyrus.pkl\ncell types from the mouse dentate gyrus in pos...\n\n\n51\nMouse_Whole_Brain.pkl\ncell types from the whole adult mouse brain\n\n\n52\nNuclei_Lung_Airway.pkl\ncell populations from snRNA-seq of five locati...\n\n\n53\nPan_Fetal_Human.pkl\nstromal and immune populations from the human ...\n\n\n\n\n\n\n\n\nmodel = models.Model.load(model = 'Immune_All_High.pkl')\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o models.Model.load carrega o modelo pr√©-treinado escolhido (neste caso, ‚ÄúImmune_All_High.pkl‚Äù) para ser utilizado na anota√ß√£o. Este modelo cont√©m as assinaturas de express√£o g√™nica necess√°rias para classificar as c√©lulas em tipos celulares espec√≠ficos com base no seu perfil de express√£o. O modelo Immune_All_High foi treinado com dados de popula√ß√µes imunes combinadas de 20 tecidos de 18 estudos distintos, o que o torna adequado para anota√ß√µes em datasets diversos relacionados ao sistema imune.\nMais informa√ß√µes sobre os modelos dispon√≠veis podem ser encontradas em Celltypist Models.\n\n\n\n\nmodel.cell_types\n\narray(['B cells', 'B-cell lineage', 'Cycling cells', 'DC', 'DC precursor',\n       'Double-negative thymocytes', 'Double-positive thymocytes', 'ETP',\n       'Early MK', 'Endothelial cells', 'Epithelial cells',\n       'Erythrocytes', 'Erythroid', 'Fibroblasts', 'Granulocytes',\n       'HSC/MPP', 'ILC', 'ILC precursor', 'MNP', 'Macrophages',\n       'Mast cells', 'Megakaryocyte precursor',\n       'Megakaryocytes/platelets', 'Mono-mac', 'Monocyte precursor',\n       'Monocytes', 'Myelocytes', 'Plasma cells', 'Promyelocytes',\n       'T cells', 'pDC', 'pDC precursor'], dtype=object)"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#similaridade-entre-popula√ß√µes",
    "href": "material/semana3/06_cell_annotation.html#similaridade-entre-popula√ß√µes",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Similaridade entre popula√ß√µes",
    "text": "Similaridade entre popula√ß√µes\n\nsc.pl.dendrogram(adata, groupby = \"celltypist_cell_label\")\n\nWARNING: dendrogram data not found (using key=dendrogram_celltypist_cell_label). Running `sc.tl.dendrogram` with default parameters. For fine tuning it is recommended to run `sc.tl.dendrogram` independently.\n\n\n\n\n\n\n\n\nFigure¬†2: Dendrogram\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o sc.pl.dendrogram √© utilizada para visualizar a rela√ß√£o hier√°rquica entre os grupos de c√©lulas anotados. No exemplo acima, o argumento groupby = \"celltypist_cell_label\" especifica que as c√©lulas ser√£o agrupadas com base nas anota√ß√µes feitas pelo Celltypist.Este gr√°fico permite observar como os diferentes tipos celulares anotados se relacionam entre si com base no perfil de express√£o g√™nica global. C√©lulas com assinaturas semelhantes tendem a se agrupar mais pr√≥ximas no dendrograma, enquanto c√©lulas com perfis distintos aparecem mais afastadas.\nEsta abordagem √© √∫til para verificar se as anota√ß√µes refletem a biologia esperada, identificando poss√≠veis classifica√ß√µes inconsistentes ou agrupamentos inesperados entre os tipos celulares."
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#express√£o-das-assinaturas-g√™nicas",
    "href": "material/semana3/06_cell_annotation.html#express√£o-das-assinaturas-g√™nicas",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Express√£o das assinaturas g√™nicas",
    "text": "Express√£o das assinaturas g√™nicas\n\ntop_genes = dict()\n\nfor cell_type in adata.obs[\"celltypist_cell_label\"].unique():\n    markers = list(model.extract_top_markers(cell_type, 3))\n    for gene in markers:\n        if gene in list(adata.var_names):\n            top_genes.setdefault(cell_type, []).append(gene)\n\n\nall_markers = [item for sublist in top_genes.values() for item in sublist]\n\n\n\nCode\nfor cell, genes in top_genes.items():\n  #print(f\"{cell} e seus marcadores: {genes}\")\n  sc.tl.score_genes(adata, gene_list=genes, score_name=cell)\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o sc.tl.score_genes calcula um escore que resume a express√£o de uma assinatura g√™nica espec√≠fica em cada c√©lula. Biologicamente, isso √© importante para avaliar se os marcadores coletivamente delimitam a identidade das c√©lulas e/ou seus estados funcionais. Dessa forma, o escore facilita a visualiza√ß√£o e interpreta√ß√£o, pois atribui um valor cont√≠nuo √∫nico que reflete a express√£o da assinatura em cada c√©lula.\n\n\n\n\n# Plot each gene score in a subplot\nfor cell, genes in top_genes.items():\n    if cell in adata.obs.columns:\n        sc.pl.violin(adata, keys=cell, groupby=\"RNA_snn_res.0.25\", rotation=90)\n\n\n\n\n\n\n\n\n\n\n(a) Celltypist Gene Signature\n\n\n\n\n\n\n\n\n\n\n\n(b)\n\n\n\n\n\n\n\n\n\n\n\n(c)\n\n\n\n\n\n\n\n\n\n\n\n(d)\n\n\n\n\n\n\n\n\n\n\n\n(e)\n\n\n\n\n\n\n\n\n\n\n\n(f)\n\n\n\n\n\n\n\n\n\n\n\n(g)\n\n\n\n\n\n\n\n\n\n\n\n(h)\n\n\n\n\n\n\n\n\n\n\n\n(i)\n\n\n\n\n\n\n\n\n\n\n\n(j)\n\n\n\n\n\n\n\n\n\n\n\n(k)\n\n\n\n\n\n\n\n\n\n\n\n(l)\n\n\n\n\n\n\nFigure¬†3"
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#express√£o-diferencial",
    "href": "material/semana3/06_cell_annotation.html#express√£o-diferencial",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Express√£o diferencial",
    "text": "Express√£o diferencial\n\nsc.tl.rank_genes_groups(\n    adata,\n    groupby = \"celltypist_cell_label\",\n    method = \"wilcoxon\",\n    key_added = \"dea_cell_label\"\n    )\n\n\nsc.pl.rank_genes_groups_dotplot(\n    adata,\n    groupby = \"celltypist_cell_label\",\n    standard_scale = \"var\",\n    n_genes = 5,\n    key = \"dea_cell_label\"\n    )\n\n\n\n\n\n\n\nFigure¬†4: DotPlot\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nO comando sc.pl.rank_genes_groups_dotplot gera um gr√°fico do tipo dotplot que visualiza os genes diferencialmente expressos entre os grupos definidos pela anota√ß√£o do Celltypist (groupby = \"celltypist_cell_label\"). No eixo y do gr√°fico s√£o mostrados os grupos celulares anotados e no eixo x os genes diferencialmente expressos. Para cada grupo, s√£o exibidos at√© 5 genes mais representativos (n_genes = 5), definidos pela an√°lise armazenada na chave \"dea_cell_label\" do objeto AnnData. O argumento standard_scale = \"var\" padroniza os valores de express√£o dos genes, garantindo que eles sejam compar√°veis entre si. Isso √© √∫til para destacar padr√µes relativos de express√£o, independentemente das diferen√ßas absolutas de abund√¢ncia.\nNo dotplot, cada ponto indica:\n\nO tamanho: a fra√ß√£o de c√©lulas do grupo que expressa o gene.\nA cor: o n√≠vel m√©dio de express√£o do gene naquele grupo.\n\nEste tipo de visualiza√ß√£o √© essencial para validar se as anota√ß√µes dos tipos celulares fazem sentido com base nos genes marcadores expressos e para identificar assinaturas g√™nicas caracter√≠sticas ou √∫nicas de cada popula√ß√£o celular."
  },
  {
    "objectID": "material/semana3/06_cell_annotation.html#salvando-anota√ß√£o",
    "href": "material/semana3/06_cell_annotation.html#salvando-anota√ß√£o",
    "title": "06 - Anota√ß√£o de c√©lulas II",
    "section": "Salvando anota√ß√£o",
    "text": "Salvando anota√ß√£o\n\n# Selecionar colunas de anota√ß√£o que ser√£o salvas\nannotations = adata.obs[[\"celltypist_cell_label\", \"celltypist_conf_score\"]]\n\n# Salvar como CSV\nannotations.to_csv(\"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1/data/celltypist_annotations.csv\")"
  },
  {
    "objectID": "material/semana4/07_data_integration.html",
    "href": "material/semana4/07_data_integration.html",
    "title": "07 - Integra√ß√£o de dados",
    "section": "",
    "text": "A integra√ß√£o de dados de transcript√¥mica de c√©lula √∫nica √© crucial para mitigar efeitos de batch e possibilitar an√°lises comparativas robustas entre diferentes amostras, tecnologias ou condi√ß√µes experimentais. Seurat v5 simplifica esse processo com suporte a m√∫ltiplos m√©todos de integra√ß√£o e estrutura moderna baseada em camadas."
  },
  {
    "objectID": "material/semana4/07_data_integration.html#motiva√ß√£o",
    "href": "material/semana4/07_data_integration.html#motiva√ß√£o",
    "title": "07 - Integra√ß√£o de dados",
    "section": "",
    "text": "A integra√ß√£o de dados de transcript√¥mica de c√©lula √∫nica √© crucial para mitigar efeitos de batch e possibilitar an√°lises comparativas robustas entre diferentes amostras, tecnologias ou condi√ß√µes experimentais. Seurat v5 simplifica esse processo com suporte a m√∫ltiplos m√©todos de integra√ß√£o e estrutura moderna baseada em camadas."
  },
  {
    "objectID": "material/semana4/07_data_integration.html#contextualiza√ß√£o",
    "href": "material/semana4/07_data_integration.html#contextualiza√ß√£o",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Contextualiza√ß√£o",
    "text": "Contextualiza√ß√£o\nNeste tutorial, exploramos abordagens modernas para integra√ß√£o de dados scRNA-seq, com foco em m√©todos implementados ou compat√≠veis com o pacote Seurat e suas extens√µes. A integra√ß√£o √© fundamental para eliminar varia√ß√µes t√©cnicas (batch effects) e permitir a compara√ß√£o significativa entre m√∫ltiplas amostras ou tecnologias.\nOs m√©todos empregados podem ser classificados da seguinte forma:\n\nIntegra√ß√£o baseada em √¢ncoras can√¥nicas (CCA) ‚Äì m√©todo nativo do Seurat para identificar correspond√™ncias entre subespa√ßos compartilhados entre amostras;\nIntegra√ß√£o baseada em redu√ß√£o robusta de dimensionalidade (RPCA) ‚Äì alternativa mais r√°pida e conservadora ao CCA;\nM√©todos baseado em regress√£o no espa√ßo latente (Harmony) ‚Äì utiliza regress√£o em espa√ßos latentes para alinhar c√©lulas de diferentes batches;\nIntegra√ß√£o por vizinhos m√∫tuos (MNN) ‚Äì implementado via pacote batchelor, baseado em correspond√™ncia de vizinhos pr√≥ximos entre datasets;\nAvalia√ß√£o de batch effect com m√©tricas ‚Äì usada para quantificar a efici√™ncia da remo√ß√£o de efeito de batch sem perda de estrutura biol√≥gica.\n\nEste conjunto de ferramentas permite executar pipelines flex√≠veis, comparar m√©todos e validar a integra√ß√£o com m√©tricas objetivas."
  },
  {
    "objectID": "material/semana4/07_data_integration.html#ajustar-ambientar-e-carregar-pacotes",
    "href": "material/semana4/07_data_integration.html#ajustar-ambientar-e-carregar-pacotes",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Ajustar ambientar e carregar pacotes",
    "text": "Ajustar ambientar e carregar pacotes\n\n# Carregar pacotes\nlibrary(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(Seurat)\nlibrary(SeuratWrappers)\nlibrary(harmony)\nlibrary(batchelor)\nlibrary(scPOP)\nlibrary(kBET)\n\n# Definindo diretorio padrao\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)\n\n# Aumentar o limite de uso de memoria\noptions(future.globals.maxSize = 10 * 1024^3) # 10 GB, por exemplo"
  },
  {
    "objectID": "material/semana4/07_data_integration.html#carregando-dados-do-projeto",
    "href": "material/semana4/07_data_integration.html#carregando-dados-do-projeto",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Carregando dados do projeto",
    "text": "Carregando dados do projeto\n\n# Carregue seu objeto Seurat\nseurat_object &lt;- readRDS(file = here::here(\"data/seurat_multi_technology.RDS\"))"
  },
  {
    "objectID": "material/semana4/07_data_integration.html#pr√©-processamento",
    "href": "material/semana4/07_data_integration.html#pr√©-processamento",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Pr√©-processamento",
    "text": "Pr√©-processamento\n\nseurat_object[[\"RNA\"]] &lt;- split(seurat_object[[\"RNA\"]], f = seurat_object$kit)\n\n\nseurat_object &lt;- NormalizeData(\n  seurat_object, normalization.method = \"LogNormalize\", scale.factor = 10000)\n\nseurat_object &lt;- FindVariableFeatures(\n  seurat_object, selection.method = \"vst\", nfeatures = 2000)\n\nseurat_object &lt;- ScaleData(\n  seurat_object, features = VariableFeatures(seurat_object))\n\nseurat_object &lt;- RunPCA(seurat_object, npcs = 50, verbose = FALSE)\n\n\nseurat_object &lt;- FindNeighbors(seurat_object, dims = 1:20)\n\nseurat_object &lt;- FindClusters(\n  seurat_object, \n  cluster.name = \"unintegrated_clusters\",\n  resolution = 0.25\n  )\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 23250\nNumber of edges: 837879\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9596\nNumber of communities: 17\nElapsed time: 3 seconds\n\n\n\nseurat_object &lt;- RunUMAP(\n  seurat_object, \n  dims = 1:20, \n  reduction = \"pca\", \n  reduction.name = \"umap.unintegrated\"\n  )"
  },
  {
    "objectID": "material/semana4/07_data_integration.html#visualizando-umap",
    "href": "material/semana4/07_data_integration.html#visualizando-umap",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Visualizando UMAP",
    "text": "Visualizando UMAP\n# Verificar os clusters\nDimPlot(seurat_object, group.by = \"kit\")\n\n\n\n\n\n\n\n\n\nFigure¬†1"
  },
  {
    "objectID": "material/semana4/07_data_integration.html#integra√ß√£o-com-diferentes-m√©todos",
    "href": "material/semana4/07_data_integration.html#integra√ß√£o-com-diferentes-m√©todos",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Integra√ß√£o com diferentes m√©todos",
    "text": "Integra√ß√£o com diferentes m√©todos\nNesta etapa, aplicaremos diferentes estrat√©gias de integra√ß√£o de dados scRNA-seq implementadas no Seurat v5. Ser√£o utilizados m√©todos representativos de distintas abordagens: modelos lineares (CCA, RPCA), m√©todos baseados em regress√£o latente (Harmony) e correspond√™ncia de vizinhos m√∫tuos (FastMNN). O objetivo √© comparar como cada t√©cnica corrige o efeito de batch ao alinhar c√©lulas provenientes de diferentes plataformas (Platform).\n\nCCA\n\nseurat_object &lt;- IntegrateLayers(\n  object = seurat_object, \n  method = CCAIntegration,\n  orig.reduction = \"pca\", \n  new.reduction = \"integrated.cca\",\n  verbose = FALSE\n)\n\n\n\n\n\n\n\nNote\n\n\n\n\n\nA fun√ß√£o IntegrateLayers do Seurat v5 permite aplicar diferentes estrat√©gias de integra√ß√£o de dados em uma √∫nica linha de c√≥digo. Ela opera sobre uma redu√ß√£o de dimensionalidade inicial (ex: PCA) e retorna uma nova representa√ß√£o integrada, facilitando a compara√ß√£o entre m√©todos como CCA, RPCA, Harmony e FastMNN. Essa abordagem √© √∫til para\n\n\n\n\n\nRPCA\n\nseurat_object &lt;- IntegrateLayers(\n  object = seurat_object, \n  method = RPCAIntegration,\n  orig.reduction = \"pca\", \n  new.reduction = \"integrated.rpca\",\n  verbose = FALSE\n)\n\n\n\nHarmony\n\nseurat_object &lt;- IntegrateLayers(\n  object = seurat_object, \n  method = HarmonyIntegration,\n  orig.reduction = \"pca\", \n  new.reduction = \"harmony\",\n  verbose = FALSE\n)\n\n\n\nFastMNN\n\nseurat_object &lt;- IntegrateLayers(\n  object = seurat_object, \n  method = FastMNNIntegration,\n  orig.reduction = \"pca\", \n  new.reduction = \"integrated.mnn\",\n  verbose = FALSE\n)"
  },
  {
    "objectID": "material/semana4/07_data_integration.html#p√≥s-processamento-e-clustering",
    "href": "material/semana4/07_data_integration.html#p√≥s-processamento-e-clustering",
    "title": "07 - Integra√ß√£o de dados",
    "section": "P√≥s-processamento e clustering",
    "text": "P√≥s-processamento e clustering\nAp√≥s a integra√ß√£o, aplicamos uma etapa padronizada de p√≥s-processamento para cada m√©todo. Isso inclui a constru√ß√£o da matriz de vizinhan√ßa, detec√ß√£o de comunidades (clustering) e proje√ß√£o UMAP para visualiza√ß√£o. Essa abordagem permite comparar diretamente como cada m√©todo de integra√ß√£o influencia a estrutura dos dados e a separa√ß√£o entre popula√ß√µes celulares.\n\n# Vetor com os nomes das redu√ß√µes geradas por cada m√©todo de integra√ß√£o\nintegration_method_vector &lt;- c('integrated.cca', 'integrated.rpca', 'harmony', 'integrated.mnn')\n\nfor (batch_method in integration_method_vector) {\n  \n  # Encontrar vizinhos com base na redu√ß√£o integrada\n  seurat_object &lt;- FindNeighbors(\n    object = seurat_object, \n    reduction = batch_method, \n    dims = 1:50,\n    graph.name = 'snn_npc_0.25'\n  )\n\n  # Realizar clusteriza√ß√£o com base no grafo constru√≠do\n  seurat_object &lt;- FindClusters(\n    object = seurat_object,\n    graph.name = 'snn_npc_0.25',\n    cluster.name = paste0(batch_method, '_clusters'),\n    resolution = 0.25\n  )\n  \n  # Gerar redu√ß√£o UMAP a partir do embedding integrado\n  seurat_object &lt;- RunUMAP(\n    object = seurat_object,\n    reduction.key = \"umap_\",\n    reduction = batch_method, \n    dims = 1:50,\n    reduction.name = paste0(\"umap_\", batch_method),\n    seed.use = 42\n  )\n  \n}\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 23250\nNumber of edges: 191612\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9284\nNumber of communities: 221\nElapsed time: 1 seconds\n\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 23250\nNumber of edges: 229042\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9266\nNumber of communities: 59\nElapsed time: 1 seconds\n\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 23250\nNumber of edges: 238648\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9325\nNumber of communities: 39\nElapsed time: 1 seconds\n\n\nModularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck\n\nNumber of nodes: 23250\nNumber of edges: 211884\n\nRunning Louvain algorithm...\nMaximum modularity in 10 random starts: 0.9289\nNumber of communities: 76\nElapsed time: 1 seconds"
  },
  {
    "objectID": "material/semana4/07_data_integration.html#visualiza√ß√µes-comparativas",
    "href": "material/semana4/07_data_integration.html#visualiza√ß√µes-comparativas",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Visualiza√ß√µes comparativas",
    "text": "Visualiza√ß√µes comparativas\nAp√≥s a aplica√ß√£o dos diferentes m√©todos de integra√ß√£o e suas respectivas proje√ß√µes UMAP, √© importante comparar visualmente como cada abordagem organizou as c√©lulas no espa√ßo latente. A seguir, utilizamos DimPlot para gerar um gr√°fico UMAP para cada t√©cnica, destacando a distribui√ß√£o das amostras por batch. Isso permite avaliar qualitativamente o grau de corre√ß√£o do efeito de batch e a preserva√ß√£o da estrutura biol√≥gica.\n# Lista para armanezar as imagens geradas para cada integra√ß√£o\nintegration_umap &lt;- list()\n\nfor (batch_method in integration_method_vector) {\n\n  # Armazenar o gr√°fico UMAP correspondente ao m√©todo atual\n  integration_umap[[batch_method]] &lt;- DimPlot(\n      seurat_object, \n      reduction = paste0(\"umap_\", batch_method),\n      group.by = 'kit',\n      raster = FALSE,\n    ) +\n    labs(title = batch_method) + \n    theme(\n      legend.position = 'top',\n      legend.justification = 'center'\n    )\n  \n}\n\n# Exibir cada um dos gr√°ficos UMAP integrados individualmente\nintegration_umap$integrated.cca\nintegration_umap$integrated.rpca\nintegration_umap$harmony\nintegration_umap$integrated.mnn\n\n\n\n\n\n\n\n\n\nFigure¬†2\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†3\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†4\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†5\n\n\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\n\n\n\nEmbora as visualiza√ß√µes UMAP sejam √∫teis para inspe√ß√£o inicial, elas representam apenas uma proje√ß√£o bidimensional de dados de alta dimens√£o. Essa abordagem qualitativa pode induzir a interpreta√ß√µes equivocadas sobre a real separa√ß√£o entre popula√ß√µes celulares ou a efic√°cia da corre√ß√£o de batch. Por isso, √© recomend√°vel complementar essas an√°lises com m√©tricas quantitativas, como kBET, LISI ou ARI, que oferecem avalia√ß√µes mais robustas da integra√ß√£o."
  },
  {
    "objectID": "material/semana4/07_data_integration.html#avalia√ß√£o-com-m√©tricas",
    "href": "material/semana4/07_data_integration.html#avalia√ß√£o-com-m√©tricas",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Avalia√ß√£o com m√©tricas",
    "text": "Avalia√ß√£o com m√©tricas\nA inspe√ß√£o visual por UMAP √© uma ferramenta √∫til, mas insuficiente para avaliar com rigor a qualidade da integra√ß√£o. Para isso, √© recomend√°vel aplicar m√©tricas quantitativas que estimem de forma objetiva o balanceamento entre batches e a preserva√ß√£o da estrutura biol√≥gica.\nNo trecho abaixo, utilizamos a fun√ß√£o run_all_metrics(), que executa um conjunto de m√©tricas baseadas nos embeddings gerados por cada m√©todo de integra√ß√£o. Essas m√©tricas consideram tanto a capacidade de mistura entre batches (batch mixing) quanto a manuten√ß√£o de agrupamentos biol√≥gicos definidos por anota√ß√µes celulares e clusters.\nComo complemento opcional, pode-se empregar o teste kBET, que avalia a homogeneidade local de vizinhan√ßa entre batches. Apesar de √∫til, seu uso depende de ajustes espec√≠ficos e pode ser computacionalmente mais custoso.\n\n# Data.frame vazio para armazenas as metricas\nmetrics_df &lt;- data.frame()\n\nfor (batch_method in integration_method_vector) {\n  \n  # Extrair as coordenadas de embedding do m√©todo de integra√ß√£o\n  batch_method_embeddings &lt;- Embeddings(\n    object = seurat_object, \n    reduction = batch_method\n  )\n  \n  # Calculando m√©tricas a partir do pacote scPOP\n  metrics &lt;- run_all_metrics(\n    reduction = batch_method_embeddings, \n    metadata = seurat_object@meta.data,\n    batch_key = 'kit',\n    label1_key = 'cell_type',\n    label2_key = paste0(batch_method, '_clusters'),\n    run_name = batch_method\n    )\n  \n  colnames(metrics) &lt;- c(\"run\", \"ari_label\", \"nmi_label\", \"lisi_batch\", \"lisi_cell_type\", \"lisi_clusters\", \"silWidth_batch\", \"silWidth_cell_type\", \"silWidth_clusters\")\n    \n  metrics_df &lt;- rbind(\n    metrics,\n    metrics_df\n  )\n\n}\n\n\nscpop_zscore &lt;- calc_sumZscore(\n  lapply(integration_method_vector, function(batch_method) {\n    metrics_df[metrics_df$run == batch_method, 2:9]\n  }),\n  'kit'\n)\n\nmetrics_df$zscore &lt;- scpop_zscore\n\n\n# Explore as metricas\nDT::datatable(metrics_df)"
  },
  {
    "objectID": "material/semana4/07_data_integration.html#salvando-o-objeto-anotado",
    "href": "material/semana4/07_data_integration.html#salvando-o-objeto-anotado",
    "title": "07 - Integra√ß√£o de dados",
    "section": "Salvando o objeto anotado",
    "text": "Salvando o objeto anotado\n\nsaveRDS(seurat_object, file = './data/seurat_integrated.RDS')"
  },
  {
    "objectID": "material/semana3/05_cell_annotation.html#ajustar-ambientar-e-carregar-pacotes",
    "href": "material/semana3/05_cell_annotation.html#ajustar-ambientar-e-carregar-pacotes",
    "title": "05 - Anota√ß√£o de c√©lulas",
    "section": "Ajustar ambientar e carregar pacotes",
    "text": "Ajustar ambientar e carregar pacotes\n\n# Instalar pacotes necess√°rios caso n√£o estejam instalados\nif (!requireNamespace(\"SingleR\")) BiocManager::install(\"SingleR\")\nif (!requireNamespace(\"celldex\")) BiocManager::install(\"celldex\")\n\n# Carregar pacotes\nlibrary(Seurat)\nlibrary(presto)\nlibrary(SingleR)\nlibrary(celldex)\nlibrary(SingleCellExperiment)\nlibrary(dplyr)\n\n# Definindo diretorio padrao\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)\n\n# Aumentar o limite de uso de memoria\noptions(future.globals.maxSize = 5 * 1024^3) # 5 GB, por exemplo"
  }
]