{
  "hash": "f4de52340c545f461d2954727eb4d0e7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"05 - Anotação de células\"\nformat:\n  html:\n    toc: true\n    toc-depth: 3\nexecute: \n  cache: false\n---\n\n\n\n\n## Motivação\n\nA anotação de células é uma etapa crítica na análise de dados de transcriptômica de célula única (scRNA-seq). Ela permite transformar clusters não rotulados em informações biológicas significativas, descrevendo tipos celulares e seus estados funcionais. A anotação adequada é essencial para interpretações corretas e para garantir reprodutibilidade e comparabilidade entre estudos.\n\n## Contextualização\n\nApós etapas de pré-processamento e clusterização, cada célula ou agrupamento (cluster) carece de uma identidade biológica. A anotação pode ser realizada de maneira:\n\n-   **Manual**: com base na expressão de genes marcadores conhecidos.\n-   **Automatizada**: utilizando ferramentas que comparam perfis de expressão com bancos de dados de referência.\n\nNeste tutorial, mostraremos ambas as abordagens usando o pacote `Seurat` e ferramentas como `SingleR` para anotação automática.\n\n## Carregar dados e pacotes necessários\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Instalar pacotes necessários caso não estejam instalados\nif (!requireNamespace(\"SingleR\")) BiocManager::install(\"SingleR\")\nif (!requireNamespace(\"celldex\")) BiocManager::install(\"celldex\")\n\n# Carregar pacotes\nlibrary(Seurat)\nlibrary(presto)\nlibrary(SingleR)\nlibrary(celldex)\nlibrary(SingleCellExperiment)\nlibrary(dplyr)\n\n# Definindo diretorio padrao\nknitr::opts_knit$set(\n  root.dir = \"/home/oandrefonseca/Disciplinas/PPGBM0117.2025.1\",\n  verbose = FALSE\n)\n\n# Aumentar o limite de uso de memoria\noptions(future.globals.maxSize = 5 * 1024^3) # 5 GB, por exemplo\n```\n:::\n\n\n\n\n## Carregando dados do projeto\n\n\n\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Carregando um objeto Seurat já processado (pré-clusterizado)\nseurat_object <- readRDS(file = here::here(\"data/seurat_clustered.RDS\"))\n\n# Verificar os clusters\nDimPlot(seurat_object, group.by = \"seurat_clusters\")\n```\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-umap-1.png){#fig-umap fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## Anotação Manual\n\nA anotação manual é uma abordagem fundamental, especialmente em experimentos onde o conhecimento biológico é indispensável para interpretar os dados.\n\n**O que é feito nesta etapa?**\n\nApós a clusterização, cada agrupamento de células é apenas um número (por exemplo, Cluster 0, Cluster 1, Cluster N...). O objetivo é atribuir esses agrupamentos identidade biológica (celular) com base na expressão de **genes marcadores bem conhecidos**.\n\n**Como fazemos isso?**\n\n-   Usamos funções como `FindAllMarkers` para identificar genes mais expressos em cada cluster.\n-   Verificamos a expressão desses genes em visualizações como `FeaturePlot` ou `VlnPlot`.\n-   Com base no padrão de expressão, atribuímos rótulos apropriados. Por exemplo:\n    -   **CD3D+** → Provavelmente células T\n    -   **MS4A1+** → Provavelmente células B\n    -   **LYZ+** → Provavelmente monócitos/macrófagos\n    -   **PPBP+** → Plaquetas\n\n::: {.callout-note collapse=\"false\"}\n**Importante**: A anotação manual exige conhecimento prévio da literatura para garantir a precisão das atribuições. É recomendável validar com bancos de dados públicos e reavaliar periodicamente.\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!file.exists(here::here(\"data/cluster_markers.RDS\"))) {\n  \n  # Vamos fazer uma anotacao mais generica usando a resolucao de 0.25\n  Idents(seurat_object) <- \"RNA_snn_res.0.25\"\n  \n  # Identificar genes marcadores para clusters\n  cluster_markers <- FindAllMarkers(seurat_object, only.pos = TRUE)\n  saveRDS(file = \"data/cluster_markers.RDS\", object = cluster_markers)\n  \n} \n\ncluster_markers <- readRDS(file = \"data/cluster_markers.RDS\")\n```\n:::\n\n\n\n\n### Inspecionando DEGs\n\n\n\n\n::: {.cell .column-screen-inset-shaded}\n\n```{.r .cell-code}\n# Removendo resultados nao significativos\ncluster_markers_top <- cluster_markers %>%\n    filter(\n      p_val_adj <= 0.05,\n      avg_log2FC >= 0.25,\n      pct.1 >= 0.20,\n      pct.1 > pct.2\n    )\n\ncluster_markers_top <- cluster_markers_top %>%\n  group_by(cluster) %>%\n  top_n(20, avg_log2FC)\n\nDT::datatable(cluster_markers_top)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-64810cc4f2b4039638ca\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-64810cc4f2b4039638ca\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\",\"327\",\"328\",\"329\",\"330\",\"331\",\"332\",\"333\",\"334\",\"335\",\"336\",\"337\",\"338\",\"339\",\"340\",\"341\",\"342\",\"343\",\"344\",\"345\",\"346\",\"347\",\"348\",\"349\",\"350\",\"351\",\"352\",\"353\",\"354\",\"355\",\"356\",\"357\",\"358\",\"359\",\"360\",\"361\",\"362\",\"363\",\"364\",\"365\",\"366\",\"367\",\"368\",\"369\",\"370\",\"371\",\"372\",\"373\",\"374\",\"375\",\"376\",\"377\",\"378\",\"379\",\"380\",\"381\",\"382\",\"383\",\"384\",\"385\",\"386\",\"387\",\"388\",\"389\",\"390\",\"391\",\"392\",\"393\",\"394\",\"395\",\"396\",\"397\",\"398\",\"399\",\"400\",\"401\",\"402\",\"403\",\"404\",\"405\",\"406\",\"407\",\"408\",\"409\",\"410\",\"411\",\"412\",\"413\",\"414\",\"415\",\"416\",\"417\",\"418\",\"419\",\"420\",\"421\",\"422\",\"423\",\"424\",\"425\",\"426\",\"427\",\"428\",\"429\",\"430\",\"431\",\"432\",\"433\",\"434\",\"435\",\"436\",\"437\",\"438\",\"439\",\"440\",\"441\",\"442\",\"443\",\"444\",\"445\",\"446\",\"447\",\"448\",\"449\",\"450\",\"451\",\"452\",\"453\",\"454\",\"455\",\"456\",\"457\",\"458\",\"459\",\"460\",\"461\",\"462\",\"463\",\"464\",\"465\",\"466\",\"467\",\"468\",\"469\",\"470\",\"471\",\"472\",\"473\",\"474\",\"475\",\"476\",\"477\",\"478\",\"479\",\"480\",\"481\",\"482\",\"483\",\"484\",\"485\",\"486\",\"487\",\"488\",\"489\",\"490\",\"491\",\"492\",\"493\",\"494\",\"495\",\"496\",\"497\",\"498\",\"499\",\"500\",\"501\",\"502\",\"503\",\"504\",\"505\",\"506\",\"507\",\"508\",\"509\",\"510\",\"511\",\"512\",\"513\",\"514\",\"515\",\"516\",\"517\",\"518\",\"519\",\"520\",\"521\",\"522\",\"523\",\"524\",\"525\",\"526\",\"527\",\"528\",\"529\",\"530\",\"531\",\"532\",\"533\",\"534\",\"535\",\"536\",\"537\",\"538\",\"539\",\"540\"],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.596736579779329e-227,1.87724540603153e-222,9.104311254842029e-182,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.386465734619202e-265,5.190972066969229e-243,1.483079604426279e-234,1.344125845247286e-233,8.577690602261709e-229,4.004957249579787e-173,1.900848712433128e-115,2.688803397415583e-110,3.78743668130193e-94,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.315612736474172e-277,7.259232662211403e-260,8.752836606984351e-205,1.031005363922831e-198,7.812785621411858e-173,1.184874618664344e-163,3.294714701569736e-155,8.282325757464609e-121,1.98323989941703e-101,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.161165679885732e-303,6.474681586627601e-303,1.0807366020837e-298,2.017121858761053e-263,4.054108279587332e-237,2.394008835615119e-236,1.571214640234444e-182,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.5710497771025e-296,1.039112883707616e-228,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.69456797897784e-242,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.625778797494359e-281,5.450236210828627e-248,2.230299268031476e-230,9.530649568137364e-226,1.33471794731707e-223,2.866168268414581e-202,1.259256722899807e-200,3.666355283737161e-195,2.063467611951257e-165,5.27072714202462e-163,1.858986056059049e-159,5.616254296456366e-151,1.063729458404616e-141,6.107462437769719e-121,5.399531980357552e-112,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.035460136335779e-287,1.169082478252568e-275,9.877157100206375e-257,2.10006589955341e-252,1.236410866355086e-213,3.334796534798104e-200,1.920197276371556e-178,2.924838036370117e-144,9.530974456708867e-141,5.948507259661655e-112,3.964724395840994e-65,3.203959557826183e-240,1.237578744577755e-161,7.652352489183159e-149,2.147788265460079e-129,8.82530657915647e-100,4.717938751672449e-95,1.731840711144398e-80,2.347227466537452e-63,6.721505640225045e-59,9.187477574162269e-58,3.047265166360171e-48,1.16969875379962e-42,1.772467812497086e-42,6.139659466543592e-38,1.499161571896555e-35,3.77415330792844e-35,1.34960999238315e-34,8.262139839449888e-26,1.679207064437006e-22,4.966280890139636e-20],[2.665579741918845,2.790193044971611,1.876017408549325,1.983091371452903,1.753055326917777,1.981459327743399,2.40543057062381,2.413235392924836,2.124440069146689,1.751981364178504,1.838210765658819,2.565198878783791,2.693561266439557,2.538287306659619,2.125339419501983,1.866486178513552,1.759962596707219,1.782290040624762,1.850457341528926,1.718955292899778,6.703652422130735,5.517608085250092,4.793267286464372,4.882457314493188,5.706315443902479,6.398445177057898,5.912695672909802,5.829111716343872,5.863030541469577,4.98993472264092,5.648778123321254,7.253720280578609,4.97691536662875,5.832632665515937,5.013715667645798,4.958414419298815,6.874851548607912,7.478073904057868,6.418499964997727,5.531519523356942,1.623875577120028,1.623346138862892,1.842982834687232,1.651936837961361,1.994944212155777,1.889756872679822,1.772375666527573,1.744973609630036,1.762656361103308,1.864592127210547,1.995674577343421,1.941365550326519,1.922591187975617,1.831256913001558,1.852282874826245,2.094721032368602,1.600249122847099,1.628342673146282,1.683943007683681,1.565958682929695,2.642226071626205,3.22050137104794,3.162466398542703,5.233840303104602,2.620919513863317,3.531912190299771,2.473156484633343,3.216315673701315,4.052012834462583,2.717676281548512,3.155792254007825,2.582645023516806,3.450587627116277,3.365176525418746,2.614835570768362,2.723071663520293,2.737967859120696,2.45971744586999,3.794880372323931,2.63670836902324,1.780895821714255,1.893171239282696,1.55737571076105,2.130471279024899,1.797245524225251,1.786048934067537,1.310216399891715,1.456822779925045,1.959238058227743,1.730436208488059,1.753144938119932,1.548474391082288,1.710422030976556,1.484674665367477,1.611958765398837,1.484143468654016,1.458229038555912,1.353457923630225,1.355179284511817,1.287691251472051,9.259724045067575,12.06919131727432,8.624113350741762,8.894336068027622,10.8920386501835,9.469999426926956,8.671597387000336,9.478487591050897,8.981575101358708,9.731150891860171,8.35206963709085,10.22940775837035,9.913054832183555,9.135829506808522,8.43213141106359,8.653602358959919,8.307608708516607,8.403230951954681,9.282059354791507,8.468001693863664,3.184561425376625,2.865678662716149,2.65584979899455,4.271090703277668,3.487261647277656,2.985306666418227,2.67669426331475,2.946082231094999,3.04719905776016,4.611931013690555,3.597608262951019,3.168194720383056,2.779484043052388,3.604763430033886,3.035589693245774,2.785944798763888,5.108596242132563,3.906765073971588,3.242010533083561,4.093730827428261,3.012155478380061,3.258602057004479,3.083708790210851,3.263337592480335,3.298758638932576,3.311515210037575,3.037871365756525,2.929539901795371,2.901559941920774,3.091118768369019,3.188161996779103,3.313103774648182,2.925665484173056,3.094560872711421,3.027041930588226,3.465648975161287,2.871676922338081,2.897521537241704,2.899619889805731,2.988695189131952,9.089261510614961,8.312314648433478,9.611978803059797,9.552511390049947,8.661550407097721,8.99803644061325,8.711422738307133,8.53673610932632,8.692434649686788,9.68278572769248,8.784136268276827,8.512447631513284,8.825113276953362,8.869985266199528,9.203786160700925,9.01251726488767,9.505368925668016,9.140013457645418,8.18816863538405,9.470137590922723,1.847511949152091,2.150166289873086,1.942098033934569,2.091864187693096,2.849473526966967,2.267415990184085,1.718391103814171,2.073898685767243,1.957045547840367,1.982403110864001,1.601770056401581,1.492191101602089,1.507803323975796,1.747376830806424,2.269976111464042,1.688528775178576,1.543465526105293,1.944088504902793,1.550000519074139,1.559272653880228,2.6660477657113,3.033461624947881,2.765434020260828,3.598428496498675,3.0408779021213,3.483782306992013,3.104289340240208,2.239496219749046,2.658324180289638,3.031649550029438,3.458105012894137,3.194486495404332,3.942464449076127,4.074883133950845,2.423701235523287,2.593877254933022,2.876250725958142,2.724965642410664,5.016761262106362,2.359744351339565,4.711857202490958,2.137990358290456,3.045631414909962,2.174238449092484,3.772941602267616,2.35437419990432,2.286409445148402,3.016757571229103,3.617129059890507,3.546237802313849,2.4181665804902,3.35384706055954,3.054703997454832,3.448452766210626,4.284478861161394,2.488534463947206,2.626089547808087,3.093112620180166,2.476382023500401,2.32473246173502,8.098920400338011,6.854900876696267,8.038486901534931,7.820364194590905,9.682494370632314,7.966611471991078,7.498310674200502,7.670337699996717,8.901288445570733,6.90648088312931,9.033374126420448,7.19653969152537,8.157989321579448,7.856559955165676,7.357955845497192,8.812856268165394,8.168988253153113,7.518140009341548,6.955817158577258,10.57021656908164,9.263026928161432,9.419846318836036,8.449412155265552,12.94266325629473,9.400017682795315,8.429103201057803,11.13145668105312,8.561125578650202,10.96865114953229,8.376461802636607,8.812765330876985,9.015709450714379,10.80326101563982,8.287190640187656,10.99177682911603,10.16870598937629,8.498489874950812,9.706506711010093,8.642916774728366,9.152474394562327,5.407813312463484,5.546608607641163,6.465671876052253,5.947486566105452,5.60010264564724,6.179350154028028,5.330906706449888,7.156370331310069,6.312764232555131,7.497154604590321,5.24369968413256,5.287377552919122,6.874054285832496,5.35480307255426,5.300410542729773,6.458789224112543,9.10252340425491,6.567551284520771,5.283834430219254,6.339151034552762,6.347818176175581,7.103250713574616,6.451148312201948,7.043939311419055,6.471769125162749,6.657831368308197,6.533839074632595,6.788684601105643,6.971971282725224,6.188583894919559,6.431394876578118,6.823634798438571,5.877634906253412,6.349003256550428,6.564320876868603,6.439374023943818,6.338066559815046,6.370002570442633,6.120133614451019,6.035308541260745,9.669630108450693,8.092235357711917,9.588249528401574,8.092663718052103,9.488960612197173,8.304397569956004,11.6020653120181,9.307526012991451,9.65321936428311,8.780677105805848,9.078144574238344,8.08157783411634,8.860940285328399,11.62341528791074,8.062138461013737,8.756134312259308,9.161774517036191,10.64548208248278,9.239316139504549,10.12413678857555,3.348350866792276,3.063382753191077,5.565853488885297,3.174482776005619,3.263712149044469,4.804968131827066,3.153063938891494,3.364708234845077,3.318800103483019,3.273039739208874,4.521294741049172,3.197857816546335,4.096817096972829,4.29319432140871,4.986702174276472,3.40907080296157,4.266657384354744,3.994350186947038,3.367203408610451,3.013157752822869,8.377510194905597,6.918987840373953,7.56723395898031,8.091318311916975,6.765091306386594,6.966852224691183,6.76812272714181,7.09574516806012,7.164725934487998,9.178414970838066,7.387938269212976,7.974051294531806,9.171144648629376,7.739634218474531,9.532006716910146,7.052158648321491,7.980103332328904,7.432792092423891,6.755426028886381,8.62897181022676,9.730630729294901,10.65898485051973,10.27528020692466,9.829604153703906,9.662924940669303,11.40739421841354,13.37039390633086,11.15388836831835,10.69186013532203,13.35085017372997,13.1091599725255,11.79492459349031,13.44367371350971,10.51478571290386,11.10410200231711,10.27438893083758,10.75762936412261,10.27571872698246,13.40078450878024,10.62329455160656,11.92767481773513,8.992260549490009,8.250790341588136,10.04581291167008,9.520718276500725,8.821954823185258,8.992891705127407,8.331756164834138,8.467993498184864,11.34790282212012,10.36039054103651,8.489140020639411,10.97295666905702,10.21713248681041,8.780908423041948,8.396209863163453,10.14598587202627,8.199628975721055,8.591246547877805,8.424087732661196,4.92340523250421,5.026229302365803,4.40958526589622,4.631716567775835,5.4528322612282,4.383309502438621,4.684659169097468,4.348480395252138,4.756378208852875,4.621581726874666,5.009097798791392,4.931890480745682,5.040558098150687,4.5103292777331,4.746868688477312,4.666364943623,4.83633194023521,4.82108864479348,4.734956523056386,4.489290425225129,14.23773204105007,13.58729736512305,13.46869995481144,11.26855187063902,11.34626765355197,8.163259953942788,14.00177446190107,10.17871712803814,9.671817507664544,14.04698323454424,7.246127319705764,11.09879190774749,13.11355394773706,10.16358848157182,12.43704571493656,14.05094956577355,8.843598685775513,8.535946845040398,9.973987210228914,9.352947480873439,5.303174021239523,5.389183567382505,6.02345210303597,5.944619817559428,7.635249863340537,6.334101129515861,6.001834089344213,6.271920140296663,5.432423214877779,7.691064202189446,6.060636424867633,5.474560276650597,5.258583525546888,5.798324468706895,7.374457390695,7.048335712122271,5.376244195360841,6.203312304525515,5.864153781057556,5.666808349438068,10.96816300856975,14.44226727564818,11.76162092684579,12.26636675109051,11.99638270378427,10.96982643392245,10.39397158702727,12.63467248209801,12.64029766603403,12.93367132639433,11.3680587352496,10.83190895445154,10.65134893954552,9.988068676912185,10.03486664743141,10.00089088504847,11.56432555697427,9.942488951846329,10.50103425935255,10.05160647893046,4.824807214004649,4.952922809661007,5.282716532447021,5.591878584186914,4.877076158918058,4.730879225226535,4.760279784622849,4.891564134174497,5.210579818308601,5.267777005325398,5.617706856152497,4.907913833731451,5.18238387442265,5.677506913111188,4.615957954708821,4.726915931611369,4.887187703557262,4.852319410345256,4.981616826681828,4.652616042733467,4.211505975814311,3.170765962004038,4.064496555475701,2.756756941733908,3.219835752384957,3.574624789399613,3.078894560886696,2.602228876536223,3.279531556267741,2.804793203113196,3.214202367969637,3.170349668312976,2.750483100361627,2.765192628015125,2.711223051149787,2.616033671059088,2.686100982959998,2.76260005186596,2.606841841893357,2.630293966128652],[0.715,0.704,0.72,0.909,0.794,0.573,0.512,0.553,0.576,0.535,0.438,0.393,0.298,0.294,0.309,0.265,0.236,0.228,0.345,0.203,0.994,0.85,0.667,0.612,0.59,0.535,0.481,0.47,0.445,0.396,0.334,0.316,0.297,0.279,0.248,0.23,0.219,0.211,0.21,0.202,0.799,0.758,0.584,0.669,0.477,0.48,0.482,0.411,0.414,0.437,0.332,0.34,0.286,0.282,0.312,0.26,0.291,0.213,0.347,0.233,0.875,0.79,0.8070000000000001,0.513,0.859,0.528,0.824,0.483,0.392,0.378,0.342,0.9,0.348,0.307,0.296,0.29,0.247,0.271,0.217,0.209,0.865,0.658,0.661,0.5,0.495,0.396,0.447,0.345,0.348,0.31,0.285,0.352,0.233,0.273,0.286,0.326,0.256,0.224,0.322,0.262,0.788,0.6820000000000001,0.513,0.506,0.476,0.446,0.393,0.39,0.379,0.326,0.294,0.272,0.261,0.255,0.251,0.24,0.238,0.234,0.217,0.206,0.881,0.92,0.9330000000000001,0.616,0.589,0.6,0.733,0.505,0.417,0.343,0.355,0.396,0.364,0.332,0.338,0.306,0.268,0.249,0.248,0.205,0.775,0.628,0.5659999999999999,0.695,0.601,0.45,0.475,0.453,0.497,0.465,0.284,0.345,0.37,0.228,0.298,0.245,0.292,0.275,0.392,0.299,0.874,0.919,0.8090000000000001,0.775,0.668,0.666,0.644,0.63,0.585,0.463,0.456,0.376,0.337,0.333,0.285,0.239,0.238,0.236,0.214,0.203,0.855,0.59,0.587,0.43,0.342,0.393,0.785,0.356,0.89,0.852,0.819,0.885,0.881,0.392,0.388,0.6860000000000001,0.481,0.306,0.447,0.353,0.916,0.8149999999999999,0.8120000000000001,0.702,0.7,0.645,0.617,0.709,0.478,0.434,0.423,0.433,0.355,0.353,0.418,0.35,0.327,0.355,0.229,0.237,0.698,0.891,0.619,0.73,0.482,0.618,0.5669999999999999,0.5669999999999999,0.443,0.45,0.441,0.437,0.384,0.319,0.288,0.271,0.244,0.242,0.236,0.211,0.757,0.746,0.645,0.579,0.57,0.54,0.531,0.528,0.505,0.47,0.458,0.332,0.33,0.324,0.3,0.294,0.27,0.248,0.224,0.219,0.9370000000000001,0.897,0.881,0.8070000000000001,0.8129999999999999,0.76,0.738,0.553,0.544,0.496,0.471,0.454,0.378,0.344,0.287,0.285,0.263,0.248,0.227,0.216,0.828,0.6929999999999999,0.592,0.576,0.554,0.534,0.552,0.508,0.45,0.454,0.411,0.35,0.339,0.304,0.275,0.262,0.247,0.245,0.242,0.24,0.857,0.797,0.8,0.694,0.662,0.648,0.634,0.615,0.582,0.522,0.455,0.44,0.446,0.439,0.43,0.427,0.415,0.368,0.29,0.28,0.95,0.9370000000000001,0.882,0.855,0.727,0.666,0.595,0.526,0.522,0.49,0.468,0.434,0.386,0.362,0.331,0.298,0.255,0.245,0.233,0.23,0.954,0.867,0.621,0.661,0.612,0.543,0.597,0.512,0.41,0.382,0.342,0.343,0.33,0.314,0.308,0.312,0.265,0.247,0.218,0.242,0.872,0.649,0.601,0.569,0.536,0.516,0.502,0.488,0.46,0.44,0.428,0.383,0.355,0.321,0.313,0.308,0.277,0.271,0.255,0.212,0.772,0.726,0.727,0.6820000000000001,0.57,0.533,0.475,0.461,0.453,0.445,0.418,0.39,0.388,0.388,0.381,0.352,0.316,0.292,0.258,0.222,0.857,0.616,0.608,0.556,0.538,0.518,0.469,0.462,0.458,0.455,0.394,0.392,0.343,0.338,0.336,0.334,0.291,0.28,0.274,0.24,0.777,0.767,0.719,0.488,0.36,0.512,0.442,0.496,0.344,0.331,0.235,0.342,0.246,0.377,0.302,0.333,0.206,0.238,0.202,0.2,0.959,0.92,0.857,0.782,0.743,0.765,0.715,0.648,0.585,0.551,0.516,0.469,0.423,0.346,0.317,0.3,0.283,0.281,0.259,0.207,1,0.892,0.873,0.8100000000000001,0.761,0.542,0.539,0.507,0.458,0.441,0.418,0.415,0.415,0.317,0.291,0.291,0.261,0.242,0.209,0.206,0.986,0.951,0.951,0.889,0.875,0.757,0.757,0.75,0.583,0.583,0.576,0.569,0.556,0.5,0.389,0.354,0.25,0.229,0.229,0.215,0.8149999999999999,0.769,0.704,0.62,0.556,0.546,0.528,0.435,0.426,0.324,0.352,0.509,0.213,0.287,0.333,0.241,0.231,0.259,0.231,0.333,0.625,0.518,0.375,0.571,0.625,0.321,0.393,0.518,0.232,0.393,0.25,0.268,0.429,0.554,0.286,0.25,0.339,0.286,0.214,0.286],[0.115,0.152,0.169,0.363,0.329,0.161,0.106,0.149,0.177,0.147,0.114,0.08799999999999999,0.049,0.055,0.11,0.094,0.067,0.063,0.185,0.068,0.026,0.017,0.041,0.023,0.011,0.008999999999999999,0.011,0.008,0.007,0.011,0.012,0.003,0.005,0.006,0.006,0.012,0.002,0.001,0.003,0.002,0.385,0.387,0.23,0.321,0.138,0.153,0.186,0.141,0.157,0.187,0.096,0.111,0.063,0.07099999999999999,0.108,0.068,0.104,0.082,0.192,0.11,0.264,0.253,0.282,0.047,0.424,0.103,0.423,0.122,0.045,0.083,0.049,0.631,0.081,0.048,0.062,0.062,0.048,0.08599999999999999,0.033,0.053,0.42,0.261,0.271,0.179,0.189,0.145,0.213,0.14,0.145,0.118,0.103,0.165,0.08699999999999999,0.114,0.122,0.155,0.12,0.117,0.204,0.16,0.005,0.001,0.004,0.004,0,0.002,0.002,0.001,0.001,0.001,0.002,0.001,0.001,0.001,0.002,0.001,0.002,0.001,0.001,0.001,0.206,0.27,0.293,0.047,0.081,0.096,0.292,0.075,0.057,0.015,0.034,0.09,0.066,0.041,0.048,0.036,0.012,0.012,0.035,0.013,0.43,0.293,0.265,0.403,0.336,0.216,0.243,0.24,0.295,0.268,0.098,0.163,0.191,0.091,0.15,0.114,0.159,0.147,0.298,0.2,0.019,0.1,0.032,0.004,0.019,0.036,0.019,0.008,0.022,0.013,0.008,0.023,0.001,0.004,0.012,0.004,0.008999999999999999,0.012,0.008999999999999999,0.004,0.43,0.255,0.253,0.152,0.065,0.128,0.523,0.105,0.698,0.678,0.664,0.74,0.741,0.151,0.159,0.497,0.246,0.117,0.224,0.168,0.225,0.148,0.174,0.143,0.141,0.098,0.095,0.205,0.09,0.054,0.052,0.064,0.03,0.028,0.106,0.067,0.051,0.08599999999999999,0.008999999999999999,0.043,0.07199999999999999,0.309,0.08699999999999999,0.281,0.054,0.192,0.157,0.181,0.063,0.078,0.102,0.107,0.055,0.035,0.018,0.058,0.033,0.036,0.059,0.058,0.016,0.024,0.008999999999999999,0.005,0.002,0.006,0.007,0.007,0.003,0.013,0.003,0.005,0.006,0.003,0.004,0.001,0.003,0.002,0.004,0,0.011,0.008,0.02,0.001,0.007,0.01,0.001,0.001,0.001,0.005,0.002,0.001,0.001,0.001,0,0.001,0,0,0.001,0,0.025,0.031,0.017,0.015,0.014,0.01,0.043,0.01,0.008999999999999999,0.015,0.021,0.01,0.005,0.006,0.013,0.006,0.002,0.004,0.006,0.006,0.023,0.013,0.016,0.01,0.008,0.008,0.008,0.007,0.006,0.006,0.004,0.003,0.008999999999999999,0.005,0.003,0.004,0.004,0.003,0.003,0.003,0.021,0.011,0.005,0.018,0.002,0.004,0.001,0.001,0.001,0.01,0.002,0.003,0.005,0,0.001,0.001,0.001,0,0,0,0.165,0.191,0.034,0.091,0.098,0.032,0.107,0.063,0.06,0.037,0.032,0.036,0.023,0.016,0.012,0.032,0.021,0.018,0.021,0.041,0.014,0.011,0.005,0.003,0.005,0.008,0.006,0.006,0.004,0.001,0.004,0.002,0.001,0.003,0.001,0.005,0.001,0.002,0.003,0.001,0.004,0.004,0.006,0.003,0.003,0.001,0,0.001,0.001,0,0,0,0,0.001,0.001,0.001,0,0.001,0,0,0.004,0.003,0.005,0.001,0.002,0.004,0.002,0.004,0.003,0,0,0.003,0,0.001,0.002,0.002,0,0.002,0.001,0.001,0.117,0.122,0.096,0.067,0.034,0.08500000000000001,0.07000000000000001,0.094,0.045,0.042,0.023,0.05,0.026,0.07199999999999999,0.047,0.058,0.024,0.033,0.028,0.029,0.002,0.002,0.001,0.002,0.002,0.048,0,0.003,0.005,0,0.013,0.002,0.001,0.001,0,0,0.002,0.002,0.001,0.001,0.083,0.036,0.026,0.022,0.012,0.01,0.014,0.008,0.006,0.001,0.008999999999999999,0.008,0.01,0.004,0.003,0.003,0.005,0.004,0.003,0.002,0.008999999999999999,0.001,0.002,0.001,0.001,0.001,0.001,0,0,0.001,0,0.002,0,0.001,0.001,0,0,0,0,0,0.041,0.027,0.021,0.02,0.016,0.018,0.016,0.012,0.012,0.008,0.01,0.022,0.004,0.008,0.012,0.007,0.008,0.01,0.01,0.034,0.018,0.018,0.011,0.027,0.043,0.012,0.021,0.044,0.01,0.028,0.014,0.018,0.045,0.082,0.025,0.019,0.035,0.032,0.022,0.041],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.704916123989608e-222,7.247293614525324e-218,3.514810403044313e-177,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.352589615070891e-261,2.004026676174141e-238,5.725577120848093e-230,5.189132238161672e-229,3.311503233909155e-224,1.546153795772773e-168,7.338416539219334e-111,1.03803943960626e-105,1.462177805183423e-89,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.079054530432187e-273,2.802499361573334e-255,3.379120100492378e-200,3.980299307960481e-194,3.016204017002262e-168,4.574326952815569e-159,1.271957557688012e-150,3.197474681926787e-116,7.656495955689387e-97,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.220399622376686e-298,2.499615573333452e-298,4.172291726004332e-294,7.787300647932923e-259,1.565129042417485e-232,9.242310510775728e-232,6.065831240089096e-178,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.925794769481912e-292,4.011599198841621e-224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.54204913964185e-238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.013708162560672e-276,2.1041181915525e-243,8.610293354162314e-226,3.67940257227511e-221,5.15281210741228e-219,1.106512921704133e-197,4.861486504426994e-196,1.415433120839569e-190,7.966223062699024e-161,2.034816920450025e-158,7.176801568021564e-155,2.168211133689945e-146,4.106633947116861e-137,2.357846948725378e-116,2.084543316336837e-107,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.997497402337909e-283,4.513359815541863e-271,3.813175270105673e-252,8.107514411815896e-248,4.773287790650443e-209,1.287431550224156e-195,7.41311360516003e-174,1.129162972321047e-139,3.679527998757025e-136,2.296480712664979e-107,1.530621500258374e-60,1.236920626894376e-235,4.77779650131688e-157,2.954267201974051e-144,8.29175137763518e-125,3.407097857949147e-95,1.821407434470666e-90,6.685944249444063e-76,9.06170635731449e-59,2.594904467465281e-54,3.546917592281086e-53,1.176427190125008e-43,4.515739008918812e-38,6.842789236926249e-38,2.370276933653819e-33,5.78766316446384e-31,1.457049626058854e-30,5.210304336594389e-30,3.189681706418024e-21,6.482746792965505e-18,1.917282400447308e-15],[\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"11\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"12\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"13\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"14\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"15\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"16\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"17\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"18\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"19\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"20\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"21\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"22\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"23\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"24\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"25\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"26\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\",\"27\"],[\"GZMK\",\"CD8A\",\"AOAH\",\"CST7\",\"SH2D2A\",\"OASL\",\"CD8B\",\"CXCR3\",\"GZMM\",\"KLRK1\",\"SAMD3\",\"PVRIG\",\"EOMES\",\"IL9R\",\"TRMO\",\"ABI3\",\"TPRG1\",\"CD300A\",\"CMC1\",\"SNAI3\",\"MS4A1\",\"BANK1\",\"ADAM28\",\"SPIB\",\"LINC00926\",\"TNFRSF13B\",\"CD19\",\"ENSG00000289963\",\"LINC02397\",\"TNFRSF13C\",\"FCRLA\",\"LINC01857\",\"CD22\",\"SCIMP\",\"COL19A1\",\"CD180\",\"IGHV5-78\",\"COPDA1\",\"FCER2\",\"FCRL1\",\"PBXIP1\",\"MT1X\",\"MT1F\",\"LTB\",\"KLRB1\",\"TNFRSF25\",\"TBC1D4\",\"CCR6\",\"THEM4\",\"TIFA\",\"CCR4\",\"NCDN\",\"FOXP3\",\"ENSG00000227240\",\"LEF1\",\"MAL\",\"PTPN13\",\"ENSG00000290048\",\"SLC1A4\",\"IL6R\",\"CCL5\",\"NR4A2\",\"CD69\",\"IFNG\",\"SLC2A3\",\"CCL4\",\"DUSP1\",\"TNF\",\"XCL2\",\"SCML4\",\"CRTAM\",\"JUNB\",\"TNFSF9\",\"XCL1\",\"MATK\",\"KLRG1\",\"LINC02446\",\"TBC1D22A-DT\",\"CCL4L2\",\"ADRB2\",\"IL7R\",\"GIMAP7\",\"TRAT1\",\"S1PR1\",\"GIMAP5\",\"GIMAP1\",\"GIMAP4\",\"TCF7\",\"PASK\",\"TESPA1\",\"CCR4\",\"THEM4\",\"CMTM8\",\"LEF1\",\"LINC00861\",\"S1PR4\",\"AP3M2\",\"STMN3\",\"SELL\",\"ICAM2\",\"PTPRT\",\"LRRTM4\",\"NTRK3\",\"FAT3\",\"ENSG00000285822\",\"ENSG00000248973\",\"KC6\",\"CHGA\",\"LINC00355\",\"ENSG00000248515\",\"LINC02428\",\"SORCS3\",\"IRS4\",\"FGF10\",\"LINC02994\",\"EDAR\",\"ENSG00000267327\",\"IGSF1\",\"ENSG00000249413\",\"ENSG00000251574\",\"TNFRSF4\",\"BATF\",\"TNFRSF18\",\"FOXP3\",\"IL2RA\",\"LINC01943\",\"CARD16\",\"LAYN\",\"RTKN2\",\"CCR8\",\"SOCAR\",\"MAGEH1\",\"MAL\",\"IL1R2\",\"ENSG00000291105\",\"FLVCR2\",\"LAIR2\",\"LINC02099\",\"FANK1\",\"LINC00519\",\"PDE3B\",\"PTPRJ\",\"BICDL1\",\"PITPNC1\",\"PHACTR2\",\"AOAH\",\"FOXO1\",\"ATP8A1\",\"ARHGAP26\",\"MLLT3\",\"ENSG00000289474\",\"ANK3\",\"NELL2\",\"MIAT\",\"PRKCA\",\"ABTB3\",\"ITPKB\",\"WHRN\",\"CMSS1\",\"TSHZ2\",\"IGHG4\",\"IGKC\",\"IGHG1\",\"IGHGP\",\"IGHG3\",\"IGHG2\",\"IGKV4-1\",\"IGLV3-1\",\"IGKV3-20\",\"IGLV3-21\",\"IGKV1-9\",\"IGLC2\",\"CIBAR2\",\"IGLV6-57\",\"IGLC3\",\"IGKV1D-13\",\"IGHV3-21\",\"IGHV3-23\",\"IGLV1-51\",\"IGHV3-11\",\"IL7R\",\"BAG3\",\"DOK2\",\"KLRB1\",\"CD40LG\",\"HSPA6\",\"HSPA1B\",\"TNFSF14\",\"DNAJB1\",\"HSPA1A\",\"HSPH1\",\"HSPE1\",\"HSPD1\",\"CCR6\",\"SERPINH1\",\"FKBP4\",\"ZFAND2A\",\"DNAJA4\",\"DNAJB4\",\"GNA15\",\"NKG7\",\"GZMB\",\"CTSW\",\"GNLY\",\"PRF1\",\"KLRD1\",\"GZMH\",\"SLA2\",\"FASLG\",\"XCL2\",\"XCL1\",\"CD300A\",\"KLRC2\",\"KLRC1\",\"HOPX\",\"MATK\",\"LINC02446\",\"CLIC3\",\"SH2D1B\",\"TRGC2\",\"CXCL13\",\"TNFRSF18\",\"PDE7B\",\"IGFLR1\",\"ZBED2\",\"CXCR6\",\"CD4\",\"LAG3\",\"GNG4\",\"ADGRG1\",\"PDCD1\",\"NMB\",\"CD200\",\"SORD2P\",\"ENSG00000287347\",\"ETV7\",\"MYO7A\",\"KRT86\",\"RDH10\",\"SLC2A8\",\"IL1B\",\"PID1\",\"EREG\",\"FCN1\",\"AQP9\",\"SLC11A1\",\"OLR1\",\"TREM1\",\"CD300E\",\"MMP19\",\"S100A12\",\"PELATON\",\"IL1A\",\"PLA2G7\",\"CLEC5A\",\"CLEC4E\",\"MIR3945HG\",\"MCEMP1\",\"ENSG00000284930\",\"FCAR\",\"DSG3\",\"KRT6A\",\"KRT16\",\"LY6D\",\"CLDN4\",\"SLPI\",\"DSG1\",\"HES2\",\"KRTDAP\",\"CLDN7\",\"RHCG\",\"KLK8\",\"SERPINB13\",\"TMPRSS4\",\"ACTL8\",\"MGC32805\",\"PGLYRP3\",\"ADGRF1\",\"A2ML1\",\"S100A7A\",\"CSF2RA\",\"GPR157\",\"CPVL\",\"PKIB\",\"CYP2S1\",\"LGALS2\",\"LAMP3\",\"IDO1\",\"VMO1\",\"CCL22\",\"TMEM176A\",\"FLT3\",\"CLEC10A\",\"IDO2\",\"HLA-DQB2\",\"FCER1A\",\"CCL17\",\"S100B\",\"PADI2\",\"CD1C\",\"PCLAF\",\"RRM2\",\"MKI67\",\"UBE2C\",\"CDCA5\",\"BIRC5\",\"CCNA2\",\"GTSE1\",\"PKMYT1\",\"AURKB\",\"NEIL3\",\"HJURP\",\"PLK1\",\"DLGAP5\",\"SKA1\",\"CDCA3\",\"SPC25\",\"KIF18B\",\"SPC24\",\"KIF20A\",\"DCN\",\"COL3A1\",\"LUM\",\"MMP2\",\"TWIST2\",\"PDGFRA\",\"SFRP2\",\"ISLR\",\"CCBE1\",\"MMP1\",\"GREM1\",\"COL10A1\",\"MMP3\",\"DPT\",\"LRRC15\",\"POPDC3\",\"CXCL6\",\"MASP1\",\"MEGF10\",\"WNT2\",\"GZMB\",\"CTSW\",\"KRT86\",\"LAYN\",\"HAVCR2\",\"VCAM1\",\"TNFRSF9\",\"ZBED2\",\"CSF1\",\"KLRC1\",\"TRBV28\",\"MYO7A\",\"TRAV29DV5\",\"PELO-AS1\",\"KIR2DL4\",\"AKAP5\",\"TNFSF4\",\"ETV1\",\"CCL3-AS1\",\"ASB2\",\"P2RY6\",\"COL24A1\",\"GLT1D1\",\"SCT\",\"PACSIN1\",\"ENSG00000225885\",\"LILRA4\",\"LINC01374\",\"SMPD3\",\"PTCRA\",\"LAMP5\",\"CLEC4C\",\"SHD\",\"NLRP7\",\"LRRC26\",\"INSYN2A\",\"KCNK10\",\"SMIM5\",\"SCN9A\",\"SLC32A1\",\"ADGRL4\",\"PLVAP\",\"RAMP2\",\"EMCN\",\"VWF\",\"RAMP3\",\"CCL14\",\"DIPK2B\",\"CDH5\",\"MYCT1\",\"CLDN5\",\"KDR\",\"ACKR1\",\"TM4SF18\",\"SELE\",\"CLEC14A\",\"ROBO4\",\"BCL6B\",\"SOX17\",\"ARHGEF15\",\"RGS5\",\"EGFLAM\",\"TRPC6\",\"HTR1F\",\"ABCC9\",\"EGFL6\",\"COX4I2\",\"KCNE4\",\"GJA4\",\"KCNJ8\",\"CDH6\",\"HIGD1B\",\"AVPR1A\",\"FAM162B\",\"TBX2\",\"LGI4\",\"EBF2\",\"CARMN\",\"EPHA3\",\"WFDC1\",\"ARHGAP24\",\"EBF1\",\"BANK1\",\"BLK\",\"ENSG00000285454\",\"WDFY4\",\"INPP5A\",\"AFF3\",\"ADAM7-AS1\",\"LINC00278\",\"CNR2\",\"KCNQ5\",\"PLEKHG7\",\"DENND5B\",\"VAV2\",\"OSBPL10\",\"PAX5\",\"CBFA2T3\",\"ST6GALNAC3\",\"COL19A1\",\"TPSAB1\",\"TPSB2\",\"CPA3\",\"HDC\",\"HPGDS\",\"HPGD\",\"TPSD1\",\"GATA2\",\"SLC18A2\",\"MS4A2\",\"KIT\",\"PRG2\",\"CTSG\",\"GCSAML\",\"ENSG00000233968\",\"ADCYAP1\",\"MAOB\",\"ENPP3\",\"CLEC4OP\",\"LINC02752\",\"S100A2\",\"KRT6B\",\"GPR87\",\"RBP1\",\"KRT75\",\"SOSTDC1\",\"CNN1\",\"HAS3\",\"PAMR1\",\"UGT2A1\",\"TAGLN3\",\"SHISA2\",\"KRT42P\",\"EGF\",\"SERPINA3\",\"KLK5\",\"C12orf54\",\"HSD17B2\",\"TRIM58\",\"LMO3\",\"PMEL\",\"TYRP1\",\"MLANA\",\"TYR\",\"TRPM1\",\"SLC24A5\",\"PLP1\",\"LINC00518\",\"SLCO4A1-AS1\",\"DCT\",\"SOX10\",\"S100A1\",\"TRIM63\",\"ALX1\",\"BCAN\",\"BIRC7\",\"ENSG00000225106\",\"LINC02232\",\"GAPDHS\",\"LINC00906\",\"IGLL5\",\"RRM2\",\"DIAPH3\",\"SHCBP1\",\"POLQ\",\"BUB1\",\"AURKB\",\"CDCA3\",\"HJURP\",\"H3C8\",\"LINC03047\",\"APOBEC3B\",\"ACY3\",\"DEPDC1\",\"SPC25\",\"LINC01484\",\"KIF20A\",\"KIF18B\",\"IGHE\",\"IGKV1-5\",\"SH2D1B\",\"TRDC\",\"ADGRG3\",\"TRGV9\",\"KLRC1\",\"KLRF1\",\"LINC00996\",\"KLRC2\",\"SIGLEC17P\",\"TRGV7\",\"TARP\",\"B3GNT7\",\"FES\",\"IL12RB2\",\"TNFSF4\",\"ENSG00000224376\",\"ZNF667-AS1\",\"FAM30A\",\"PTGDR\",\"FEZ1\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>p_val<\\/th>\\n      <th>avg_log2FC<\\/th>\\n      <th>pct.1<\\/th>\\n      <th>pct.2<\\/th>\\n      <th>p_val_adj<\\/th>\\n      <th>cluster<\\/th>\\n      <th>gene<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"p_val\",\"targets\":1},{\"name\":\"avg_log2FC\",\"targets\":2},{\"name\":\"pct.1\",\"targets\":3},{\"name\":\"pct.2\",\"targets\":4},{\"name\":\"p_val_adj\",\"targets\":5},{\"name\":\"cluster\",\"targets\":6},{\"name\":\"gene\",\"targets\":7}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\n::: {.callout-note collapse=\"false\"}\n-   **Filtragem adicional**: remove genes com pouca relevância ou significância estatística, mantendo apenas aqueles que:\n    -   Têm valor ajustado de p significativo (`p_val_adj <= 0.05`);\n    -   Apresentam diferença de expressão relevante (`avg_log2FC >= 0.25`);\n    -   São detectados em pelo menos 20% das células do cluster (`pct.1 >= 0.20`);\n    -   São mais expressos no cluster alvo do que nos demais (`pct.1 > pct.2`).\n-   **Seleção dos principais marcadores**: para cada cluster, retém apenas os **20 genes com maior log2FC médio**, facilitando a visualização e a escolha de genes para anotação.\n\nEste conjunto de marcadores é particularmente útil para guiar a **anotação manual**, pois foca nos genes mais distintivos de cada população celular.\n:::\n\n### Visualizando marcadores no UMAP\n\n\n\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Plotar expressão de genes marcadores conhecidos para atribuição manual\nFeaturePlot(\n  seurat_object, \n  features = c(\"CD3D\", \"MS4A1\", \"LYZ\", \"PPBP\", \"CD8A\")\n  )\n```\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-feature-1.png){#fig-feature fig-align='center' width=672}\n:::\n:::\n\n\n\n\n### Visualizando atraves do `Bubbleplot`\n\n\n\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Definir genes marcadores para visualização (exemplo)\ngenes_to_inspect <- c(\"CD3D\", \"MS4A1\", \"LYZ\", \"PPBP\", \"CD8A\")\n\n# Gerar o Bubbleplot (DotPlot no Seurat)\nDotPlot(seurat_object, features = genes_to_inspect)\n```\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-bubbleplot-1.png){#fig-bubbleplot fig-align='center' width=672}\n:::\n:::\n\n\n\n\n::: {.callout-note collapse=\"false\"}\nO Bubbleplot (DotPlot) resume a expressão gênica em cada cluster:\n\n-   **Tamanho do ponto** → indica a fração de células do cluster que expressam o gene (quanto maior, mais células expressam).\n-   **Cor do ponto** → representa a expressão média do gene entre as células expressoras (mais escuro = maior expressão).\n\nIsso permite identificar rapidamente quais genes são marcadores de quais clusters e orientar a anotação manual.\n:::\n\n### Avaliação manual dos marcadores\n\n| Cluster | Cell Type | Gene Markers |\n|--------------|-------------------------------|---------------------------|\n| 1 | **CD8+ Cytotoxic T cells** | CD8A, CD8B, GZMK, GZMH, PRF1, IFNG, XCL1, NKG7 |\n| 2 | **CD4+ T cells / TCM-like** | IL7R, TCF7, CAMK4, PDE3B, AOAH |\n| 3 | **Regulatory T cells (Tregs)** | FOXP3, CTLA4, IL2RA, TNFRSF18 (GITR), LAYN |\n| 4 | **B cells** | MS4A1 (CD20), BANK1, CD19, CD22, IGHV5-78 |\n| 5 | **Monocytes (Inflammatory)** | LYZ, FCN1, AIF1, IL1B, S100A12, SERPINA1 |\n| 6 | **Tumor-Associated Cells (Cancer cells, PRAME+)** | PRAME, CHGA, MAGEA4, IRS4, SORCS3 |\n| 7 | **Plasma Cells** | IGHG1, IGHG4, IGHG3, IGLL5, IGKV/IGLV genes |\n| 8 | **Keratinocytes / Tumor-associated Epithelium** | DSG3, KRT6A, KRT16, LY6D, SLPI, CLDN4 |\n| 9 | **Fibroblasts (CAF-like)** | COL1A1, COL3A1, LUM, DCN, PDGFRB, SFRP2 |\n| 10 | **Proliferating Cells (likely cycling tumor cells)** | MKI67, UBE2C, RRM2, CCNA2, BIRC5 |\n| 11 | **Plasmacytoid Dendritic Cells / pDC-like** | CLEC4C, LILRA4, GLT1D1, P2RY6 |\n| 12 | **Endothelial Cells** | CLDN5, ACKR1, PLVAP, RAMP2, EMCN, CDH5 |\n| 13 | **Mast Cells** | TPSAB1, TPSB2, CPA3, HDC, MS4A2 (FCER1) |\n| 14 | **Melanoma Cells (Tumor Melanocytic Cells)** | PMEL, TYRP1, MLANA, TYR, SOX10, TRPM1 |\n\n### Renomeando clusters\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Definir a lista de renomeação\ncluster_annotations <- list(\n  \"1\" = \"CD8+ Cytotoxic T cells\",\n  \"2\" = \"CD4+ T cells / TCM-like\",\n  \"3\" = \"Tregs\",\n  \"4\" = \"B cells\",\n  \"5\" = \"Monocytes\",\n  \"6\" = \"PRAME+ Tumor\",\n  \"7\" = \"Plasma Cells\",\n  \"8\" = \"Keratinocytes/Epithelial\", # Maybe tumor\n  \"9\" = \"Fibroblasts\",\n  \"10\" = \"Proliferating Tumor Cells\",\n  \"11\" = \"Plasmacytoid Dendritic Cells\",\n  \"12\" = \"Endothelial Cells\",\n  \"13\" = \"Mast Cells\",\n  \"14\" = \"Melanoma Cells\"\n)\n\n# Renomear os clusters\ncluster_ids <- as.character(Idents(seurat_object))\n\n# Criando coluna com anotacao manual\nseurat_object$manual_annotation <- as.vector(\n  unlist(cluster_annotations[cluster_ids]))\n\n# Visualizar para conferir\ntable(seurat_object$manual_annotation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                     B cells      CD4+ T cells / TCM-like \n                        5281                        10701 \n      CD8+ Cytotoxic T cells            Endothelial Cells \n                        8626                         3222 \n                 Fibroblasts     Keratinocytes/Epithelial \n                        3336                         4290 \n                  Mast Cells               Melanoma Cells \n                        2529                         2103 \n                   Monocytes                 Plasma Cells \n                        5808                         4513 \nPlasmacytoid Dendritic Cells                 PRAME+ Tumor \n                        3487                         4121 \n   Proliferating Tumor Cells                        Tregs \n                        3237                         6379 \n```\n\n\n:::\n:::\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualizar anotacao\nDimPlot(seurat_object, group.by = \"manual_annotation\", label = FALSE, pt.size = 0.5) +\n  ggplot2::theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-manual-annotation-1.png){#fig-manual-annotation fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## Anotação Automática com SingleR\n\nEmbora a anotação manual seja fundamental para garantir a qualidade e o contexto biológico da análise, ela pode ser trabalhosa e depender do conhecimento prévio sobre os tipos celulares presentes. Para facilitar e agilizar esse processo, especialmente em conjuntos de dados grandes ou menos caracterizados, é comum utilizar abordagens automáticas.\n\nO **SingleR** é uma ferramenta projetada para esse fim. Ele anota células individualmente ao comparar seus perfis de expressão com conjuntos de dados de referência já anotados. A atribuição é baseada na similaridade do transcriptoma de cada célula com os perfis médios das populações do banco de referência, o que torna o método eficiente e relativamente robusto para diversas aplicações.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Converter para SingleCellExperiment\nsce <- as.SingleCellExperiment(seurat_object)\n\n# Carregar uma base de referencia\nref <- celldex::HumanPrimaryCellAtlasData()\n\n# Rodar SingleR\npred <- SingleR(\n  test = sce, ref = ref, labels = ref$label.main)\n\n# Adicionar anotação ao objeto Seurat\nseurat_object$SingleR <- pred$labels\n```\n:::\n\n\n\n\n::: {.callout-note collapse=\"false\"}\nEste trecho realiza a **anotação automática das células usando o SingleR** com uma base de referência.\n\n-   `as.SingleCellExperiment(seurat_object)`: converte o objeto Seurat para o formato `SingleCellExperiment`, necessário para rodar o SingleR.\n\n-   `celldex::HumanPrimaryCellAtlasData()`: carrega uma base de referência com perfis de expressão de células humanas bem caracterizadas.\n\n-   `SingleR(test = sce, ref = ref, labels = ref$label.main)`: compara cada célula do dataset com as referências e atribui o tipo celular mais provável.\n\n-   `seurat_object$SingleR <- pred$labels`: adiciona a anotação automática como metadado no objeto Seurat para facilitar a visualização e análise.\n:::\n\n\n\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualizar anotacao automatica\nDimPlot(seurat_object, \n        group.by = \"SingleR\", label = TRUE, pt.size = 0.5)\n```\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-automated-annotation-1.png){#fig-automated-annotation fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## Diagnóstico da Anotação com SingleR\n\nEste gráfico mostra os scores de similaridade entre cada célula do conjunto de teste e os tipos celulares da referência. Ele ajuda a identificar células com atribuições ambíguas ou múltiplas similaridades.\n\n\n\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Gerar heatmap dos scores de atribuicao\nplotScoreHeatmap(pred)\n```\n:::\n\n\n\n\nOutro diagnóstico é baseado nos \"deltas\" por célula, ou seja, a diferença entre a pontuação do rótulo atribuído e a mediana em todos os rótulos para cada célula. Deltas baixos indicam que a atribuição é incerta, o que é especialmente relevante se o rótulo verdadeiro da célula não existir na referência. Podemos inspecionar esses deltas entre as células para cada rótulo usando a função `plotDeltaDistribution()`.\n\n\n\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Gerar distribuicao dos deltas\nplotDeltaDistribution(pred)\n```\n:::\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\nplotMarkerHeatmap(pred, sce, label = \"NK_cell\")\n```\n:::\n\n\n\n\n\n## Comparando e refinando anotações\n\n### Comparando as anotações com UMAP\n\n\n\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- DimPlot(seurat_object, group.by = \"manual_annotation\", label = TRUE) + \n  ggplot2::ggtitle(\"Anotação manual (clusters)\") +\n  ggplot2::theme(\n    legend.position = \"bottom\"\n  )\n\np2 <- DimPlot(seurat_object, group.by = \"SingleR\", label = TRUE) + \n  ggplot2::ggtitle(\"Anotação automática (SingleR)\") +\n  ggplot2::theme(\n    legend.position = \"bottom\"\n  )\n\np1\np2\n```\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-umap-annotation-1.png){#fig-umap-annotation-1 fig-align='center' width=672}\n:::\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-umap-annotation-2.png){#fig-umap-annotation-2 fig-align='center' width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Comparar manual vs automática\nconfusion_matrix <- table(\n  Manual = seurat_object$manual_annotation, \n  Automatic = seurat_object$SingleR\n  )\n\n# Normalizar por linha (proporção dentro de cada anotação manual)\nconfusion_prop <- prop.table(confusion_matrix, margin = 1)\n```\n:::\n\n::: {.cell .column-screen-inset-shaded layout-nrow=\"1\" layout-align=\"center\"}\n\n```{.r .cell-code}\n# Visualização da matriz de confusão\npheatmap::pheatmap(\n  confusion_prop,\n  fontsize = 6,\n  display_numbers = TRUE,            # mostra as proporções\n  number_format = \"%.1f\",            # duas casas decimais\n  cluster_rows = FALSE,\n  cluster_cols = FALSE,\n  color = colorRampPalette(c(\"white\", \"steelblue\"))(100)\n)\n```\n\n::: {.cell-output-display}\n![](05_cell_annotation_files/figure-html/fig-confusion-matrix-1.png){#fig-confusion-matrix fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## Salvando o objeto anotado\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(seurat_object, file = \"data/seurat_annotated.RDS\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}