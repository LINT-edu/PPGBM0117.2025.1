---
title: "01 - Coleta de dados"
author: "Andre Fonseca"
format:
    html:
      toc: true
      toc-depth: 3
      code-fold: true
      code-tools: true
editor: visual
---

## MotivaÃ§Ã£o

O avanÃ§o das tecnologias de sequenciamento em cÃ©lula Ãºnica permitiu uma revoluÃ§Ã£o na compreensÃ£o da biologia celular em diversos contextos fisiolÃ³gicos e patolÃ³gicos. Entretanto, o acesso a dados de alta qualidade e bem anotados ainda Ã© um desafio para pesquisadores iniciantes ou que nÃ£o possuem estrutura para gerar seus prÃ³prios datasets.

A Chan Zuckerberg Initiative (CZI), por meio da plataforma **CellxGene**, disponibiliza milhares de amostras de transcriptoma de cÃ©lula Ãºnica de estudos de alta relevÃ¢ncia, anotados, integrados e prontos para reuso. Essa plataforma se tornou uma referÃªncia mundial para pesquisadores que buscam:

-   dados de referÃªncia para estudos comparativos,
-   reanÃ¡lise com mÃ©todos prÃ³prios,
-   treinamento de modelos de aprendizado de mÃ¡quina,
-   integraÃ§Ã£o com dados internos.

## O que Ã© o CellxGene (CZI CellxGene Explorer)?

**CellxGene Explorer** Ã© uma plataforma interativa mantida pela **Chan Zuckerberg Initiative (CZI)**, que permite **explorar, visualizar e baixar** dados de transcriptÃ´mica de cÃ©lula Ãºnica (scRNA-seq) e outros tipos de dados Ã³micos. Ela Ã© parte do projeto **CZ CELLxGENE Discover**, cujo objetivo Ã© democratizar o acesso a dados de alta qualidade e facilitar sua reutilizaÃ§Ã£o em pesquisas biomÃ©dicas.

Recursos principais incluem:

-   VisualizaÃ§Ãµes UMAP interativas
-   AnotaÃ§Ãµes por tipo celular
-   Filtros por condiÃ§Ã£o clÃ­nica, Ã³rgÃ£o, espÃ©cie, etc.
-   Download facilitado dos dados brutos e processados (anndata, Seurat, CSV)

## Tipos de Dados DisponÃ­veis

AtÃ© o momento, o CellxGene armazena mais de **100 milhÃµes de cÃ©lulas**, derivadas de estudos envolvendo:

-   CÃ¢ncer (mama, pulmÃ£o, prÃ³stata, cÃ³lon etc.)
-   COVID-19
-   DoenÃ§as autoimunes (LÃºpus, Artrite Reumatoide)
-   DoenÃ§as infecciosas (tuberculose, HIV)
-   DoenÃ§as neurodegenerativas (Alzheimer, Parkinson)
-   Tecido saudÃ¡vel humano e de modelos animais
-   Dados do Human Cell Atlas (HCA)

O volume de dados disponÃ­veis pode chegar a **centenas de gigabytes**, portanto Ã© importante considerar isso ao baixar conjuntos maiores.

## 1. Navegando na Plataforma CellxGene

Para comeÃ§ar a explorar dados no CellxGene, siga os passos abaixo:

### Acessando a plataforma:

1.  Acesse: [**https://cellxgene.cziscience.com/**](https://cellxgene.cziscience.com/)
2.  Em seguida clique na aba **Collections**.
3.  Use a barra de busca ou os filtros laterais (organismo, Ã³rgÃ£o, condiÃ§Ã£o, etc.) para encontrar o estudo de interesse.
4.  Clique sobre o **nome do dataset** desejado â€” isso abrirÃ¡ a interface do **CellxGene Explorer**.

> ğŸ“Œ Nota: Essa Ã© a interface interativa principal, onde ocorrem todas as anÃ¡lises visuais descritas a seguir.

## 2. Explore os datasets disponÃ­veis

VocÃª pode utilizar o campo de busca ou aplicar filtros laterais:

-   Organismo: Humano, Camundongo, etc.
-   Tecido: PulmÃ£o, Sangue, CÃ©rebro, etc.
-   DoenÃ§a: CÃ¢ncer, COVID-19, etc.
-   Projeto ou Estudo (ex: HCA, Tabula Sapiens)

> ğŸ’¡ Dica: Cada entrada no catÃ¡logo mostra algumas estatisticas descritivas sobre o dado, por exemplo, o nÃºmero de cÃ©lulas e a tipo de tecnologia utilizada.

## 3. Explorando dataset de interesse

Antes de baixar os dados, vale a pena usar os recursos de **exploraÃ§Ã£o interativa** da plataforma para decidir se aquele conjunto Ã© Ãºtil para seus objetivos. Abaixo estÃ£o perguntas chave para cada uma das ferramentas disponÃ­veis:

### 3.1. **Explore**

*(Proximo ao botÃ£o de Download â†’ â€œExploreâ€)*

1.  **Qual a composiÃ§Ã£o celular do dataset?**\
    â†’ Visualize a proporÃ§Ã£o de tipos celulares no grÃ¡fico UMAP e no painel lateral (**"Cell types"**).

2.  **Quantas amostras e doadores estÃ£o incluÃ­dos no estudo?**\
    â†’ Acesse os metadados no painel lateral (**"sample ID"**, **"donor ID"**) ou use os filtros.

3.  **O dataset contÃ©m metadados Ãºteis como idade, sexo ou estÃ¡gio da doenÃ§a?**\
    â†’ Observe a barra lateral com as opÃ§Ãµes de filtros apresentados no dataset.

4.  **Como a distribuiÃ§Ã£o celular varia entre condiÃ§Ãµes clÃ­nicas?**\
    â†’ Aplique filtros por condiÃ§Ã£o (`disease`, `treatment`, etc.) e observe mudanÃ§as no UMAP.

------------------------------------------------------------------------

### 3.2. **Gene Expression**

*(Menu superior â†’ â€œGene Expressionâ€)*

1.  **Meu gene de interesse estÃ¡ presente no dataset?**\
    â†’ Use o campo de busca **â€œGene Expressionâ€** para inserir o sÃ­mbolo do gene.

2.  **Quais tipos celulares expressam esse gene?**\
    â†’ Veja o padrÃ£o de expressÃ£o do gene no UMAP colorido por intensidade.

3.  **A expressÃ£o do gene varia entre amostras ou condiÃ§Ãµes?**\
    â†’ Aplique filtros por `sample`, `disease`, etc., e observe mudanÃ§as de expressÃ£o.

4.  **O gene Ã© especÃ­fico de um tipo celular?**\
    â†’ Verifique se hÃ¡ expressÃ£o restrita a um cluster/tipo celular.

5.  **Dois genes sÃ£o coexpressos?**\
    â†’ Observe o padrÃ£o de co-expressÃ£o a partir do `bubble plot`

------------------------------------------------------------------------

### 3.3. **Cell Guide**

*(Menu superior â†’ â€œCell Guideâ€)*

1.  **Quais os marcadores canonicos do meu tipo celular de interesse?**

    â†’ Acesse a pÃ¡gina do tipo celular e consulte a opcao **"Marker genes"**.

2.  **Ha diferencas entre marcadores deduzidos computacionalmente e os canonicos?**

    â†’ Observe a aba **"Computational"** na tabela de Marker genes.

3.  **Qual o significado das colunas `Effect size`, `Specificity`, `Mean Expression` e `% of Cells`?**

    â†’ Investigue a documentaÃ§Ã£o da tabela nos icones de ajuda **"?"**.

------------------------------------------------------------------------

### 3.4. **Differential Expression**

*(Menu superior â†’ â€œDifferential Expressionâ€)*

1.  **Quais genes estÃ£o diferencialmente expressos entre dois tipos celulares?**

    â†’ Selecione dois tipos celulares em um mesmo dataset e compare.

2.  **HÃ¡ genes diferencialmente expressos entre condiÃ§Ãµes clÃ­nicas?**

    â†’ Aplique filtros por condiÃ§Ã£o e selecione grupos para comparaÃ§Ã£o.

3.  **Existe genes diferencialmente expressos no mesmo tipo celular entre datasets?**

    â†’ Compare um tipo celular entre datasets diferentes atravÃ©s da ferramenta.

## 4. SugestÃ£o de Uso Integrado

Um fluxo de exploraÃ§Ã£o poderia seguir:

1.  Use o **Explore** para entender a estrutura geral do dataset.\
2.  Consulte **Gene Expression** para validar ou investigar genes relevantes.\
3.  Visite o **Cell Guide** para contextualizar biologicamente os tipos celulares.\
4.  Use o **Differential Expression** para gerar hipÃ³teses ou identificar genes marcadores.

## 5. Baixar os dados

ApÃ³s explorar e decidir se o conjunto de dados Ã© relevante, podemos baixÃ¡-lo. Na etapa de seleÃ§Ã£o do dataset, clique no botÃ£o **"Download dataset"** (localizado na mesma tela em que entramos o botÃ£o Explorer).

VocÃª poderÃ¡ baixar diferentes versÃµes dos dados, quando disponÃ­veis:

-   `.h5ad`: formato **AnnData**, amplamente utilizado com **Scanpy** (Python)
-   `.csv`: tabelas de contagem e metadados em formato tabular
-   `.rds`: formato **Seurat**, Ãºtil para integraÃ§Ã£o com pacotes do ecossistema **R**.
-   Arquivos complementares (README, metadados, referÃªncias)

> âš ï¸ **AtenÃ§Ã£o ao tamanho dos arquivos:** um dataset completo pode ter de 500 MB a mais de 20 GB, dependendo do nÃºmero de cÃ©lulas e da profundidade de sequenciamento.

> â„¹ï¸ **ObservaÃ§Ã£o:** Nem todos os datasets estÃ£o disponÃ­veis em todos os formatos. Por exemplo, alguns estudos fornecem apenas `.h5ad`, enquanto outros incluem `.rds` ou `.csv`.\
> Isso **nÃ£o Ã© um impeditivo**, pois Ã© possÃ­vel realizar **conversÃµes entre formatos** usando bibliotecas como: - `zellkonverter` ou `sceasy` (para converter `.h5ad` â‡„ `.rds`) - `anndata2ri` para interoperabilidade entre R e Python

Exemplo de conversÃ£o de `.h5ad` para `.rds` no R:

#### Exemplo: Convertendo `.h5ad` para `.rds` com `sceasy`

``` r
# Instale os pacotes necessÃ¡rios, se ainda nÃ£o tiver:
# install.packages("remotes")
# remotes::install_github("cellgeni/sceasy")
# remotes::install_github("dynverse/reticulate")

library(sceasy)
library(reticulate)

# Se necessÃ¡rio, especifique o caminho para seu ambiente Python com anndata instalado:
# use_python("/caminho/para/seu/python", required = TRUE)

# Converta o arquivo .h5ad para um objeto SingleCellExperiment (.rds)
sceasy::convertFormat(
  "dataset.h5ad",
  from = "anndata",
  to = "seurat",
  outFile = "dataset.rds"
)
```

> ğŸ“Œ **Nota:** Para que a conversÃ£o funcione corretamente, vocÃª precisa de um ambiente Python com o pacote `anndata` instalado. **Qualquer problema faremos em sala**.

A instalaÃ§Ã£o do `anndata` via R pode ser feita atravÃ©s do comando:

``` r
reticulate::py_install("anndata")
```

## 6. ComentÃ¡rios Finais

-   O CellxGene Ã© atualizado frequentemente com novos estudos revisados por pares e dados brutos provenientes de colaboraÃ§Ãµes com o **Human Cell Atlas**, **Azimuth**, e outras iniciativas.\
-   Ã‰ uma excelente fonte para **benchmarking** de mÃ©todos, descoberta de biomarcadores e validaÃ§Ã£o cruzada.\
-   Ao usar os dados, consulte a aba de **metadata** para verificar as permissÃµes de reuso e a citaÃ§Ã£o correta do estudo.
